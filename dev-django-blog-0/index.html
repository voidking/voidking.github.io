<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:new URL("https://www.voidking.com").hostname,root:"/",scheme:"Gemini",version:"7.7.1",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1,cdn:{enable:!0,url:"//qiniu-cdn.voidking.com/doc/search.xml"}},path:"search.xml",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="前言承接《Django入门》，本文参照慕课网《django入门与实践》课程，开发一个简单的博客系统。按照国际惯例，我们先学习一下django的基础知识。"><meta property="og:type" content="article"><meta property="og:title" content="好好学Python：Django开发简单Blog系统——上"><meta property="og:url" content="https://www.voidking.com/dev-django-blog-0/index.html"><meta property="og:site_name" content="好好学习的郝"><meta property="og:description" content="前言承接《Django入门》，本文参照慕课网《django入门与实践》课程，开发一个简单的博客系统。按照国际惯例，我们先学习一下django的基础知识。"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2017-11-27T17:00:00.000Z"><meta property="article:modified_time" content="2017-11-27T17:00:00.000Z"><meta property="article:author" content="好好学习的郝"><meta property="article:tag" content="python"><meta property="article:tag" content="django"><meta property="article:tag" content="好好学Python"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://www.voidking.com/dev-django-blog-0/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0}</script><title>好好学Python：Django开发简单Blog系统——上 | 好好学习的郝</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?b759ac2a7fa45129e3ef060bf68259f0";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="好好学习的郝" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">好好学习的郝</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">一个计算机技术爱好者与学习者</h1></div><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/voidking" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.voidking.com/dev-django-blog-0/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="好好学习的郝"><meta itemprop="description" content="一个计算机技术爱好者与学习者"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="好好学习的郝"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> 好好学Python：Django开发简单Blog系统——上</h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2017-11-27 17:00:00" itemprop="dateCreated datePublished" datetime="2017-11-27T17:00:00+00:00">2017-11-27</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/" itemprop="url" rel="index"><span itemprop="name">engineering</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="前言"><span class="post-title-index">1.</span><a href="#前言" class="headerlink" title="前言"></a> 前言</h1><p>承接《Django入门》，本文参照慕课网《django入门与实践》课程，开发一个简单的博客系统。按照国际惯例，我们先学习一下django的基础知识。</p><span id="more"></span><h1 id="模板引擎"><span class="post-title-index">2.</span><a href="#模板引擎" class="headerlink" title="模板引擎"></a> 模板引擎</h1><p>Django默认使用DTL（Django Template Language）作为模板引擎，如果想要修改为其他模板引擎，直接在djsite/djsite/settings.py中修改TEMPLATES即可。详情可以参考<a target="_blank" rel="noopener" href="https://docs.djangoproject.com/en/1.11/ref/templates/api/">The Django template language: for Python programmers</a>。</p><h2 id="first-template"><span class="post-title-index">2.1.</span><a href="#first-template" class="headerlink" title="first template"></a> first template</h2><p>1、在blog目录下创建templates目录。</p><p>2、在templates目录中创建index.html文件。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Index<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    first template!</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>3、修改blog/urls.py为：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.conf.urls <span class="keyword">import</span> url</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    url(<span class="string">r&#x27;^$&#x27;</span>, views.index, name=<span class="string">&#x27;index&#x27;</span>),</span><br><span class="line">    url(<span class="string">r&#x27;helloworld&#x27;</span>, views.hello, name=<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>4、在views.py中添加方法：</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;index.html&#x27;</span>)</span><br></pre></td></tr></table></figure><p>5、测试访问<br>启动django，访问 <a target="_blank" rel="noopener" href="http://localhost:8000/blog/">http://localhost:8000/blog/</a> ，即可看到渲染好的页面。</p><h2 id="DTL"><span class="post-title-index">2.2.</span><a href="#DTL" class="headerlink" title="DTL"></a> DTL</h2><p>1、修改index方法为：</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;index.html&#x27;</span>,&#123;<span class="string">&#x27;title&#x27;</span>: <span class="string">&#x27;DTL&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure><p>2、修改index.html为：</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Index<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span></span><span class="template-variable">&#123;&#123;<span class="name">title</span>&#125;&#125;</span><span class="language-xml"><span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>first template!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>3、测试访问<br>启动django，访问 <a target="_blank" rel="noopener" href="http://localhost:8000/blog/">http://localhost:8000/blog/</a> ，即可看到渲染好的页面。</p><blockquote><p>不同应用下的templates目录会发生冲突，django按照INSTALLED_APP中的顺序查找templates。为了解决这个问题，我们需要在templates目录中加一层目录，以应用名为名。而模板，都放到这一层目录中。</p></blockquote><p>4、在templates目录下，新建blog文件夹，把index.html移动到blog文件夹中。同时，修改index函数为：</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;blog/index.html&#x27;</span>,&#123;<span class="string">&#x27;title&#x27;</span>: <span class="string">&#x27;DTL&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure><h1 id="增删查改"><span class="post-title-index">3.</span><a href="#增删查改" class="headerlink" title="增删查改"></a> 增删查改</h1><p>django默认使用db.sqlite3数据库，我们暂时不进行修改。</p><h2 id="Model"><span class="post-title-index">3.1.</span><a href="#Model" class="headerlink" title="Model"></a> Model</h2><p>1、在blog/models.py中添加一个类Article：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">class Article(models.Model):</span><br><span class="line">    title = models.CharField(<span class="attribute">max_length</span>=32, <span class="attribute">default</span>=<span class="string">&#x27;Title&#x27;</span>)</span><br><span class="line">    content = models.TextField(<span class="attribute">null</span>=<span class="literal">True</span>)</span><br><span class="line">    # 参数 <span class="attribute">auto_now</span>=<span class="literal">True</span> 表示自动添加隐藏的时间</span><br><span class="line">    pub_time = models.DateTimeField(<span class="attribute">null</span>=<span class="literal">True</span>, <span class="attribute">auto_now</span>=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    def __str__(self):</span><br><span class="line">        return self.title</span><br></pre></td></tr></table></figure><p>关于属性的配置，参考<a target="_blank" rel="noopener" href="https://docs.djangoproject.com/en/1.11/ref/models/fields/">Model field reference</a>。</p><p>2、生成数据表<br><code>python manage.py makemigrations blog</code>，创建model，生成的文件在blog/migrations目录下</p><p><code>python manage.py migrate</code>，根据model生成数据库表</p><p>3、查看sql语句<br><code>python manage.py sqlmigrate blog 0001</code></p><p>4、下载安装<a target="_blank" rel="noopener" href="http://www.sqliteexpert.com/download.html">SQLite Expert Personal</a>，双击db.sqlite3文件即可查看编辑数据库。</p><p>5、使用SQLiteExpert，在blog_article表中添加数据。</p><h2 id="查找数据"><span class="post-title-index">3.2.</span><a href="#查找数据" class="headerlink" title="查找数据"></a> 查找数据</h2><p>1、在blog/views.py中添加方法：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> models</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">list</span>(<span class="params">request</span>):</span><br><span class="line">    articles = models.Article.objects.<span class="built_in">all</span>()</span><br><span class="line">    article = models.Article.objects.get(pk=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;blog/list.html&#x27;</span>,&#123;<span class="string">&#x27;articles&#x27;</span>:articles,<span class="string">&#x27;article&#x27;</span>:article&#125;)</span><br></pre></td></tr></table></figure><p>2、在migrations/blog中添加list.html文件</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>List<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>第一篇文章<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>标题：</span><span class="template-variable">&#123;&#123;<span class="name">article.title</span>&#125;&#125;</span><span class="language-xml"><span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>内容</span><span class="template-variable">&#123;&#123;<span class="name">article.content</span>&#125;&#125;</span><span class="language-xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>文章列表<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>标题<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>内容<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;% for article in articles %&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><span class="template-variable">&#123;&#123;<span class="name">article.title</span>&#125;&#125;</span><span class="language-xml"><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><span class="template-variable">&#123;&#123;<span class="name">article.content</span>&#125;&#125;</span><span class="language-xml"><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;% endfor %&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>3、修改blog/urls.py为：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.conf.urls <span class="keyword">import</span> url</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    url(<span class="string">r&#x27;^$&#x27;</span>, views.index, name=<span class="string">&#x27;index&#x27;</span>),</span><br><span class="line">    url(<span class="string">r&#x27;^index$&#x27;</span>, views.index, name=<span class="string">&#x27;index&#x27;</span>),</span><br><span class="line">    url(<span class="string">r&#x27;^helloworld$&#x27;</span>, views.hello, name=<span class="string">&#x27;hello&#x27;</span>),</span><br><span class="line">    url(<span class="string">r&#x27;^list$&#x27;</span>,views.<span class="built_in">list</span>, name=<span class="string">&#x27;list&#x27;</span>)</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>4、测试访问<br>访问地址 <a target="_blank" rel="noopener" href="http://localhost:8000/blog/list">http://localhost:8000/blog/list</a> ，即可看到渲染后的效果。</p><h2 id="增加数据"><span class="post-title-index">3.3.</span><a href="#增加数据" class="headerlink" title="增加数据"></a> 增加数据</h2><p>1、在blog/urls.py中添加：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(<span class="string">r&#x27;^add$&#x27;</span>,views.add, name=<span class="string">&#x27;add&#x27;</span>),</span><br></pre></td></tr></table></figure><p>2、在blog/views.py中添加方法：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import json</span><br><span class="line">def <span class="built_in">add</span>(request):</span><br><span class="line">    title = request.GET.<span class="built_in">get</span>(<span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;defaultTitle&#x27;</span>)</span><br><span class="line">    content = request.GET.<span class="built_in">get</span>(<span class="string">&#x27;content&#x27;</span>, <span class="string">&#x27;defaultContent&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    article = models.Article.objects.create(<span class="attribute">title</span>=title, <span class="attribute">content</span>=content)</span><br><span class="line"></span><br><span class="line">    result = &#123;<span class="string">&#x27;code&#x27;</span>: 0, <span class="string">&#x27;ext&#x27;</span>: <span class="string">&#x27;success&#x27;</span>, <span class="string">&#x27;article_id&#x27;</span>: article.id&#125;</span><br><span class="line">    return HttpResponse(json.dumps(result,<span class="attribute">ensure_ascii</span>=<span class="literal">False</span>))</span><br></pre></td></tr></table></figure><p>3、测试访问<br>访问地址 <a target="_blank" rel="noopener" href="http://localhost:8000/blog/add?title=test&amp;content=test">http://localhost:8000/blog/add?title=test&amp;content=test</a> ，即可看到添加成功的提示。</p><h2 id="修改数据"><span class="post-title-index">3.4.</span><a href="#修改数据" class="headerlink" title="修改数据"></a> 修改数据</h2><p>1、在blog/urls.py中添加：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(<span class="string">r&#x27;^edit$&#x27;</span>,views.edit, name=<span class="string">&#x27;edit&#x27;</span>),</span><br></pre></td></tr></table></figure><p>2、在blog/views.py中添加方法：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">def <span class="built_in">edit</span>(request):</span><br><span class="line">    article_id = request.GET.<span class="built_in">get</span>(<span class="string">&#x27;id&#x27;</span>, 0)</span><br><span class="line">    title = request.GET.<span class="built_in">get</span>(<span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;defaultTitle&#x27;</span>)</span><br><span class="line">    content = request.GET.<span class="built_in">get</span>(<span class="string">&#x27;content&#x27;</span>, <span class="string">&#x27;defaultContent&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    article = models.Article.objects.<span class="built_in">get</span>(<span class="attribute">pk</span>=article_id)</span><br><span class="line">    article.title = title</span><br><span class="line">    article.content = content</span><br><span class="line">    article.save()</span><br><span class="line"></span><br><span class="line">    result = &#123;<span class="string">&#x27;code&#x27;</span>: 0, <span class="string">&#x27;ext&#x27;</span>: <span class="string">&#x27;success&#x27;</span>, <span class="string">&#x27;article_id&#x27;</span>: article.id&#125;</span><br><span class="line">    return HttpResponse(json.dumps(result,<span class="attribute">ensure_ascii</span>=<span class="literal">False</span>))</span><br></pre></td></tr></table></figure><p>3、测试访问<br>访问地址 <a target="_blank" rel="noopener" href="http://localhost:8000/blog/edit?id=1&amp;title=test&amp;content=test222">http://localhost:8000/blog/edit?id=1&amp;title=test&amp;content=test222</a> ，即可看到修改成功的提示。</p><p>PS：修改数据和增加数据可以合成为一个接口，例如：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">def <span class="built_in">edit</span>(request):</span><br><span class="line">    article_id = request.GET.<span class="built_in">get</span>(<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">    title = request.GET.<span class="built_in">get</span>(<span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;defaultTitle&#x27;</span>)</span><br><span class="line">    content = request.GET.<span class="built_in">get</span>(<span class="string">&#x27;content&#x27;</span>, <span class="string">&#x27;defaultContent&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> article_id == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">        article = models.Article.objects.create(<span class="attribute">title</span>=title, <span class="attribute">content</span>=content)</span><br><span class="line">        result = &#123;<span class="string">&#x27;code&#x27;</span>: 0, <span class="string">&#x27;ext&#x27;</span>: <span class="string">&#x27;success&#x27;</span>, <span class="string">&#x27;article_id&#x27;</span>: article.id&#125;</span><br><span class="line">        return HttpResponse(json.dumps(result,<span class="attribute">ensure_ascii</span>=<span class="literal">False</span>))</span><br><span class="line"></span><br><span class="line">    article = models.Article.objects.<span class="built_in">get</span>(<span class="attribute">pk</span>=article_id)</span><br><span class="line">    article.title = title</span><br><span class="line">    article.content = content</span><br><span class="line">    article.save()</span><br><span class="line">    result = &#123;<span class="string">&#x27;code&#x27;</span>: 0, <span class="string">&#x27;ext&#x27;</span>: <span class="string">&#x27;success&#x27;</span>, <span class="string">&#x27;article_id&#x27;</span>: article.id&#125;</span><br><span class="line">    return HttpResponse(json.dumps(result,<span class="attribute">ensure_ascii</span>=<span class="literal">False</span>))</span><br></pre></td></tr></table></figure><h2 id="删除数据"><span class="post-title-index">3.5.</span><a href="#删除数据" class="headerlink" title="删除数据"></a> 删除数据</h2><p>1、在blog/urls.py中添加：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(<span class="string">r&#x27;^delete$&#x27;</span>,views.<span class="keyword">delete</span>, name=<span class="string">&#x27;delete&#x27;</span>),</span><br></pre></td></tr></table></figure><p>2、在blog/views.py中添加方法：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">def delete(request):</span><br><span class="line">    article_id = request.GET.<span class="built_in">get</span>(<span class="string">&#x27;id&#x27;</span>, 0)</span><br><span class="line">    models.Article.objects.<span class="built_in">get</span>(<span class="attribute">pk</span>=article_id).delete()</span><br><span class="line">    result = &#123;<span class="string">&#x27;code&#x27;</span>: 0, <span class="string">&#x27;ext&#x27;</span>: <span class="string">&#x27;success&#x27;</span>&#125;</span><br><span class="line">    return HttpResponse(json.dumps(result,<span class="attribute">ensure_ascii</span>=<span class="literal">False</span>))</span><br></pre></td></tr></table></figure><p>3、测试访问<br>访问地址 <a target="_blank" rel="noopener" href="http://localhost:8000/blog/delete?id=1">http://localhost:8000/blog/delete?id=1</a> ，即可看到删除成功的提示。</p><h2 id="Model转JSON"><span class="post-title-index">3.6.</span><a href="#Model转JSON" class="headerlink" title="Model转JSON"></a> Model转JSON</h2><blockquote><p>要想最终得到一个json数据，前提是我们要拥有一个dict，所以Model转JSON问题就归结为怎样组装出一个dict。</p></blockquote><p>示例一：在add方法中，我们返回的结果是json格式。如果想要把article（Model）也放进结果中，该怎么处理？参考<a target="_blank" rel="noopener" href="http://www.runoob.com/python/python-json.html">Python JSON</a>和<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Raymon-Geng/p/5786606.html">django的model对象转化成dict</a>，修改代码如下：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.forms.models import model_to_dict</span><br><span class="line">def <span class="built_in">add</span>(request):</span><br><span class="line">    title = request.GET.<span class="built_in">get</span>(<span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;defaultTitle&#x27;</span>)</span><br><span class="line">    content = request.GET.<span class="built_in">get</span>(<span class="string">&#x27;content&#x27;</span>, <span class="string">&#x27;defaultContent&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    article = models.Article.objects.create(<span class="attribute">title</span>=title, <span class="attribute">content</span>=content)</span><br><span class="line">    article = model_to_dict(article)</span><br><span class="line"></span><br><span class="line">    result = &#123;<span class="string">&#x27;code&#x27;</span>: 0, <span class="string">&#x27;ext&#x27;</span>: <span class="string">&#x27;success&#x27;</span>,<span class="string">&#x27;article&#x27;</span>: article&#125;</span><br><span class="line">    return HttpResponse(json.dumps(result,<span class="attribute">ensure_ascii</span>=<span class="literal">False</span>))</span><br></pre></td></tr></table></figure><p>示例二：如果想要把articles（Models）也放进结果中，该怎么处理？参考<a target="_blank" rel="noopener" href="https://www.cnblogs.com/alstonlee/p/6589638.html">django 返回json数据</a>。<br>首先，把Models序列化为json格式数据；然后，使用json.loads转换为dict格式数据；最后，把转换后的dict和其他dict格式数据组装到一起。</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.core import serializers</span><br><span class="line">def <span class="built_in">add</span>(request):</span><br><span class="line">    title = request.GET.<span class="built_in">get</span>(<span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;defaultTitle&#x27;</span>)</span><br><span class="line">    content = request.GET.<span class="built_in">get</span>(<span class="string">&#x27;content&#x27;</span>, <span class="string">&#x27;defaultContent&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    article = models.Article.objects.create(<span class="attribute">title</span>=title, <span class="attribute">content</span>=content)</span><br><span class="line">    article = model_to_dict(article)</span><br><span class="line">    articles = models.Article.objects.all()</span><br><span class="line">    json_data = serializers.serialize(<span class="string">&quot;json&quot;</span>, articles)</span><br><span class="line">    dict_data = json.loads(json_data)</span><br><span class="line">    result = &#123;</span><br><span class="line">        <span class="string">&#x27;code&#x27;</span>: 0,</span><br><span class="line">        <span class="string">&#x27;ext&#x27;</span>: <span class="string">&#x27;success&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;article&#x27;</span>: article,</span><br><span class="line">        <span class="string">&#x27;articles&#x27;</span>: dict_data&#125;</span><br><span class="line">    return HttpResponse(json.dumps(result, <span class="attribute">ensure_ascii</span>=<span class="literal">False</span>))</span><br></pre></td></tr></table></figure><h2 id="sqlite清空表命令"><span class="post-title-index">3.7.</span><a href="#sqlite清空表命令" class="headerlink" title="sqlite清空表命令"></a> sqlite清空表命令</h2><p><code>delete from &#39;blog_article&#39;;</code><br><code>update sqlite_sequence set seq = 0 where name = &#39;blog_article&#39;;</code></p><h1 id="POST问题"><span class="post-title-index">4.</span><a href="#POST问题" class="headerlink" title="POST问题"></a> POST问题</h1><p>修改add方法为：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">def <span class="built_in">add</span>(request):</span><br><span class="line">    title = request.POST.<span class="built_in">get</span>(<span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;defaultTitle&#x27;</span>)</span><br><span class="line">    content = request.POST.<span class="built_in">get</span>(<span class="string">&#x27;content&#x27;</span>, <span class="string">&#x27;defaultContent&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    article = models.Article.objects.create(<span class="attribute">title</span>=title, <span class="attribute">content</span>=content)</span><br><span class="line">    article = model_to_dict(article)</span><br><span class="line">    articles = models.Article.objects.all()</span><br><span class="line">    json_data = serializers.serialize(<span class="string">&quot;json&quot;</span>, articles)</span><br><span class="line">    dict_data = json.loads(json_data)</span><br><span class="line">    result = &#123;</span><br><span class="line">        <span class="string">&#x27;code&#x27;</span>: 0,</span><br><span class="line">        <span class="string">&#x27;ext&#x27;</span>: <span class="string">&#x27;success&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;article&#x27;</span>: article,</span><br><span class="line">        <span class="string">&#x27;articles&#x27;</span>: dict_data&#125;</span><br><span class="line">    return HttpResponse(json.dumps(result, <span class="attribute">ensure_ascii</span>=<span class="literal">False</span>))</span><br></pre></td></tr></table></figure><p>使用postman发送post请求时遇到如下错误：</p><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CSRF verification failed. Request aborted.</span><br></pre></td></tr></table></figure><p>解决办法，使用csrf_exempt装饰器：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.views.decorators.csrf import csrf_exempt</span><br><span class="line">@csrf_exempt</span><br><span class="line">def <span class="built_in">add</span>(request):</span><br><span class="line">    title = request.POST.<span class="built_in">get</span>(<span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;defaultTitle&#x27;</span>)</span><br><span class="line">    content = request.POST.<span class="built_in">get</span>(<span class="string">&#x27;content&#x27;</span>, <span class="string">&#x27;defaultContent&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    article = models.Article.objects.create(<span class="attribute">title</span>=title, <span class="attribute">content</span>=content)</span><br><span class="line">    article = model_to_dict(article)</span><br><span class="line">    articles = models.Article.objects.all()</span><br><span class="line">    json_data = serializers.serialize(<span class="string">&quot;json&quot;</span>, articles)</span><br><span class="line">    dict_data = json.loads(json_data)</span><br><span class="line">    result = &#123;</span><br><span class="line">        <span class="string">&#x27;code&#x27;</span>: 0,</span><br><span class="line">        <span class="string">&#x27;ext&#x27;</span>: <span class="string">&#x27;success&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;article&#x27;</span>: article,</span><br><span class="line">        <span class="string">&#x27;articles&#x27;</span>: dict_data&#125;</span><br><span class="line">    return HttpResponse(json.dumps(result, <span class="attribute">ensure_ascii</span>=<span class="literal">False</span>))</span><br></pre></td></tr></table></figure><h1 id="时间处理"><span class="post-title-index">5.</span><a href="#时间处理" class="headerlink" title="时间处理"></a> 时间处理</h1><h2 id="修改时区"><span class="post-title-index">5.1.</span><a href="#修改时区" class="headerlink" title="修改时区"></a> 修改时区</h2><p>查看db.sqlite3数据库，可以看到通过接口添加的数据时间不对。<br>参考<a target="_blank" rel="noopener" href="https://www.cnblogs.com/alan-babyblog/p/5739004.html">django时间的时区问题</a>，修改settings.py：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">USE_TZ</span> = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="attr">TIME_ZONE</span> = <span class="string">&#x27;Asia/Shanghai&#x27;</span></span><br></pre></td></tr></table></figure><p>设置了USE_TZ=True，则存储到数据库中的时间永远是UTC时间。<br>设置了TIME_ZONE = ‘Asia/Shanghai’，能保证证模板时间的正确显示。</p><p>这时如果TIME_ZONE = ‘UTC’，用datetime.datetime.now()获取时间，django会把这个时间当成UTC时间存储到数据库中去。<br>如果修改设置为TIME_ZONE = ‘Asia/Shanghai’，用datetime.datetime.now()获取时间，django会把这个时间当成Asia/Shanghai时间，即东八区时间，然后django会把这个时间转成带时区UTC时间存储到数据库中去，而读的时候直接按UTC时间读出来，这就是很多人遇到的存储到数据库中的时间比本地时间会小8个小时的原因。</p><p>如果要获取当前时区时间，则使用django.utils.timezone.now()。</p><h2 id="Model-1"><span class="post-title-index">5.2.</span><a href="#Model-1" class="headerlink" title="Model"></a> Model</h2><p>参考<a target="_blank" rel="noopener" href="http://www.nanerbang.com/article/5488/">django：DateTimeField如何自动设置为当前时间并且能被修改</a>，我们来修改一下blog/models.py。</p><p>创建django的model时，有DateTimeField、DateField和TimeField三种类型可以用来创建日期字段，其值分别对应着datetime()、date()、time()三中对象。这三个field有着相同的参数auto_now和auto_now_add，表面上看起来很easy，但实际使用中很容易出错，下面是一些注意点。</p><p><strong>DateTimeField.auto_now</strong></p><p>这个参数的默认值为false，设置为true时，能够在保存该字段时，将其值设置为当前时间，并且每次修改model，都会自动更新。因此这个参数在需要存储“最后修改时间”的场景下，十分方便。需要注意的是，设置该参数为true时，并不简单地意味着字段的默认值为当前时间，而是指字段会被“强制”更新到当前时间，你无法程序中手动为字段赋值；如果使用django再带的admin管理器，那么该字段在admin中是只读的。</p><p><strong>DateTimeField.auto_now_add</strong></p><p>这个参数的默认值也为False，设置为True时，会在model对象第一次被创建时，将字段的值设置为创建时的时间，以后修改对象时，字段的值不会再更新。该属性通常被用在存储“创建时间”的场景下。与auto_now类似，auto_now_add也具有强制性，一旦被设置为True，就无法在程序中手动为字段赋值，在admin中字段也会成为只读的。</p><p><strong>如何将创建时间设置为“默认当前”并且可修改</strong></p><p>那么问题来了。实际场景中，往往既希望在对象的创建时间默认被设置为当前值，又希望能在日后修改它。怎么实现这种需求呢？</p><p>django中所有的model字段都拥有一个default参数，用来给字段设置默认值。可以用default=timezone.now来替换auto_now=True或auto_now_add=True。timezone.now对应着django.utils.timezone.now()，因此需要写成类似下面的形式：</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"><span class="keyword">import</span> django.utils.timezone <span class="keyword">as</span> timezone</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="type">Article</span>(<span class="title">models</span>.<span class="type">Model</span>):</span></span><br><span class="line"><span class="class">    title = models.<span class="type">CharField</span>(<span class="title">max_length</span>=32, <span class="title">default</span>=&#x27;<span class="type">Title</span>&#x27;)</span></span><br><span class="line"><span class="class">    content = models.<span class="type">TextField</span>(<span class="title">null</span>=<span class="type">True</span>)</span></span><br><span class="line"><span class="class">    pub_time = models.<span class="type">DateTimeField</span>(&#x27;发布日期&#x27;, <span class="title">default</span>=<span class="title">timezone</span>.<span class="title">now</span>)</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">    def __str__(<span class="title">self</span>):</span></span><br><span class="line"><span class="class">        return self.title</span></span><br></pre></td></tr></table></figure><h2 id="DateEncoder"><span class="post-title-index">5.3.</span><a href="#DateEncoder" class="headerlink" title="DateEncoder"></a> DateEncoder</h2><p>经过上面的修改，时间是可以修改了，但是同时引入了另外一个问题，在add接口中，json.dumps()函数会报错：</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TypeError: <span class="keyword">Object</span> <span class="keyword">of</span> <span class="keyword">type</span> <span class="string">&#x27;datetime&#x27;</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="type">JSON</span> <span class="keyword">serializable</span></span><br></pre></td></tr></table></figure><p>这是因为json.dumps()函数无法解析datetime格式的数据。<br>问题来了，auto_now=True时，json.dumps()却可以解析，莫非此时不是datetime格式？<br>且不管它，我们先解决datetime转json问题。</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json  </span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="type">DateEncoder</span>(<span class="title">json</span>.<span class="type">JSONEncoder</span>):</span></span><br><span class="line"><span class="class">    def default(<span class="title">self</span>, <span class="title">obj</span>):</span></span><br><span class="line"><span class="class">        if isinstance(<span class="title">obj</span>, <span class="title">datetime</span>.<span class="title">datetime</span>):</span></span><br><span class="line"><span class="class">            return obj.strftime(&#x27;%<span class="type">Y</span>-%<span class="title">m</span>-%<span class="title">d</span> %<span class="type">H</span>:%<span class="type">M</span>:%<span class="type">S</span>&#x27;)</span></span><br><span class="line"><span class="class">        elif isinstance(<span class="title">obj</span>, <span class="title">date</span>):</span></span><br><span class="line"><span class="class">            return obj.strftime(&#x27;%<span class="type">Y</span>-%<span class="title">m</span>-%<span class="title">d&#x27;</span>)</span></span><br><span class="line"><span class="class">        else:</span></span><br><span class="line"><span class="class">            return json.<span class="type">JSONEncoder</span>.default(<span class="title">self</span>, <span class="title">obj</span>)</span></span><br></pre></td></tr></table></figure><p>在使用json.dumps()函数时，添加cls参数：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">json.dumps(result, <span class="attribute">cls</span>=DateEncoder, <span class="attribute">ensure_ascii</span>=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><h2 id="页面渲染"><span class="post-title-index">5.4.</span><a href="#页面渲染" class="headerlink" title="页面渲染"></a> 页面渲染</h2><p>设置好时区后，在页面渲染时，会自动转化成当前时区时间，例如<code>Nov. 29, 2017, 1:49 p.m.</code></p><p>但是，这种格式不符合我们的阅读习惯，我们可以在渲染时改成自己喜欢的格式：</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="template-variable">&#123;&#123;<span class="name">article.pub_time</span>|date:<span class="string">&quot;Y-m-d H:i:s&quot;</span>&#125;&#125;</span></span><br></pre></td></tr></table></figure><p>此时，输出到页面的格式就变成了<code>2017-11-29 13:49:44</code></p><h2 id="json-UTC处理"><span class="post-title-index">5.5.</span><a href="#json-UTC处理" class="headerlink" title="json UTC处理"></a> json UTC处理</h2><p>以add接口为例，从数据库中查询出的数据时间是UTC格式的，例如<code>2017-11-29T05:49:44.092Z</code></p><p><strong>思路一：</strong><br>直接返回UTC格式数据给前端，前端来完成格式化，参考<a target="_blank" rel="noopener" href="http://blog.csdn.net/yw1688/article/details/21110369">js格式化json传来的UTC格式的时间</a>，或者使用支持UTC格式化的模板引擎。</p><p><strong>思路二：</strong><br>参考遍历QuerySet，给每一个pub_time转换格式：</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> <span class="type">time</span></span><br><span class="line">def utc2local(utc_st):</span><br><span class="line">    # UTC时间转本地时间（+<span class="number">8</span>:<span class="number">00</span>）</span><br><span class="line">    now_stamp = <span class="type">time</span>.time()</span><br><span class="line">    local_time = datetime.datetime.fromtimestamp(now_stamp)</span><br><span class="line">    utc_time = datetime.datetime.utcfromtimestamp(now_stamp)</span><br><span class="line">    <span class="keyword">offset</span> = local_time - utc_time</span><br><span class="line">    local_st = utc_st + <span class="keyword">offset</span></span><br><span class="line">    <span class="keyword">return</span> local_st</span><br></pre></td></tr></table></figure><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> item in articles:</span><br><span class="line">    <span class="comment"># print(item.pub_time)</span></span><br><span class="line">    local_time = utc2local(item.pub_time)</span><br><span class="line">    <span class="comment"># UTC_FORMAT = &quot;%Y-%m-%dT%H:%M:%S.%fZ&quot;</span></span><br><span class="line">    LOCAL_FORMAT = <span class="string">&quot;<span class="variable">%Y</span>-<span class="variable">%m</span>-<span class="variable">%d</span> <span class="variable">%H</span>:<span class="variable">%M</span>:<span class="variable">%S</span>&quot;</span></span><br><span class="line">    <span class="comment"># print(local_time.strftime(LOCAL_FORMAT))</span></span><br><span class="line">    local_time_str = local_time.strftime(LOCAL_FORMAT)</span><br><span class="line">    item.pub_time = datetime.datetime.strptime(local_time_str, LOCAL_FORMAT)</span><br></pre></td></tr></table></figure><p>这种方法返回的时间，格式为<code>2017-11-29T13:49:44</code>，还是有问题，多了个T。<br>我们为什么不把local_time_str赋值给item.pub_time呢？因为item.put_time限制数据类型为datetime。</p><p><strong>思路三：</strong><br>存储时，直接存储字符串格式的时间。修改blog/models.py如下：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db import models</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create your models here.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Article(models.Model):</span><br><span class="line">    title = models.CharField(<span class="attribute">max_length</span>=32, <span class="attribute">default</span>=<span class="string">&#x27;Title&#x27;</span>)</span><br><span class="line">    content = models.TextField(<span class="attribute">null</span>=<span class="literal">True</span>)</span><br><span class="line">    # pub_time = models.DateTimeField(<span class="string">&#x27;发布日期&#x27;</span>, <span class="attribute">default</span>=timezone.now)</span><br><span class="line">    pub_time = models.CharField(<span class="attribute">max_length</span>=64, <span class="attribute">default</span>=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    def __str__(self):</span><br><span class="line">        return self.title</span><br></pre></td></tr></table></figure><p>修改add和edit接口为：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">import json</span><br><span class="line"><span class="keyword">from</span> django.forms.models import model_to_dict</span><br><span class="line"><span class="keyword">from</span> django.views.decorators.csrf import csrf_exempt</span><br><span class="line">import datetime</span><br><span class="line">import time</span><br><span class="line"><span class="keyword">from</span> django.utils import timezone</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@csrf_exempt</span><br><span class="line">def <span class="built_in">add</span>(request):</span><br><span class="line">    title = request.POST.<span class="built_in">get</span>(<span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;defaultTitle&#x27;</span>)</span><br><span class="line">    content = request.POST.<span class="built_in">get</span>(<span class="string">&#x27;content&#x27;</span>, <span class="string">&#x27;defaultContent&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    pub_time = utc2local(timezone.now())</span><br><span class="line">    LOCAL_FORMAT = <span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span></span><br><span class="line">    pub_time = pub_time.strftime(LOCAL_FORMAT)</span><br><span class="line"></span><br><span class="line">    article = models.Article.objects.create(<span class="attribute">title</span>=title, <span class="attribute">content</span>=content, <span class="attribute">pub_time</span>=pub_time)</span><br><span class="line">    article = model_to_dict(article)</span><br><span class="line"></span><br><span class="line">    result = &#123;</span><br><span class="line">        <span class="string">&#x27;code&#x27;</span>: 0,</span><br><span class="line">        <span class="string">&#x27;ext&#x27;</span>: <span class="string">&#x27;success&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;article&#x27;</span>: article&#125;</span><br><span class="line">    return HttpResponse(json.dumps(result, <span class="attribute">ensure_ascii</span>=<span class="literal">False</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@csrf_exempt</span><br><span class="line">def <span class="built_in">edit</span>(request):</span><br><span class="line">    article_id = request.POST.<span class="built_in">get</span>(<span class="string">&#x27;id&#x27;</span>, 0)</span><br><span class="line">    title = request.POST.<span class="built_in">get</span>(<span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;defaultTitle&#x27;</span>)</span><br><span class="line">    content = request.POST.<span class="built_in">get</span>(<span class="string">&#x27;content&#x27;</span>, <span class="string">&#x27;defaultContent&#x27;</span>)</span><br><span class="line">    pub_time = utc2local(timezone.now())</span><br><span class="line">    LOCAL_FORMAT = <span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span></span><br><span class="line">    pub_time = pub_time.strftime(LOCAL_FORMAT)</span><br><span class="line"></span><br><span class="line">    article = models.Article.objects.<span class="built_in">get</span>(<span class="attribute">pk</span>=article_id)</span><br><span class="line">    article.title = title</span><br><span class="line">    article.content = content</span><br><span class="line">    article.pub_time = pub_time</span><br><span class="line">    article.save()</span><br><span class="line"></span><br><span class="line">    article = model_to_dict(article)</span><br><span class="line"></span><br><span class="line">    result = &#123;</span><br><span class="line">        <span class="string">&#x27;code&#x27;</span>: 0,</span><br><span class="line">        <span class="string">&#x27;ext&#x27;</span>: <span class="string">&#x27;success&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;article&#x27;</span>: article&#125;</span><br><span class="line">    return HttpResponse(json.dumps(result, <span class="attribute">ensure_ascii</span>=<span class="literal">False</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def utc2local(utc_st):</span><br><span class="line">    # UTC时间转本地时间（+8:00）</span><br><span class="line">    now_stamp = time.time()</span><br><span class="line">    local_time = datetime.datetime.fromtimestamp(now_stamp)</span><br><span class="line">    utc_time = datetime.datetime.utcfromtimestamp(now_stamp)</span><br><span class="line">    offset = local_time - utc_time</span><br><span class="line">    local_st = utc_st + offset</span><br><span class="line">    return local_st</span><br></pre></td></tr></table></figure><h1 id="源码分享"><span class="post-title-index">6.</span><a href="#源码分享" class="headerlink" title="源码分享"></a> 源码分享</h1><p><a target="_blank" rel="noopener" href="https://github.com/voidking/djsite/releases/tag/v0.1.0">https://github.com/voidking/djsite/releases/tag/v0.1.0</a></p><h1 id="小结"><span class="post-title-index">7.</span><a href="#小结" class="headerlink" title="小结"></a> 小结</h1><p>至此，涉猎了django开发blog所需要的基本知识。下文中，将会在实战中学习django更高级的用法。</p><h1 id="书签"><span class="post-title-index">8.</span><a href="#书签" class="headerlink" title="书签"></a> 书签</h1><p><a target="_blank" rel="noopener" href="https://www.imooc.com/learn/790">django入门与实践</a></p></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 好好学习的郝</li><li class="post-copyright-link"> <strong>原文链接：</strong> <a href="https://www.voidking.com/dev-django-blog-0/" title="好好学Python：Django开发简单Blog系统——上">https://www.voidking.com/dev-django-blog-0/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本文采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议，转载请注明出处！源站会即时更新知识点并修正错误，欢迎访问~</li><li> <img width="200" height="200" src="/images/avatar.jpg"><p style="text-align:center;margin-bottom:0">微信公众号同步更新，欢迎关注~</p></li></ul></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/python/" rel="tag"># python</a> <a href="/tags/django/" rel="tag"># django</a> <a href="/tags/%E5%A5%BD%E5%A5%BD%E5%AD%A6Python/" rel="tag"># 好好学Python</a></div><div class="post-nav"><div class="post-nav-item"><a href="/dev-django-start/" rel="prev" title="好好学Python：Django入门篇"><i class="fa fa-chevron-left"></i> 好好学Python：Django入门篇</a></div><div class="post-nav-item"> <a href="/dev-django-blog-1/" rel="next" title="好好学Python：Django开发简单Blog系统——中">好好学Python：Django开发简单Blog系统——中<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><div class="footer-ads" style="margin-top:10px"><ins class="adsbygoogle" style="display:block" data-ad-format="autorelaxed" data-ad-client="ca-pub-3284447971731414" data-ad-slot="9697986181"></ins><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3284447971731414" crossorigin="anonymous"></script><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div class="comments" id="gitalk-container"></div><script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-text">1. 前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E"><span class="nav-text">2. 模板引擎</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#first-template"><span class="nav-text">2.1. first template</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DTL"><span class="nav-text">2.2. DTL</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%A2%9E%E5%88%A0%E6%9F%A5%E6%94%B9"><span class="nav-text">3. 增删查改</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Model"><span class="nav-text">3.1. Model</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9F%A5%E6%89%BE%E6%95%B0%E6%8D%AE"><span class="nav-text">3.2. 查找数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A2%9E%E5%8A%A0%E6%95%B0%E6%8D%AE"><span class="nav-text">3.3. 增加数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE"><span class="nav-text">3.4. 修改数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="nav-text">3.5. 删除数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Model%E8%BD%ACJSON"><span class="nav-text">3.6. Model转JSON</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sqlite%E6%B8%85%E7%A9%BA%E8%A1%A8%E5%91%BD%E4%BB%A4"><span class="nav-text">3.7. sqlite清空表命令</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#POST%E9%97%AE%E9%A2%98"><span class="nav-text">4. POST问题</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%97%B6%E9%97%B4%E5%A4%84%E7%90%86"><span class="nav-text">5. 时间处理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E6%97%B6%E5%8C%BA"><span class="nav-text">5.1. 修改时区</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Model-1"><span class="nav-text">5.2. Model</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DateEncoder"><span class="nav-text">5.3. DateEncoder</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A1%B5%E9%9D%A2%E6%B8%B2%E6%9F%93"><span class="nav-text">5.4. 页面渲染</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#json-UTC%E5%A4%84%E7%90%86"><span class="nav-text">5.5. json UTC处理</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E4%BA%AB"><span class="nav-text">6. 源码分享</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93"><span class="nav-text">7. 小结</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B9%A6%E7%AD%BE"><span class="nav-text">8. 书签</span></a></li></ol></div></div><div class="sidecar-ads" style="margin-top:10px"><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="好好学习的郝" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">好好学习的郝</p><div class="site-description" itemprop="description">一个计算机技术爱好者与学习者</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">744</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">32</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">258</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:voidking@qq.com" title="E-Mail → mailto:voidking@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://github.com/voidking" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="http://weibo.com/voidking" title="Weibo → http:&#x2F;&#x2F;weibo.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i> Weibo</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/voidking" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-quora"></i> Zhihu</a></span></div></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2014 – <span itemprop="copyrightYear">2024</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">好好学习的郝</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="footer-beian"> <a href="http://beian.miit.gov.cn/" target="_blank">苏ICP备14021030号</a>&nbsp;|&nbsp; <img src="/images/beian.png" alt=""> <a target="_blank" href="http://www.beian.gov.cn/">苏公网安备 32032202000223号</a></div></div></footer></div><script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.css"><script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: '5a238b8c32b1e4dd2156',
      clientSecret: 'bfb5d518626f6fdc7da0351d1e0cd37ab75c6361',
      repo: 'gitalk-comments',
      owner: 'voidking',
      admin: ['voidking'],
      id: '8ba27a026383326657e7729da3a0f2e6',
      title: '好好学Python：Django开发简单Blog系统——上',
      body: '欢迎留言，互相交流学习~',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script></body></html>