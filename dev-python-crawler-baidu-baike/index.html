<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:new URL("https://www.voidking.com").hostname,root:"/",scheme:"Gemini",version:"7.7.1",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1,cdn:{enable:!0,url:"//cdn.jsdelivr.net/gh/voidking/voidking.github.io/search.xml"}},path:"search.xml",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="前言本文整理自慕课网《Python开发简单爬虫》，将会记录爬取百度百科“python”词条相关页面的整个过程。"><meta property="og:type" content="article"><meta property="og:title" content="Python抓取百度百科数据"><meta property="og:url" content="https://www.voidking.com/dev-python-crawler-baidu-baike/index.html"><meta property="og:site_name" content="好好学习的郝"><meta property="og:description" content="前言本文整理自慕课网《Python开发简单爬虫》，将会记录爬取百度百科“python”词条相关页面的整个过程。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://cdn.voidking.com//imgs/crawler-baidu-baike/analysis.jpg"><meta property="og:image" content="http://cdn.voidking.com//imgs/crawler-baidu-baike/href.jpg"><meta property="og:image" content="http://cdn.voidking.com//imgs/crawler-baidu-baike/title.jpg"><meta property="og:image" content="http://cdn.voidking.com//imgs/crawler-baidu-baike/summary.jpg"><meta property="og:image" content="http://cdn.voidking.com//imgs/crawler-baidu-baike/charset.jpg"><meta property="og:image" content="http://cdn.voidking.com//imgs/crawler-baidu-baike/result.jpg"><meta property="og:image" content="http://cdn.voidking.com//imgs/crawler-baidu-baike/structure.jpg"><meta property="og:image" content="http://cdn.voidking.com//imgs/crawler-baidu-baike/result1.jpg"><meta property="og:image" content="http://cdn.voidking.com//imgs/crawler-baidu-baike/result2.jpg"><meta property="article:published_time" content="2017-01-22T09:10:00.000Z"><meta property="article:modified_time" content="2017-01-22T09:10:00.000Z"><meta property="article:author" content="好好学习的郝"><meta property="article:tag" content="python"><meta property="article:tag" content="爬虫"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://cdn.voidking.com//imgs/crawler-baidu-baike/analysis.jpg"><link rel="canonical" href="https://www.voidking.com/dev-python-crawler-baidu-baike/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0}</script><title>Python抓取百度百科数据 | 好好学习的郝</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?b759ac2a7fa45129e3ef060bf68259f0";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="好好学习的郝" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">好好学习的郝</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">好好学习，天天向上！</h1></div><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/voidking" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.voidking.com/dev-python-crawler-baidu-baike/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="好好学习的郝"><meta itemprop="description" content="学而不思则罔，思而不学则殆！"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="好好学习的郝"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> Python抓取百度百科数据</h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2017-01-22 09:10:00" itemprop="dateCreated datePublished" datetime="2017-01-22T09:10:00+00:00">2017-01-22</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/" itemprop="url" rel="index"><span itemprop="name">engineering</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>本文整理自慕课网<a target="_blank" rel="noopener" href="http://www.imooc.com/learn/563">《Python开发简单爬虫》</a>，将会记录爬取百度百科“python”词条相关页面的整个过程。</p><span id="more"></span><h1 id="抓取策略"><a href="#抓取策略" class="headerlink" title="抓取策略"></a>抓取策略</h1><p><img src="http://cdn.voidking.com//imgs/crawler-baidu-baike/analysis.jpg"><br>确定目标：确定抓取哪个网站的哪些页面的哪部分数据。本实例抓取百度百科python词条页面以及python相关词条页面的标题和简介。<br>分析目标：分析要抓取的url的格式，限定抓取范围。分析要抓取的数据的格式，本实例中就要分析标题和简介这两个数据所在的标签的格式。分析要抓取的页面编码的格式，在网页解析器部分，要指定网页编码，然后才能进行正确的解析。<br>编写代码：在网页解析器部分，要使用到分析目标得到的结果。<br>执行爬虫：进行数据抓取。</p><h1 id="分析目标"><a href="#分析目标" class="headerlink" title="分析目标"></a>分析目标</h1><p>1、url格式<br>进入百度百科python词条页面，页面中相关词条的链接比较统一，大都是<code>/view/xxx.htm</code>。<br><img src="http://cdn.voidking.com//imgs/crawler-baidu-baike/href.jpg"></p><p>2、数据格式<br>标题位于类lemmaWgt-lemmaTitle-title下的h1子标签，简介位于类lemma-summary下。<br><img src="http://cdn.voidking.com//imgs/crawler-baidu-baike/title.jpg"><br><img src="http://cdn.voidking.com//imgs/crawler-baidu-baike/summary.jpg"></p><p>3、编码格式<br>查看页面编码格式，为utf-8。<br><img src="http://cdn.voidking.com//imgs/crawler-baidu-baike/charset.jpg"></p><p>经过以上分析，得到结果如下：<br><img src="http://cdn.voidking.com//imgs/crawler-baidu-baike/result.jpg"></p><h1 id="代码编写"><a href="#代码编写" class="headerlink" title="代码编写"></a>代码编写</h1><h2 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h2><p>在sublime下，新建文件夹baike-spider，作为项目根目录。<br>新建spider_main.py，作为爬虫总调度程序。<br>新建url_manger.py，作为url管理器。<br>新建html_downloader.py，作为html下载器。<br>新建html_parser.py，作为html解析器。<br>新建html_outputer.py，作为写出数据的工具。<br>最终项目结构如下图：<br><img src="http://cdn.voidking.com//imgs/crawler-baidu-baike/structure.jpg"></p><h2 id="spider-main-py"><a href="#spider-main-py" class="headerlink" title="spider_main.py"></a>spider_main.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> url_manager, html_downloader, html_parser, html_outputer</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SpiderMain</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.urls = url_manager.UrlManager()</span><br><span class="line">        self.downloader = html_downloader.HtmlDownloader()</span><br><span class="line">        self.parser = html_parser.HtmlParser()</span><br><span class="line">        self.outputer = html_outputer.HtmlOutputer()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">craw</span>(<span class="params">self, root_url</span>):</span><br><span class="line">        count = <span class="number">1</span></span><br><span class="line">        self.urls.add_new_url(root_url)</span><br><span class="line">        <span class="keyword">while</span> self.urls.has_new_url():</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                new_url = self.urls.get_new_url()</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;craw %d : %s&#x27;</span> % (count, new_url))</span><br><span class="line">                html_cont = self.downloader.download(new_url)</span><br><span class="line">                new_urls, new_data = self.parser.parse(new_url, html_cont)</span><br><span class="line">                self.urls.add_new_urls(new_urls)</span><br><span class="line">                self.outputer.collect_data(new_data)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> count == <span class="number">10</span>:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">                count = count + <span class="number">1</span></span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;craw failed&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        self.outputer.output_html()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    root_url = <span class="string">&#x27;http://baike.baidu.com/view/21087.htm&#x27;</span></span><br><span class="line">    obj_spider = SpiderMain()</span><br><span class="line">    obj_spider.craw(root_url)</span><br></pre></td></tr></table></figure><h2 id="url-manger-py"><a href="#url-manger-py" class="headerlink" title="url_manger.py"></a>url_manger.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UrlManager</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.new_urls = <span class="built_in">set</span>()</span><br><span class="line">        self.old_urls = <span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_new_url</span>(<span class="params">self, url</span>):</span><br><span class="line">        <span class="keyword">if</span> url <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> url <span class="keyword">not</span> <span class="keyword">in</span> self.new_urls <span class="keyword">and</span> url <span class="keyword">not</span> <span class="keyword">in</span> self.old_urls:</span><br><span class="line">            self.new_urls.add(url)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_new_urls</span>(<span class="params">self, urls</span>):</span><br><span class="line">        <span class="keyword">if</span> urls <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> <span class="built_in">len</span>(urls) == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">for</span> url <span class="keyword">in</span> urls:</span><br><span class="line">            self.add_new_url(url)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">has_new_url</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.new_urls) != <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_new_url</span>(<span class="params">self</span>):</span><br><span class="line">        new_url = self.new_urls.pop()</span><br><span class="line">        self.old_urls.add(new_url)</span><br><span class="line">        <span class="keyword">return</span> new_url</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="html-downloader-py"><a href="#html-downloader-py" class="headerlink" title="html_downloader.py"></a>html_downloader.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> urllib.request</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HtmlDownloader</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">download</span>(<span class="params">self, url</span>):</span><br><span class="line">        <span class="keyword">if</span> url <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        response = urllib.request.urlopen(url)</span><br><span class="line">        <span class="keyword">if</span> response.getcode() != <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">return</span> response.read()</span><br></pre></td></tr></table></figure><h2 id="html-parser-py"><a href="#html-parser-py" class="headerlink" title="html_parser.py"></a>html_parser.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urljoin</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HtmlParser</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_get_new_urls</span>(<span class="params">self, page_url, soup</span>):</span><br><span class="line">        new_urls = <span class="built_in">set</span>()</span><br><span class="line">        <span class="comment"># /view/123.htm</span></span><br><span class="line">        links = soup.find_all(<span class="string">&#x27;a&#x27;</span>, href=re.<span class="built_in">compile</span>(<span class="string">r&#x27;/view/\d+\.htm&#x27;</span>))</span><br><span class="line">        <span class="keyword">for</span> link <span class="keyword">in</span> links:</span><br><span class="line">            new_url = link[<span class="string">&#x27;href&#x27;</span>]</span><br><span class="line">            new_full_url = urljoin(page_url, new_url)</span><br><span class="line">            <span class="comment"># print(new_full_url)</span></span><br><span class="line">            new_urls.add(new_full_url)</span><br><span class="line">        <span class="comment">#print(new_urls)</span></span><br><span class="line">        <span class="keyword">return</span> new_urls</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_get_new_data</span>(<span class="params">self, page_url, soup</span>):</span><br><span class="line">        res_data = &#123;&#125;</span><br><span class="line">        <span class="comment"># url</span></span><br><span class="line">        res_data[<span class="string">&#x27;url&#x27;</span>] = page_url</span><br><span class="line">        <span class="comment"># &lt;dd class=&quot;lemmaWgt-lemmaTitle-title&quot;&gt; &lt;h1&gt;Python&lt;/h1&gt;</span></span><br><span class="line">        title_node = soup.find(<span class="string">&#x27;dd&#x27;</span>, class_=<span class="string">&#x27;lemmaWgt-lemmaTitle-title&#x27;</span>).find(<span class="string">&#x27;h1&#x27;</span>)</span><br><span class="line">        res_data[<span class="string">&#x27;title&#x27;</span>] = title_node.get_text()</span><br><span class="line">        <span class="comment"># &lt;div class=&quot;lemma-summary&quot; label-module=&quot;lemmaSummary&quot;&gt;</span></span><br><span class="line">        summary_node = soup.find(<span class="string">&#x27;div&#x27;</span>, class_=<span class="string">&#x27;lemma-summary&#x27;</span>)</span><br><span class="line">        res_data[<span class="string">&#x27;summary&#x27;</span>] = summary_node.get_text()</span><br><span class="line">        <span class="comment"># print(res_data)</span></span><br><span class="line">        <span class="keyword">return</span> res_data</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">parse</span>(<span class="params">self, page_url, html_cont</span>):</span><br><span class="line">        <span class="keyword">if</span> page_url <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> html_cont <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        soup = BeautifulSoup(html_cont, <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line">        <span class="comment"># print(soup.prettify())</span></span><br><span class="line">        new_urls = self._get_new_urls(page_url, soup)</span><br><span class="line">        new_data = self._get_new_data(page_url, soup)</span><br><span class="line">        <span class="comment"># print(&#x27;mark&#x27;)</span></span><br><span class="line">        <span class="keyword">return</span> new_urls, new_data</span><br></pre></td></tr></table></figure><h2 id="html-outputer-py"><a href="#html-outputer-py" class="headerlink" title="html_outputer.py"></a>html_outputer.py</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"># coding:utf-<span class="number">8</span></span><br><span class="line">class <span class="built_in">HtmlOutputer</span>(object):</span><br><span class="line">    def <span class="built_in">__init__</span>(self):</span><br><span class="line">        self.datas = []</span><br><span class="line"></span><br><span class="line">    def <span class="built_in">collect_data</span>(self, data):</span><br><span class="line">        if data is None:</span><br><span class="line">            return</span><br><span class="line">        self.datas.<span class="built_in">append</span>(data)</span><br><span class="line"></span><br><span class="line">    def <span class="built_in">output_html</span>(self):</span><br><span class="line">        fout = <span class="built_in">open</span>(<span class="string">&#x27;output.html&#x27;</span>,<span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        fout.<span class="built_in">write</span>(<span class="string">&#x27;&lt;html&gt;&#x27;</span>)</span><br><span class="line">        fout.<span class="built_in">write</span>(<span class="string">&#x27;&lt;body&gt;&#x27;</span>)</span><br><span class="line">        fout.<span class="built_in">write</span>(<span class="string">&#x27;&lt;table&gt;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        for data in self.datas:</span><br><span class="line">            fout.<span class="built_in">write</span>(<span class="string">&#x27;&lt;tr&gt;&#x27;</span>)</span><br><span class="line">            fout.<span class="built_in">write</span>(<span class="string">&#x27;&lt;td&gt;%s&lt;/td&gt;&#x27;</span> % data[<span class="string">&#x27;url&#x27;</span>])</span><br><span class="line">            fout.<span class="built_in">write</span>(<span class="string">&#x27;&lt;td&gt;%s&lt;/td&gt;&#x27;</span> % data[<span class="string">&#x27;title&#x27;</span>])</span><br><span class="line">            fout.<span class="built_in">write</span>(<span class="string">&#x27;&lt;td&gt;%s&lt;/td&gt;&#x27;</span> % data[<span class="string">&#x27;summary&#x27;</span>])</span><br><span class="line">            fout.<span class="built_in">write</span>(<span class="string">&#x27;&lt;/tr&gt;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        fout.<span class="built_in">write</span>(<span class="string">&#x27;&lt;/table&gt;&#x27;</span>)</span><br><span class="line">        fout.<span class="built_in">write</span>(<span class="string">&#x27;&lt;/body&gt;&#x27;</span>)</span><br><span class="line">        fout.<span class="built_in">write</span>(<span class="string">&#x27;&lt;/html&gt;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        fout.<span class="built_in">close</span>()</span><br></pre></td></tr></table></figure><h2 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h2><p>在命令行下，执行<code>python spider_main.py</code>。</p><h2 id="编码问题"><a href="#编码问题" class="headerlink" title="编码问题"></a>编码问题</h2><p>问题描述：UnicodeEncodeError: ‘gbk’ codec can’t encode character ‘\xa0’ in position …</p><p>使用Python写文件的时候，或者将网络数据流写入到本地文件的时候，大部分情况下会遇到这个问题。网络上有很多类似的文章讲述如何解决这个问题，但是无非就是encode，decode相关的，这是导致该问题出现的真正原因吗？不是的。很多时候，我们使用了decode和encode，试遍了各种编码，utf8，utf-8，gbk，gb2312等等，该有的编码都试遍了，可是仍然出现该错误，令人崩溃。</p><p>在windows下面编写python脚本，编码问题很严重。将网络数据流写入文件时，我们会遇到几个编码：<br>1、#encoding=’XXX’<br>这里(也就是python文件第一行的内容)的编码是指该python脚本文件本身的编码，无关紧要。只要XXX和文件本身的编码相同就行了。<br>比如notepad++”格式”菜单里面里可以设置各种编码，这时需要保证该菜单里设置的编码和encoding XXX相同就行了，不同的话会报错。</p><p>2、网络数据流的编码<br>比如获取网页，那么网络数据流的编码就是网页的编码。需要使用decode解码成unicode编码。</p><p>3、目标文件的编码<br>将网络数据流写入到新文件，写文件代码如下：</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fout = <span class="built_in">open</span>(<span class="string">&#x27;output.html&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">fout.<span class="built_in">write</span>(str)</span><br></pre></td></tr></table></figure><p>在windows下面，新文件的默认编码是gbk，python解释器会用gbk编码去解析我们的网络数据流str，然而str是decode过的unicode编码，这样的话就会导致解析不了，出现上述问题。 解决的办法是改变目标文件的编码：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">fout</span> = open(<span class="string">&#x27;output.html&#x27;</span>,<span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p><img src="http://cdn.voidking.com//imgs/crawler-baidu-baike/result1.jpg"><br><img src="http://cdn.voidking.com//imgs/crawler-baidu-baike/result2.jpg"></p><h1 id="源码分享"><a href="#源码分享" class="headerlink" title="源码分享"></a>源码分享</h1><p><a target="_blank" rel="noopener" href="https://github.com/voidking/baike-spider">https://github.com/voidking/baike-spider</a></p><h1 id="书签"><a href="#书签" class="headerlink" title="书签"></a>书签</h1><p>Python开发简单爬虫<br><a target="_blank" rel="noopener" href="http://www.imooc.com/learn/563">http://www.imooc.com/learn/563</a></p><p>The Python Standard Library<br><a target="_blank" rel="noopener" href="https://docs.python.org/3/library/index.html">https://docs.python.org/3/library/index.html</a></p><p>Beautiful Soup 4.2.0 文档<br><a target="_blank" rel="noopener" href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/index.zh.html">https://www.crummy.com/software/BeautifulSoup/bs4/doc/index.zh.html</a></p><p>Python词条<br><a target="_blank" rel="noopener" href="http://baike.baidu.com/view/21087.htm">http://baike.baidu.com/view/21087.htm</a><br><a target="_blank" rel="noopener" href="http://baike.baidu.com/item/Python">http://baike.baidu.com/item/Python</a></p><p>Python3.x爬虫教程：爬网页、爬图片、自动登录<br><a target="_blank" rel="noopener" href="http://www.2cto.com/kf/201507/417660.html">http://www.2cto.com/kf/201507/417660.html</a></p><p>使用python3进行优雅的爬虫（一）爬取图片<br><a target="_blank" rel="noopener" href="http://www.jianshu.com/p/696922f268df">http://www.jianshu.com/p/696922f268df</a></p><p>Python UnicodeEncodeError: ‘gbk’ codec can’t encode character 解决方法<br><a target="_blank" rel="noopener" href="http://www.jb51.net/article/64816.htm">http://www.jb51.net/article/64816.htm</a></p><p>Scrapy documentation<br><a target="_blank" rel="noopener" href="https://doc.scrapy.org/en/latest/">https://doc.scrapy.org/en/latest/</a></p></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 好好学习的郝</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://www.voidking.com/dev-python-crawler-baidu-baike/" title="Python抓取百度百科数据">https://www.voidking.com/dev-python-crawler-baidu-baike/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！源站会及时更新知识点及修正错误，阅读体验也更好。欢迎分享，欢迎收藏~</li></ul></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/python/" rel="tag"># python</a> <a href="/tags/%E7%88%AC%E8%99%AB/" rel="tag"># 爬虫</a></div><div class="post-nav"><div class="post-nav-item"><a href="/dev-python-crawler-base/" rel="prev" title="Python爬虫基础"><i class="fa fa-chevron-left"></i> Python爬虫基础</a></div><div class="post-nav-item"> <a href="/dev-matlab-start/" rel="next" title="matlab入门">matlab入门<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><div class="footer-ads" style="margin-top:10px"><ins class="adsbygoogle" style="display:block" data-ad-format="autorelaxed" data-ad-client="ca-pub-3284447971731414" data-ad-slot="9697986181"></ins><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3284447971731414" crossorigin="anonymous"></script><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div class="comments" id="gitalk-container"></div><script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%8A%93%E5%8F%96%E7%AD%96%E7%95%A5"><span class="nav-number">2.</span> <span class="nav-text">抓取策略</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%86%E6%9E%90%E7%9B%AE%E6%A0%87"><span class="nav-number">3.</span> <span class="nav-text">分析目标</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99"><span class="nav-number">4.</span> <span class="nav-text">代码编写</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84"><span class="nav-number">4.1.</span> <span class="nav-text">项目结构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#spider-main-py"><span class="nav-number">4.2.</span> <span class="nav-text">spider_main.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#url-manger-py"><span class="nav-number">4.3.</span> <span class="nav-text">url_manger.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#html-downloader-py"><span class="nav-number">4.4.</span> <span class="nav-text">html_downloader.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#html-parser-py"><span class="nav-number">4.5.</span> <span class="nav-text">html_parser.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#html-outputer-py"><span class="nav-number">4.6.</span> <span class="nav-text">html_outputer.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%90%E8%A1%8C"><span class="nav-number">4.7.</span> <span class="nav-text">运行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BC%96%E7%A0%81%E9%97%AE%E9%A2%98"><span class="nav-number">4.8.</span> <span class="nav-text">编码问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C"><span class="nav-number">4.9.</span> <span class="nav-text">运行结果</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E4%BA%AB"><span class="nav-number">5.</span> <span class="nav-text">源码分享</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B9%A6%E7%AD%BE"><span class="nav-number">6.</span> <span class="nav-text">书签</span></a></li></ol></div></div><div class="sidecar-ads" style="margin-top:10px"><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="好好学习的郝" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">好好学习的郝</p><div class="site-description" itemprop="description">学而不思则罔，思而不学则殆！</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">646</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">30</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">242</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:voidking@qq.com" title="E-Mail → mailto:voidking@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://github.com/voidking" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="http://weibo.com/voidking" title="Weibo → http:&#x2F;&#x2F;weibo.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i> Weibo</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/voidking" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-quora"></i> Zhihu</a></span></div></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2014 – <span itemprop="copyrightYear">2023</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">好好学习的郝</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="footer-beian"> <a href="http://beian.miit.gov.cn/" target="_blank">苏ICP备14021030号</a>&nbsp;|&nbsp; <img src="/images/beian.png" alt=""> <a target="_blank" href="http://www.beian.gov.cn/">苏公网安备 32032202000223号</a></div></div></footer></div><script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css"><script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: '5a238b8c32b1e4dd2156',
      clientSecret: 'bfb5d518626f6fdc7da0351d1e0cd37ab75c6361',
      repo: 'gitalk-comments',
      owner: 'voidking',
      admin: ['voidking'],
      id: '6e88a8e8a176738dfd7e143e8a02b952',
      title: 'Python抓取百度百科数据',
      body: '欢迎留言，互相交流学习~',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script></body></html>