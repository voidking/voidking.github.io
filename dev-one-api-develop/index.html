<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:new URL("https://www.voidking.com").hostname,root:"/",scheme:"Gemini",version:"7.7.1",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1,cdn:{enable:!0,url:"//qiniu-cdn.voidking.com/doc/search.xml"}},path:"search.xml",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="前言有些情况下，我们需要基于 One API 进行二次开发，以满足特定的需求。 本文中，我们会学习 One API 的开发环境配置。 相关文档：  github - one-api 《LLM 接口管理和分发系统 One API》 《好好学Golang：Gin框架入门篇》"><meta property="og:type" content="article"><meta property="og:title" content="One API 开发环境配置"><meta property="og:url" content="https://www.voidking.com/dev-one-api-develop/index.html"><meta property="og:site_name" content="好好学习的郝"><meta property="og:description" content="前言有些情况下，我们需要基于 One API 进行二次开发，以满足特定的需求。 本文中，我们会学习 One API 的开发环境配置。 相关文档：  github - one-api 《LLM 接口管理和分发系统 One API》 《好好学Golang：Gin框架入门篇》"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2024-10-26T08:00:00.000Z"><meta property="article:modified_time" content="2025-04-04T08:00:00.000Z"><meta property="article:author" content="好好学习的郝"><meta property="article:tag" content="docker"><meta property="article:tag" content="chatgpt"><meta property="article:tag" content="aigc"><meta property="article:tag" content="llm"><meta property="article:tag" content="one-api"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://www.voidking.com/dev-one-api-develop/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0}</script><title>One API 开发环境配置 | 好好学习的郝</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?b759ac2a7fa45129e3ef060bf68259f0";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="好好学习的郝" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">好好学习的郝</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">一个计算机技术爱好者与学习者</h1></div><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/voidking" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.voidking.com/dev-one-api-develop/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="好好学习的郝"><meta itemprop="description" content="一个计算机技术爱好者与学习者"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="好好学习的郝"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> One API 开发环境配置</h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2024-10-26 08:00:00" itemprop="dateCreated datePublished" datetime="2024-10-26T08:00:00+00:00">2024-10-26</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2025-04-04 08:00:00" itemprop="dateModified" datetime="2025-04-04T08:00:00+00:00">2025-04-04</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/" itemprop="url" rel="index"><span itemprop="name">engineering</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/docker/" itemprop="url" rel="index"><span itemprop="name">docker</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/golang/" itemprop="url" rel="index"><span itemprop="name">golang</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="前言"><span class="post-title-index">1.</span><a href="#前言" class="headerlink" title="前言"></a> 前言</h2><p>有些情况下，我们需要基于 One API 进行二次开发，以满足特定的需求。</p><p>本文中，我们会学习 One API 的开发环境配置。</p><p>相关文档：</p><ul><li><a target="_blank" rel="noopener" href="https://github.com/songquanpeng/one-api/">github - one-api</a></li><li><a href="https://www.voidking.com/dev-one-api-start/">《LLM 接口管理和分发系统 One API》</a></li><li><a href="https://www.voidking.com/dev-gin-start/">《好好学Golang：Gin框架入门篇》</a></li></ul><span id="more"></span><h2 id="获取-One-API-代码"><span class="post-title-index">2.</span><a href="#获取-One-API-代码" class="headerlink" title="获取 One API 代码"></a> 获取 One API 代码</h2><h3 id="方法一：直接从源仓库获取代码"><span class="post-title-index">2.1.</span><a href="#方法一：直接从源仓库获取代码" class="headerlink" title="方法一：直接从源仓库获取代码"></a> 方法一：直接从源仓库获取代码</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/songquanpeng/one-api.git</span><br></pre></td></tr></table></figure><h3 id="方法二：fork后再获取代码（推荐）"><span class="post-title-index">2.2.</span><a href="#方法二：fork后再获取代码（推荐）" class="headerlink" title="方法二：fork后再获取代码（推荐）"></a> 方法二：fork后再获取代码（推荐）</h3><p>fork后再获取代码的优点，是更加容易维护。每次修改后提交到自己的仓库进行存档，还可以往源仓库中提交PR。</p><ol><li><p>fork oneapi 代码<br>浏览器访问 <a target="_blank" rel="noopener" href="https://github.com/songquanpeng/one-api/">github - one-api</a> ，fork oneapi 到自己的 github 仓库。</p></li><li><p>克隆 oneapi 代码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/voidking/one-api.git</span><br></pre></td></tr></table></figure></li><li><p>配置多个远程仓库（可选）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> one-api</span><br><span class="line">git remote add upstream https://github.com/songquanpeng/one-api.git</span><br></pre></td></tr></table></figure></li></ol><h2 id="本地运行-One-API"><span class="post-title-index">3.</span><a href="#本地运行-One-API" class="headerlink" title="本地运行 One API"></a> 本地运行 One API</h2><h3 id="安装依赖"><span class="post-title-index">3.1.</span><a href="#安装依赖" class="headerlink" title="安装依赖"></a> 安装依赖</h3><ol><li><p>安装前端依赖（node版本 v20.10.0）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> one-api/web/default</span><br><span class="line">npm install</span><br><span class="line">npm run build</span><br></pre></td></tr></table></figure></li><li><p>安装后端依赖</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> one-api</span><br><span class="line"><span class="comment"># export https_proxy=http://127.0.0.1:7890 http_proxy=http://127.0.0.1:7890 all_proxy=socks5://127.0.0.1:7890</span></span><br><span class="line">go mod tidy</span><br></pre></td></tr></table></figure></li></ol><h3 id="运行代码"><span class="post-title-index">3.2.</span><a href="#运行代码" class="headerlink" title="运行代码"></a> 运行代码</h3><ol><li><p>运行代码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go run main.go</span><br></pre></td></tr></table></figure><p>运行成功的话，控制台会输出：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[INFO] 2025/04/08 - 17:36:38 | main.go:32 [main] One API v0.0.0 started</span><br><span class="line">[INFO] 2025/04/08 - 17:36:38 | model/main.go:103 [openSQLite] SQL_DSN not set, using SQLite as database</span><br><span class="line">[INFO] 2025/04/08 - 17:36:38 | model/main.go:129 [InitDB] database migration started</span><br><span class="line">[INFO] 2025/04/08 - 17:36:38 | model/main.go:134 [InitDB] database migrated</span><br><span class="line"></span><br><span class="line">2025/04/08 17:36:38 /path/to/one-api/model/main.go:27 record not found</span><br><span class="line">[0.437ms] [rows:0] SELECT * FROM `users` ORDER BY `users`.`id` LIMIT 1</span><br><span class="line">[INFO] 2025/04/08 - 17:36:38 | model/main.go:28 [CreateRootAccountIfNeed] no user exists, creating a root user for you: username is root, password is 123456</span><br><span class="line">[INFO] 2025/04/08 - 17:36:39 | common/redis.go:20 [InitRedisClient] REDIS_CONN_STRING not set, Redis is not enabled</span><br><span class="line">[INFO] 2025/04/08 - 17:36:39 | main.go:65 [main] using theme default</span><br><span class="line">[INFO] 2025/04/08 - 17:36:39 | relay/adaptor/openai/token.go:23 [InitTokenEncoders] initializing token encoders</span><br><span class="line">[INFO] 2025/04/08 - 17:36:40 | relay/adaptor/openai/token.go:49 [InitTokenEncoders] token encoders initialized</span><br><span class="line">[INFO] 2025/04/08 - 17:36:40 | main.go:119 [main] server started on http://localhost:3000</span><br></pre></td></tr></table></figure></li><li><p>测试访问<br>浏览器访问 <a target="_blank" rel="noopener" href="http://localhost:3000/">http://localhost:3000</a><br>测试登录，默认用户名为<code>root</code>，密码为 <code>123456</code>。</p></li></ol><p>若登录成功，则证明One API本地运行环境配置完成了。</p><h2 id="VSCode中配置调试环境"><span class="post-title-index">4.</span><a href="#VSCode中配置调试环境" class="headerlink" title="VSCode中配置调试环境"></a> VSCode中配置调试环境</h2><p>参考文档：<a href="https://www.voidking.com/dev-vscode-golang-debug/">《好好学Golang：VSCode配置Golang Debug》</a></p><h2 id="One-API核心逻辑"><span class="post-title-index">5.</span><a href="#One-API核心逻辑" class="headerlink" title="One API核心逻辑"></a> One API核心逻辑</h2><p>One-API 的核心功能是将客户端的 OpenAI 格式请求转发到不同的大模型服务商，其处理流程如下：</p><ol><li><p>客户端请求：客户端发送符合 OpenAI API 格式的请求到 One-API 端点</p></li><li><p>认证与鉴权：通过中间件验证 API Key 的有效性和权限</p></li><li><p>模型映射：根据请求中的模型名称确定要使用的渠道</p></li><li><p>请求转换：将 OpenAI 格式的请求转换为目标服务商的API格式</p></li><li><p>转发请求：将转换后的请求发送到目标服务商</p></li><li><p>响应转换：将服务商的响应转换回 OpenAI 格式</p></li><li><p>返回客户端：将标准化响应返回给客户端</p></li></ol><h2 id="支持新的大模型"><span class="post-title-index">6.</span><a href="#支持新的大模型" class="headerlink" title="支持新的大模型"></a> 支持新的大模型</h2><h3 id="实现思路"><span class="post-title-index">6.1.</span><a href="#实现思路" class="headerlink" title="实现思路"></a> 实现思路</h3><p>新出现的大模型，One API并不能保证可以在第一时间支持。如果比较着急使用，那么我们可以自己进行二次开发。</p><p>实现思路如下：</p><ol><li><p>获取模型的API Key，并且通过curl验证可以正常访问该模型的API</p></li><li><p>One API 新增渠道，配置该模型的API和Key</p></li><li><p>测试新增的渠道，根据报错搜索代码，定位到报错的位置</p></li><li><p>报错的代码，打断点；请求和响应的代码，打断点；可疑的代码，打断点</p></li><li><p>测试新增的渠道，触发调试模式，跳转到断点，单步调试</p></li><li><p>修改代码以支持新的大模型，同时输出更多日志</p></li><li><p>重复4-6，直到调通整个流程</p></li></ol><h3 id="支持新的Gemini模型"><span class="post-title-index">6.2.</span><a href="#支持新的Gemini模型" class="headerlink" title="支持新的Gemini模型"></a> 支持新的Gemini模型</h3><p>以支持新的 <code>gemini-2.5-pro-exp-03-25</code> 模型为例，整个实现过程遵循实现思路，需要特别说明的是curl验证方法和获取关键信息的方法。</p><h4 id="curl验证"><span class="post-title-index">6.2.1.</span><a href="#curl验证" class="headerlink" title="curl验证"></a> curl验证</h4><p>One API 渠道可用，最基础的前提是模型的API可用，<code>gemini-2.5-pro-exp-03-25</code> 模型的API验证方法如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">curl <span class="string">&quot;https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro-exp-03-25:generateContent?key=xxx&quot;</span> \</span><br><span class="line">-H <span class="string">&#x27;Content-Type: application/json&#x27;</span> \</span><br><span class="line">-X POST \</span><br><span class="line">-d <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">  &quot;contents&quot;: [&#123;</span></span><br><span class="line"><span class="string">    &quot;parts&quot;:[&#123;&quot;text&quot;: &quot;hello&quot;&#125;]</span></span><br><span class="line"><span class="string">    &#125;]</span></span><br><span class="line"><span class="string">   &#125;&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="获取关键信息"><span class="post-title-index">6.2.2.</span><a href="#获取关键信息" class="headerlink" title="获取关键信息"></a> 获取关键信息</h4><p>以发送请求并获得响应为分界点，整个系统可以分为三个部分：请求头和请求体处理，发送请求并获得响应，响应内容处理。</p><p>如果有了请求相关的关键信息，那么就可以定位解决很多问题了。举个例子，假设获取到的响应不符合预期，那么我们可以直接定位到请求头和请求体处理部分有问题。<br>因此，在开发调试过程中，必须要获取到四个请求相关的关键信息：请求的URL、请求头、请求体、响应的内容。</p><p>经过单步调试，我们会发现，在 <code>relay/adaptor/common.go</code> 中的<code>DoRequestHelper</code> 和 <code>DoRequest</code> 函数中，我们可以获取到请求相关的关键信息。</p><p>打印请求体的方法：</p><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// req 类型为 http.Request</span></span><br><span class="line">requestBody, err := io.ReadAll(req.Body)</span><br><span class="line">fmt.Println(<span class="string">&quot;Request Body:&quot;</span>, <span class="type">string</span>(requestBody))</span><br><span class="line"><span class="comment">// 读取Body会消耗掉Body，如果需要后续使用，需要重新赋值</span></span><br><span class="line">req.Body = io.NopCloser(bytes.NewBuffer(body))</span><br></pre></td></tr></table></figure><p>打印响应内容的方法：</p><figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// resp 类型为 http.Response </span></span><br><span class="line">responseBody, err := io.ReadAll(resp.Body)</span><br><span class="line">fmt.Println(<span class="string">&quot;Response Body:&quot;</span>, <span class="type">string</span>(responseBody))</span><br></pre></td></tr></table></figure><p>获取到请求的URL、请求头、请求体后，就可以通过curl直接发送请求了。<br>正确的curl与不正确的curl进行对比，就可以定位到问题出现在系统的哪一部分。</p><p>同样的道理，One API系统的三个部分还可以根据其他关键信息进一步细分，这样就可以达到类似于二分法定位问题的效果。</p></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 好好学习的郝</li><li class="post-copyright-link"> <strong>原文链接：</strong> <a href="https://www.voidking.com/dev-one-api-develop/" title="One API 开发环境配置">https://www.voidking.com/dev-one-api-develop/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本文采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议，转载请注明出处！源站会即时更新知识点并修正错误，欢迎访问~</li></ul></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/docker/" rel="tag"># docker</a> <a href="/tags/chatgpt/" rel="tag"># chatgpt</a> <a href="/tags/aigc/" rel="tag"># aigc</a> <a href="/tags/llm/" rel="tag"># llm</a> <a href="/tags/one-api/" rel="tag"># one-api</a></div><div class="post-nav"><div class="post-nav-item"><a href="/dev-one-api-start/" rel="prev" title="LLM 接口管理和分发系统 One API"><i class="fa fa-chevron-left"></i> LLM 接口管理和分发系统 One API</a></div><div class="post-nav-item"> <a href="/dev-mail-spf-dkim-dmarc/" rel="next" title="邮箱配置中的SPF、DKIM、DMARC记录">邮箱配置中的SPF、DKIM、DMARC记录<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><div class="footer-ads" style="margin-top:10px"></div><div class="comments" id="gitalk-container"></div><script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-text">1. 前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96-One-API-%E4%BB%A3%E7%A0%81"><span class="nav-text">2. 获取 One API 代码</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%9A%E7%9B%B4%E6%8E%A5%E4%BB%8E%E6%BA%90%E4%BB%93%E5%BA%93%E8%8E%B7%E5%8F%96%E4%BB%A3%E7%A0%81"><span class="nav-text">2.1. 方法一：直接从源仓库获取代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%9Afork%E5%90%8E%E5%86%8D%E8%8E%B7%E5%8F%96%E4%BB%A3%E7%A0%81%EF%BC%88%E6%8E%A8%E8%8D%90%EF%BC%89"><span class="nav-text">2.2. 方法二：fork后再获取代码（推荐）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%AC%E5%9C%B0%E8%BF%90%E8%A1%8C-One-API"><span class="nav-text">3. 本地运行 One API</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96"><span class="nav-text">3.1. 安装依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%90%E8%A1%8C%E4%BB%A3%E7%A0%81"><span class="nav-text">3.2. 运行代码</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#VSCode%E4%B8%AD%E9%85%8D%E7%BD%AE%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83"><span class="nav-text">4. VSCode中配置调试环境</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#One-API%E6%A0%B8%E5%BF%83%E9%80%BB%E8%BE%91"><span class="nav-text">5. One API核心逻辑</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%94%AF%E6%8C%81%E6%96%B0%E7%9A%84%E5%A4%A7%E6%A8%A1%E5%9E%8B"><span class="nav-text">6. 支持新的大模型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E6%80%9D%E8%B7%AF"><span class="nav-text">6.1. 实现思路</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%AF%E6%8C%81%E6%96%B0%E7%9A%84Gemini%E6%A8%A1%E5%9E%8B"><span class="nav-text">6.2. 支持新的Gemini模型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#curl%E9%AA%8C%E8%AF%81"><span class="nav-text">6.2.1. curl验证</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%85%B3%E9%94%AE%E4%BF%A1%E6%81%AF"><span class="nav-text">6.2.2. 获取关键信息</span></a></li></ol></li></ol></li></ol></div></div><div class="sidecar-ads" style="margin-top:10px"><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="好好学习的郝" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">好好学习的郝</p><div class="site-description" itemprop="description">一个计算机技术爱好者与学习者</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">776</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">33</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">269</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:voidking@qq.com" title="E-Mail → mailto:voidking@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://github.com/voidking" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="http://weibo.com/voidking" title="Weibo → http:&#x2F;&#x2F;weibo.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i> Weibo</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/voidking" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-quora"></i> Zhihu</a></span></div></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2014 – <span itemprop="copyrightYear">2026</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">好好学习的郝</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="footer-beian"> <a href="http://beian.miit.gov.cn/" target="_blank">苏ICP备14021030号</a>&nbsp;|&nbsp; <img src="/images/beian.png" alt=""> <a target="_blank" href="http://www.beian.gov.cn/">苏公网安备 32032202000223号</a></div></div></footer></div><script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><link rel="stylesheet" href="https://cdn.staticfile.net/gitalk/1.7.2/gitalk.min.css"><script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('https://cdn.staticfile.net/gitalk/1.7.2/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: '5a238b8c32b1e4dd2156',
      clientSecret: 'bfb5d518626f6fdc7da0351d1e0cd37ab75c6361',
      repo: 'gitalk-comments',
      owner: 'voidking',
      admin: ['voidking'],
      id: 'b5c6bc4ee376da6cac9ebb8ac38991e4',
      title: 'One API 开发环境配置',
      body: '欢迎留言，互相交流学习~',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script></body></html>