<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:new URL("https://www.voidking.com").hostname,root:"/",scheme:"Gemini",version:"7.7.1",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1,cdn:{enable:!0,url:"//qiniu-cdn.voidking.com/doc/search.xml"}},path:"search.xml",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="前言本文记录使用Grafana和Prometheus时遇到的一些问题，备忘。"><meta property="og:type" content="article"><meta property="og:title" content="Grafana和Prometheus问题记录"><meta property="og:url" content="https://www.voidking.com/dev-grafana-prometheus-problem/index.html"><meta property="og:site_name" content="好好学习的郝"><meta property="og:description" content="前言本文记录使用Grafana和Prometheus时遇到的一些问题，备忘。"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2020-01-13T20:00:00.000Z"><meta property="article:modified_time" content="2024-09-15T08:00:00.000Z"><meta property="article:author" content="好好学习的郝"><meta property="article:tag" content="prometheus"><meta property="article:tag" content="监控"><meta property="article:tag" content="问题排查"><meta property="article:tag" content="grafana"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://www.voidking.com/dev-grafana-prometheus-problem/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0}</script><title>Grafana和Prometheus问题记录 | 好好学习的郝</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?b759ac2a7fa45129e3ef060bf68259f0";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="好好学习的郝" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">好好学习的郝</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">一个计算机技术爱好者与学习者</h1></div><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/voidking" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.voidking.com/dev-grafana-prometheus-problem/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="好好学习的郝"><meta itemprop="description" content="一个计算机技术爱好者与学习者"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="好好学习的郝"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> Grafana和Prometheus问题记录</h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2020-01-13 20:00:00" itemprop="dateCreated datePublished" datetime="2020-01-13T20:00:00+00:00">2020-01-13</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2024-09-15 08:00:00" itemprop="dateModified" datetime="2024-09-15T08:00:00+00:00">2024-09-15</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/" itemprop="url" rel="index"><span itemprop="name">engineering</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/monitoring/" itemprop="url" rel="index"><span itemprop="name">monitoring</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/troubleshooting/" itemprop="url" rel="index"><span itemprop="name">troubleshooting</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="前言"><span class="post-title-index">1.</span><a href="#前言" class="headerlink" title="前言"></a> 前言</h1><p>本文记录使用Grafana和Prometheus时遇到的一些问题，备忘。</p><span id="more"></span><h1 id="Grafana-Dashboard相关问题"><span class="post-title-index">2.</span><a href="#Grafana-Dashboard相关问题" class="headerlink" title="Grafana Dashboard相关问题"></a> Grafana Dashboard相关问题</h1><h2 id="常用的Dashboard"><span class="post-title-index">2.1.</span><a href="#常用的Dashboard" class="headerlink" title="常用的Dashboard"></a> 常用的Dashboard</h2><p>问：Grafana常用的Dashboard有哪些？</p><p>答：</p><ul><li>node exporter：1860</li><li>cAdvisor：3125</li><li>dcgm exporter：12239</li></ul><p>更多的Dashboard，可以到网站<a target="_blank" rel="noopener" href="https://grafana.com/dashboards">Grafana Dashboards</a>上查找。</p><h2 id="数据源和Dashboard"><span class="post-title-index">2.2.</span><a href="#数据源和Dashboard" class="headerlink" title="数据源和Dashboard"></a> 数据源和Dashboard</h2><p>问：一个prometheus数据源中，会包含不同类型exporter采集的metrics数据，grafana中的一个dashboard怎样知道哪些数据是自己应该展示的？</p><p>答：和exporter无关，grafana只关心metrics，grafana根据指标名称和标签过滤自己需要的数据。</p><h2 id="复制Dashboard后，怎样更换数据源？"><span class="post-title-index">2.3.</span><a href="#复制Dashboard后，怎样更换数据源？" class="headerlink" title="复制Dashboard后，怎样更换数据源？"></a> 复制Dashboard后，怎样更换数据源？</h2><p>问：Dashboard的设置中，选择Save As保存到另外一个文件夹，但是数据源并不会发生变化。如果想要替换数据源，应该怎样配置？</p><p>答：编辑JSON Model，查找<code>uid</code>对应的value，全部替换成新的数据源uid。</p><p>数据源uid获取方法：打开配置，数据源配置，点击数据源进入编辑页面，此时浏览器地址栏 <code>/edit/</code> 后面的就是数据源的uid。</p><h2 id="怎样拷贝Dashboard配置？"><span class="post-title-index">2.4.</span><a href="#怎样拷贝Dashboard配置？" class="headerlink" title="怎样拷贝Dashboard配置？"></a> 怎样拷贝Dashboard配置？</h2><p>问：如果已经有了一个Dashboard B，想要拷贝另一个Dashboard A的配置，该怎样操作？</p><p>答：拷贝Dashboard A 的 JSON Model 中的 <code>panels</code> 和 <code>templating</code> 部分，粘贴到Dashboard B的JSON Model，保存即可。</p><h2 id="Node-Exporter-Full-显示问题"><span class="post-title-index">2.5.</span><a href="#Node-Exporter-Full-显示问题" class="headerlink" title="Node Exporter Full 显示问题"></a> Node Exporter Full 显示问题</h2><p>问：<a target="_blank" rel="noopener" href="https://grafana.com/grafana/dashboards/1860-node-exporter-full/">Node Exporter Full</a> 中，当选择的时间范围小于24小时的时候，CPU Basic和Network Traffic Basic的内容为空，该怎么解决？</p><p>答：修改Grafana数据源抓取时间间隔为30s或者1m。</p><p>Grafana中默认的数据源抓取数据时间间隔是15s，而Prometheus中抓取数据时间间隔可能是1m，这时就会出现问题。</p><p>参考文档：<a target="_blank" rel="noopener" href="https://github.com/rfmoz/grafana-dashboards/issues/140#issuecomment-1647804976">No data available when interval is less than 24 hours</a></p><h2 id="Docker-monitoring-显示问题"><span class="post-title-index">2.6.</span><a href="#Docker-monitoring-显示问题" class="headerlink" title="Docker monitoring 显示问题"></a> Docker monitoring 显示问题</h2><p>问：<a target="_blank" rel="noopener" href="https://grafana.com/grafana/dashboards/3125-docker-monitoring-alicek106-revision/">Docker monitoring - alicek106 revision</a>中，一个容器的 Network Rx 和 Network Tx 对应两条线，是怎么回事？</p><p>答：正常现象，说明该容器存在多个网卡。</p><p>查看query语句</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">irate(container_network_receive_bytes_total&#123;image!=&quot;&quot;, instance=~&quot;$server&quot;, name=~&quot;$container&quot;&#125;[5m])</span><br><span class="line">irate(container_network_transmit_bytes_total&#123;image!=&quot;&quot;, instance=~&quot;$server&quot;, name=~&quot;$container&quot;&#125;[5m])</span><br></pre></td></tr></table></figure><p>在explore页面使用PromQL查询，可以发现指定容器查询可以查询出两个结果，分别有 eth0 和 tunl0 两张卡。</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">container_network_receive_bytes_total&#123;id=&quot;/system.slice/docker-cff8168986d12d8399fde55d3e65a056af56bcf6e67187d926a9d974b4a2c1c2.scope&quot;, image=&quot;gcr.dockerproxy.com/cadvisor/cadvisor:v0.47.1&quot;, instance=&quot;192.168.56.101:9101&quot;, interface=&quot;eth0&quot;, job=&quot;cadvisor&quot;, name=&quot;cadvisor&quot;&#125;</span><br><span class="line">container_network_receive_bytes_total&#123;id=&quot;/system.slice/docker-cff8168986d12d8399fde55d3e65a056af56bcf6e67187d926a9d974b4a2c1c2.scope&quot;, image=&quot;gcr.dockerproxy.com/cadvisor/cadvisor:v0.47.1&quot;, instance=&quot;192.168.56.101:9101&quot;, interface=&quot;tunl0&quot;, job=&quot;cadvisor&quot;, name=&quot;cadvisor&quot;&#125;</span><br></pre></td></tr></table></figure><p>比较好的处理方式：修改Options中的Legend，修改为 <code>&#123;&#123;name&#125;&#125;-&#123;&#123;interface&#125;&#125;</code> ，这样图表就清晰了。</p><h1 id="Grafana-Variables相关问题"><span class="post-title-index">3.</span><a href="#Grafana-Variables相关问题" class="headerlink" title="Grafana Variables相关问题"></a> Grafana Variables相关问题</h1><h2 id="label-values函数"><span class="post-title-index">3.1.</span><a href="#label-values函数" class="headerlink" title="label_values函数"></a> label_values函数</h2><p>问：Grafana的Dashboard中，可以创建Variables用来筛选数据，其中Query经常使用 <code>label_values</code> ，这个函数是Grafana自带的，还是PromQL自带的？</p><p>答：Grafana自带的，PromQL中用不了。</p><p><code>label_values(node_uname_info, job)</code>详解：</p><ul><li><code>label_values()</code> 函数用于从指定指标中提取指定标签的唯一值列表。</li><li><code>node_uname_info</code> 是一个指标名称，代表了包含有关节点操作系统和内核的信息的指标。</li><li><code>job</code> 是要提取的标签名称，这里表示作业或服务的标识。</li></ul><p>label_values的一个典型应用：在cAdvisor的<code>3125</code>的dashboard中增加一个根据容器名称的二级筛选。</p><p><code>3125</code>的dashboard，默认有一个变量为server，能够根据主机筛选出主机上的所有容器。但是容器时不方便观察，最好能够根据容器名称再进行一层筛选。</p><p>1、新增一个变量<br>Settings，Variables，New</p><p>2、配置变量</p><ul><li>Name：container</li><li>Type：Query</li><li>Data source：prometheus</li><li>Refresh：On dashboard load</li><li>Query：<code>label_values(container_cpu_usage_seconds_total&#123;instance=&quot;$server&quot;&#125;,name)</code></li></ul><p>3、调整PromQL配置</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rate(container_cpu_user_seconds_total&#123;image!=&quot;&quot;, instance=~&quot;$server&quot;, name=~&quot;$container&quot;&#125;[5m]) * 100</span><br></pre></td></tr></table></figure><h2 id="Regex的作用是什么？"><span class="post-title-index">3.2.</span><a href="#Regex的作用是什么？" class="headerlink" title="Regex的作用是什么？"></a> Regex的作用是什么？</h2><p>问：配置Variables时，Query Options中有一个Regex，它的作用是什么？</p><p>答：使用Query中的表达式筛选出的数据，可能不符合预期，这时可以使用Regex对这些数据进一步过滤。</p><h2 id="怎样允许多选？"><span class="post-title-index">3.3.</span><a href="#怎样允许多选？" class="headerlink" title="怎样允许多选？"></a> 怎样允许多选？</h2><p>问：在dashboard页面，想要选中多个主机，该怎样配置？</p><p>答：修改Variables配置，启用 Selection options 中的 Multi-value</p><h2 id="怎样显示所有选项？"><span class="post-title-index">3.4.</span><a href="#怎样显示所有选项？" class="headerlink" title="怎样显示所有选项？"></a> 怎样显示所有选项？</h2><p>问：在dashboard页面，通过变量筛选一个主机后，想要返回查看全部的主机，但是并没有这个选项，该怎样配置？</p><p>答：修改Variables配置，启用 Selection options 中的 Include All option， Custom all value 设置一个值。<br>Custom all value 一般设置为 <code>blank = auto</code>，能够根据用户的选择动态地显示或隐藏”全部”选项。<br>Custom all value 也会经常设置 <code>.+</code> ，以便dashboard中的PromQL能否匹配到所有的主机。</p><h2 id="怎样创建文本Panel？"><span class="post-title-index">3.5.</span><a href="#怎样创建文本Panel？" class="headerlink" title="怎样创建文本Panel？"></a> 怎样创建文本Panel？</h2><p>问：怎样创建文本Panel，以便给Dashboard添加一些说明？</p><p>答：创建Panel，然后点击右上角，选择Visualizations类型为<code>Text</code>（默认为<code>Time series</code>）。</p><h2 id="Docker-monitoring-显示问题-1"><span class="post-title-index">3.6.</span><a href="#Docker-monitoring-显示问题-1" class="headerlink" title="Docker monitoring 显示问题"></a> Docker monitoring 显示问题</h2><p>问：<a target="_blank" rel="noopener" href="https://grafana.com/grafana/dashboards/3125-docker-monitoring-alicek106-revision/">Docker monitoring - alicek106 revision</a>中，看不到数据，但是通过PromQL是可以查询到 <code>container</code> 开头的指标的。</p><p>答：这是因为Dashboard中配置的Variables Query和真实指标不匹配，没有获取到instance。<br>解决办法：Query替换为 <code>label_values(container_cpu_usage_seconds_total&#123;instance=&quot;$server&quot;&#125;,name)</code></p><h1 id="Prometheus相关问题"><span class="post-title-index">4.</span><a href="#Prometheus相关问题" class="headerlink" title="Prometheus相关问题"></a> Prometheus相关问题</h1><h2 id="Dashboard变量和Panel缺失数据问题"><span class="post-title-index">4.1.</span><a href="#Dashboard变量和Panel缺失数据问题" class="headerlink" title="Dashboard变量和Panel缺失数据问题"></a> Dashboard变量和Panel缺失数据问题</h2><p>问：<a target="_blank" rel="noopener" href="https://grafana.com/grafana/dashboards/3125-docker-monitoring-alicek106-revision/">Docker monitoring - alicek106 revision</a>中，变量和Panel都缺失数据，该怎么解决？</p><p>答：通过kubernetes-cadvisor获取到的指标，是经过过滤的，可能导致数据缺失。<br>确认方法：访问Prometheus Web，查询变量和Panel中用到的指标。</p><p>如果确认是指标缺失，那么就需要修改ServiceMonitor的定义，开放获取更多指标。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl edit servicemonitor prometheus-kube-prometheus-kubelet -n prometheus</span><br></pre></td></tr></table></figure><p>参考无法显示数据的Panel的表达式，修改 metricRelabelings.regex 部分，例如针对3125 Dashboard，需要如下修改：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">endpoints:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">bearerTokenFile:</span> <span class="string">/var/run/secrets/kubernetes.io/serviceaccount/token</span></span><br><span class="line">    <span class="attr">metricRelabelings:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">action:</span> <span class="string">keep</span></span><br><span class="line">      <span class="attr">regex:</span> <span class="string">container_last_seen|machine_memory_bytes|container_cpu_user_seconds_total|container_cpu_usage_seconds_total|container_memory_usage_bytes|container_memory_cache|container_network_.+_bytes_total|container_memory_working_set_bytes|container_cpu_cfs_.*periods_total|container_processes.*|container_threads.*</span></span><br><span class="line">      <span class="attr">sourceLabels:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">__name__</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">/metrics/cadvisor</span></span><br><span class="line">    <span class="attr">port:</span> <span class="string">https-metrics</span></span><br><span class="line">    <span class="string">...</span></span><br></pre></td></tr></table></figure><p>和默认配置相比，regex中添加了 <code>container_last_seen|machine_memory_bytes|container_cpu_user_seconds_total|</code></p><h2 id="缺失文件句柄指标问题"><span class="post-title-index">4.2.</span><a href="#缺失文件句柄指标问题" class="headerlink" title="缺失文件句柄指标问题"></a> 缺失文件句柄指标问题</h2><p>prometheus套装中的node-exporter，默认情况下是缺少文件句柄指标的，需要自行开启，开启方法同【Dashboard变量和Panel缺失数据问题】。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl edit servicemonitor node-exporter -n -n prometheus</span><br></pre></td></tr></table></figure><p>在regex中新增 <code>node_filefd_(maximum|allocated)</code> ，过几分钟，在prometheus web页面就可以查询到文件句柄指标了。</p><p>grafana dashboard中，新增panel，表达式为：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node_filefd_allocated&#123;instance=&quot;$node&quot;&#125;</span><br></pre></td></tr></table></figure><h2 id="部分cAdvisor-Endpoind-DOWN问题"><span class="post-title-index">4.3.</span><a href="#部分cAdvisor-Endpoind-DOWN问题" class="headerlink" title="部分cAdvisor Endpoind DOWN问题"></a> 部分cAdvisor Endpoind DOWN问题</h2><p>问：<a target="_blank" rel="noopener" href="https://grafana.com/grafana/dashboards/3125-docker-monitoring-alicek106-revision/">Docker monitoring - alicek106 revision</a>中，缺少了一些Endpiont，通过Prometheus Targets页面查看，发现缺失的Endpoint处于 DOWN 状态，该怎样解决？</p><p>答：同样的配置，部分正常，部分DOWN，大概率是超时问题。建议<code>interval</code>改成30s，<code>timeout</code>或<code>scrapeTimeout</code>改成5s。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl edit servicemonitor prometheus-kube-prometheus-kubelet -n prometheus</span><br></pre></td></tr></table></figure><h2 id="部分cAdvisor-Endpoint缺label问题"><span class="post-title-index">4.4.</span><a href="#部分cAdvisor-Endpoint缺label问题" class="headerlink" title="部分cAdvisor Endpoint缺label问题"></a> 部分cAdvisor Endpoint缺label问题</h2><p>问：K8S集群中，使用Prometheus套装获取Kubelet cAdvisor指标。部分节点可以正常获取到指标和label，但是另外一部分节点获取指标正常，缺少label。例如指标 <code>container_cpu_user_seconds_total</code> 中没有label <code>name</code> ，该怎样解决？</p><p>答：重启有问题节点的 kubelet。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart kubelet</span><br></pre></td></tr></table></figure><h2 id="node-exporter主机名和IP问题1"><span class="post-title-index">4.5.</span><a href="#node-exporter主机名和IP问题1" class="headerlink" title="node-exporter主机名和IP问题1"></a> node-exporter主机名和IP问题1</h2><p>问：K8S中的Prometheus，获取集群外部的 node-exporter 指标，instance 的 value 默认配置为 <code>IP:PORT</code>，怎样把 instance 的 value 改成 <code>IP</code>？</p><p>答：通过relabel_configs实现。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;node-exporter&#x27;</span></span><br><span class="line">  <span class="attr">static_configs:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">targets:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="number">192.168</span><span class="number">.56</span><span class="number">.101</span><span class="string">:9100</span></span><br><span class="line">        <span class="bullet">-</span> <span class="number">192.168</span><span class="number">.50</span><span class="number">.102</span><span class="string">:9100</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">job:</span> <span class="string">node-exporter</span></span><br><span class="line">  <span class="attr">relabel_configs:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">action:</span> <span class="string">replace</span></span><br><span class="line">      <span class="attr">regex:</span> <span class="string">(.*):.*</span></span><br><span class="line">      <span class="attr">replacement:</span> <span class="string">$1</span></span><br><span class="line">      <span class="attr">source_labels:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">__address__</span></span><br><span class="line">      <span class="attr">target_label:</span> <span class="string">instance</span></span><br></pre></td></tr></table></figure><p>具体修改方法，参考文档<a href="https://www.voidking.com/dev-host-docker-k8s-monitoring/">《主机、Docker和K8S统一配置监控告警方案》</a>中的【kube-prometheus监控集群外部服务】部分。</p><h2 id="node-exporter主机名和IP问题2"><span class="post-title-index">4.6.</span><a href="#node-exporter主机名和IP问题2" class="headerlink" title="node-exporter主机名和IP问题2"></a> node-exporter主机名和IP问题2</h2><p>问：K8S中的Prometheus， node-exporter servicemonitor 把 instance 的 value 配置为 <code>主机名</code>，怎样把 instance 的 value 改成 <code>IP|主机名</code>？</p><p>答：instance的value，是通过relabelings实现的赋值，需要修改配置。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl edit servicemonitor node-exporter -n prometheus</span><br></pre></td></tr></table></figure><p>原配置为：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">endpoints:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">bearerTokenFile:</span> <span class="string">/var/run/secrets/kubernetes.io/serviceaccount/token</span></span><br><span class="line">    <span class="attr">interval:</span> <span class="string">1m</span></span><br><span class="line">    <span class="attr">metricRelabelings:</span> &#123;&#125;</span><br><span class="line">    <span class="attr">relabelings:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">action:</span> <span class="string">replace</span></span><br><span class="line">      <span class="attr">regex:</span> <span class="string">(.*)</span></span><br><span class="line">      <span class="attr">replacement:</span> <span class="string">$1</span></span><br><span class="line">      <span class="attr">sourceLabels:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">__meta_kubernetes_pod_node_name</span></span><br><span class="line">      <span class="attr">targetLabel:</span> <span class="string">instance</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">action:</span> <span class="string">labeldrop</span></span><br><span class="line">      <span class="attr">regex:</span> <span class="string">(service|endpoint)</span></span><br></pre></td></tr></table></figure><p>修改为：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">endpoints:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">bearerTokenFile:</span> <span class="string">/var/run/secrets/kubernetes.io/serviceaccount/token</span></span><br><span class="line">    <span class="attr">interval:</span> <span class="string">1m</span></span><br><span class="line">    <span class="attr">metricRelabelings:</span> &#123;&#125;</span><br><span class="line">    <span class="attr">relabelings:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">action:</span> <span class="string">replace</span></span><br><span class="line">      <span class="attr">regex:</span> <span class="string">(.*):.*\|(.*)$</span></span><br><span class="line">      <span class="attr">replacement:</span> <span class="string">$1|$2</span></span><br><span class="line">      <span class="attr">separator:</span> <span class="string">&#x27;|&#x27;</span></span><br><span class="line">      <span class="attr">sourceLabels:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">__address__</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">__meta_kubernetes_endpoint_node_name</span></span><br><span class="line">      <span class="comment">#- __meta_kubernetes_pod_node_name</span></span><br><span class="line">      <span class="attr">targetLabel:</span> <span class="string">instance</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">action:</span> <span class="string">labeldrop</span></span><br><span class="line">      <span class="attr">regex:</span> <span class="string">(service|endpoint)</span></span><br></pre></td></tr></table></figure><p>该配置中，首先选择了两个source label（IP和主机名）作为数据来源，然后用<code>|</code>分隔使两个label value的字符串合并成一个字符串，接着使用正则匹配这个字符串，匹配到的<code>$1</code>和<code>$2</code>，拼接为<code>$1|$2</code>作为最终的label value。</p><p>该方法同样适用于cadvisor，<code>__meta_kubernetes_endpoint_node_name</code> 需要对应修改为 <code>__meta_kubernetes_endpoint_address_target_name</code>。</p><p>其他的exporter也是同理修改，主机名对应的指标名称可能不同。</p><p>主机名对应的指标名称，可以通过prometheus targets页面查看before relabeling获取到，也可以通过接口获取到。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl http://prometheus-server:9090/api/v1/targets | jq &gt; targets.json</span><br><span class="line"><span class="built_in">cat</span> targets.json | jq <span class="string">&#x27;.data.activeTargets[]|select(.labels.job==&quot;kubelet&quot;)&#x27;</span></span><br></pre></td></tr></table></figure><p>参考文档：</p><ul><li><a target="_blank" rel="noopener" href="https://prometheus.io/docs/prometheus/latest/querying/api/#targets">Prometheus HTTP API Targets</a></li><li><a href="https://www.voidking.com/dev-jq-command/">《jq命令的安装使用》</a></li></ul><h1 id="serviceMonitor没有生效问题"><span class="post-title-index">5.</span><a href="#serviceMonitor没有生效问题" class="headerlink" title="serviceMonitor没有生效问题"></a> serviceMonitor没有生效问题</h1><p>问：修改serviceMonitor中instance的值之后，发现没有生效，该怎么处理？</p><p>答：大概率是因为配置错误，查看prometheus日志进行修改。如果没有及时修改，还可能导致prometheus无法启动。</p></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 好好学习的郝</li><li class="post-copyright-link"> <strong>原文链接：</strong> <a href="https://www.voidking.com/dev-grafana-prometheus-problem/" title="Grafana和Prometheus问题记录">https://www.voidking.com/dev-grafana-prometheus-problem/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本文采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议，转载请注明出处！源站会即时更新知识点并修正错误，欢迎访问~</li></ul></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/prometheus/" rel="tag"># prometheus</a> <a href="/tags/%E7%9B%91%E6%8E%A7/" rel="tag"># 监控</a> <a href="/tags/%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5/" rel="tag"># 问题排查</a> <a href="/tags/grafana/" rel="tag"># grafana</a></div><div class="post-nav"><div class="post-nav-item"><a href="/dev-prometheus-alerting-rules/" rel="prev" title="Promtheus配置告警规则"><i class="fa fa-chevron-left"></i> Promtheus配置告警规则</a></div><div class="post-nav-item"> <a href="/dev-docker-prometheus/" rel="next" title="好好学Docker：使用Docker安装配置Prometheus">好好学Docker：使用Docker安装配置Prometheus<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><div class="footer-ads" style="margin-top:10px"><ins class="adsbygoogle" style="display:block" data-ad-format="autorelaxed" data-ad-client="ca-pub-3284447971731414" data-ad-slot="9697986181"></ins><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3284447971731414" crossorigin="anonymous"></script><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div class="comments" id="gitalk-container"></div><script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-text">1. 前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Grafana-Dashboard%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98"><span class="nav-text">2. Grafana Dashboard相关问题</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E7%9A%84Dashboard"><span class="nav-text">2.1. 常用的Dashboard</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%BA%90%E5%92%8CDashboard"><span class="nav-text">2.2. 数据源和Dashboard</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%8D%E5%88%B6Dashboard%E5%90%8E%EF%BC%8C%E6%80%8E%E6%A0%B7%E6%9B%B4%E6%8D%A2%E6%95%B0%E6%8D%AE%E6%BA%90%EF%BC%9F"><span class="nav-text">2.3. 复制Dashboard后，怎样更换数据源？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%8E%E6%A0%B7%E6%8B%B7%E8%B4%9DDashboard%E9%85%8D%E7%BD%AE%EF%BC%9F"><span class="nav-text">2.4. 怎样拷贝Dashboard配置？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Node-Exporter-Full-%E6%98%BE%E7%A4%BA%E9%97%AE%E9%A2%98"><span class="nav-text">2.5. Node Exporter Full 显示问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker-monitoring-%E6%98%BE%E7%A4%BA%E9%97%AE%E9%A2%98"><span class="nav-text">2.6. Docker monitoring 显示问题</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Grafana-Variables%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98"><span class="nav-text">3. Grafana Variables相关问题</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#label-values%E5%87%BD%E6%95%B0"><span class="nav-text">3.1. label_values函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Regex%E7%9A%84%E4%BD%9C%E7%94%A8%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="nav-text">3.2. Regex的作用是什么？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%8E%E6%A0%B7%E5%85%81%E8%AE%B8%E5%A4%9A%E9%80%89%EF%BC%9F"><span class="nav-text">3.3. 怎样允许多选？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%8E%E6%A0%B7%E6%98%BE%E7%A4%BA%E6%89%80%E6%9C%89%E9%80%89%E9%A1%B9%EF%BC%9F"><span class="nav-text">3.4. 怎样显示所有选项？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%8E%E6%A0%B7%E5%88%9B%E5%BB%BA%E6%96%87%E6%9C%ACPanel%EF%BC%9F"><span class="nav-text">3.5. 怎样创建文本Panel？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker-monitoring-%E6%98%BE%E7%A4%BA%E9%97%AE%E9%A2%98-1"><span class="nav-text">3.6. Docker monitoring 显示问题</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Prometheus%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98"><span class="nav-text">4. Prometheus相关问题</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Dashboard%E5%8F%98%E9%87%8F%E5%92%8CPanel%E7%BC%BA%E5%A4%B1%E6%95%B0%E6%8D%AE%E9%97%AE%E9%A2%98"><span class="nav-text">4.1. Dashboard变量和Panel缺失数据问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BC%BA%E5%A4%B1%E6%96%87%E4%BB%B6%E5%8F%A5%E6%9F%84%E6%8C%87%E6%A0%87%E9%97%AE%E9%A2%98"><span class="nav-text">4.2. 缺失文件句柄指标问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%83%A8%E5%88%86cAdvisor-Endpoind-DOWN%E9%97%AE%E9%A2%98"><span class="nav-text">4.3. 部分cAdvisor Endpoind DOWN问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%83%A8%E5%88%86cAdvisor-Endpoint%E7%BC%BAlabel%E9%97%AE%E9%A2%98"><span class="nav-text">4.4. 部分cAdvisor Endpoint缺label问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#node-exporter%E4%B8%BB%E6%9C%BA%E5%90%8D%E5%92%8CIP%E9%97%AE%E9%A2%981"><span class="nav-text">4.5. node-exporter主机名和IP问题1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#node-exporter%E4%B8%BB%E6%9C%BA%E5%90%8D%E5%92%8CIP%E9%97%AE%E9%A2%982"><span class="nav-text">4.6. node-exporter主机名和IP问题2</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#serviceMonitor%E6%B2%A1%E6%9C%89%E7%94%9F%E6%95%88%E9%97%AE%E9%A2%98"><span class="nav-text">5. serviceMonitor没有生效问题</span></a></li></ol></div></div><div class="sidecar-ads" style="margin-top:10px"><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="好好学习的郝" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">好好学习的郝</p><div class="site-description" itemprop="description">一个计算机技术爱好者与学习者</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">748</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">32</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">259</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:voidking@qq.com" title="E-Mail → mailto:voidking@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://github.com/voidking" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="http://weibo.com/voidking" title="Weibo → http:&#x2F;&#x2F;weibo.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i> Weibo</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/voidking" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-quora"></i> Zhihu</a></span></div></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2014 – <span itemprop="copyrightYear">2025</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">好好学习的郝</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="footer-beian"> <a href="http://beian.miit.gov.cn/" target="_blank">苏ICP备14021030号</a>&nbsp;|&nbsp; <img src="/images/beian.png" alt=""> <a target="_blank" href="http://www.beian.gov.cn/">苏公网安备 32032202000223号</a></div></div></footer></div><script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.css"><script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: '5a238b8c32b1e4dd2156',
      clientSecret: 'bfb5d518626f6fdc7da0351d1e0cd37ab75c6361',
      repo: 'gitalk-comments',
      owner: 'voidking',
      admin: ['voidking'],
      id: '62a19db1d47b942f7db73f11421ccc27',
      title: 'Grafana和Prometheus问题记录',
      body: '欢迎留言，互相交流学习~',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script></body></html>