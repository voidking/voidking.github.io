<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:new URL("https://www.voidking.com").hostname,root:"/",scheme:"Gemini",version:"7.7.1",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1,cdn:{enable:!0,url:"//cdn.jsdelivr.net/gh/voidking/voidking.github.io/search.xml"}},path:"search.xml",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="前言在《VirtualBox中安装OpenStack》一文中，已经成功安装过openstack。如今，确定了研究方向就是OpenStack。第一步要做的，就是在实体机安装配置OpenStack。 由于版本更新，devstack目前只支持ubuntu16，而机房服务器使用的都是ubuntu14.04，很尴尬。尝试了旧的newton、mitaka、liberty，但是devstack依赖的keysto"><meta property="og:type" content="article"><meta property="og:title" content="Ubuntu16安装OpenStack"><meta property="og:url" content="https://www.voidking.com/dev-ubuntu16-openstack/index.html"><meta property="og:site_name" content="好好学习的郝"><meta property="og:description" content="前言在《VirtualBox中安装OpenStack》一文中，已经成功安装过openstack。如今，确定了研究方向就是OpenStack。第一步要做的，就是在实体机安装配置OpenStack。 由于版本更新，devstack目前只支持ubuntu16，而机房服务器使用的都是ubuntu14.04，很尴尬。尝试了旧的newton、mitaka、liberty，但是devstack依赖的keysto"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://cdn.voidking.com//imgs/ubuntu16-openstack/net.jpg?imageView2/0/h/800"><meta property="og:image" content="http://cdn.voidking.com//imgs/ubuntu16-openstack/instance.jpg?imageView2/0/h/800"><meta property="og:image" content="http://cdn.voidking.com//imgs/ubuntu16-openstack/create.jpg?imageView2/0/w/800"><meta property="og:image" content="http://cdn.voidking.com//imgs/ubuntu16-openstack/rule.jpg?imageView2/0/w/800"><meta property="og:image" content="http://cdn.voidking.com//imgs/ubuntu16-openstack/select.jpg?imageView2/0/h/800"><meta property="og:image" content="http://cdn.voidking.com//imgs/ubuntu16-openstack/username.jpg?imageView2/0/w/800"><meta property="og:image" content="http://cdn.voidking.com//imgs/ubuntu16-openstack/login.jpg?imageView2/0/w/800"><meta property="article:published_time" content="2018-06-26T11:30:00.000Z"><meta property="article:modified_time" content="2018-06-26T11:30:00.000Z"><meta property="article:author" content="好好学习的郝"><meta property="article:tag" content="linux"><meta property="article:tag" content="ubuntu"><meta property="article:tag" content="openstack"><meta property="article:tag" content="devstack"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://cdn.voidking.com//imgs/ubuntu16-openstack/net.jpg?imageView2/0/h/800"><link rel="canonical" href="https://www.voidking.com/dev-ubuntu16-openstack/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0}</script><title>Ubuntu16安装OpenStack | 好好学习的郝</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?b759ac2a7fa45129e3ef060bf68259f0";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="好好学习的郝" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">好好学习的郝</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">好好学习，天天向上！</h1></div><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/voidking" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.voidking.com/dev-ubuntu16-openstack/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="好好学习的郝"><meta itemprop="description" content="学而不思则罔，思而不学则殆！"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="好好学习的郝"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> Ubuntu16安装OpenStack</h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2018-06-26 11:30:00" itemprop="dateCreated datePublished" datetime="2018-06-26T11:30:00+00:00">2018-06-26</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/" itemprop="url" rel="index"><span itemprop="name">engineering</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/openstack/" itemprop="url" rel="index"><span itemprop="name">openstack</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>在<a href="http://www.voidking.com/dev-virtualbox-ubuntu-openstack/">《VirtualBox中安装OpenStack》</a>一文中，已经成功安装过openstack。如今，确定了研究方向就是OpenStack。第一步要做的，就是在实体机安装配置OpenStack。</p><p>由于版本更新，devstack目前只支持ubuntu16，而机房服务器使用的都是ubuntu14.04，很尴尬。尝试了旧的newton、mitaka、liberty，但是devstack依赖的keystone项目中没有了这三个分支，失败；尝试了新的pike、queens，但是ubuntu14中缺少相应的包，失败。</p><p>找到了<a target="_blank" rel="noopener" href="http://ohmystack.com/articles/install-OpenStack-using-Devstack">DevStack 安装 grizzly-eol 版本 OpenStack</a>一文，以为在local.conf中把分支改为tag就可以了。然而，报错接连不断，解决了N个小怪，随便出来个大BOSS就我拦住了。</p><p>最终，把系统换成了Ubuntu16，计划使用devstack安装最新版Queens，主要参考<a target="_blank" rel="noopener" href="https://docs.openstack.org/devstack/latest/">DevStack官方文档</a>、<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/28996062">《优雅安装OpenStack》</a>和<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41241568/article/details/79646871">使用devstack安装OpenStack 双节点部署</a>。</p><span id="more"></span><h1 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h1><p>本文的目标是搭建一个 all-in-one OpenStack，所有核心服务都安装在ccrfox105节点上，节点IP为172.16.0.105。</p><p>核心服务包括：身份认证服务keystone，镜像服务glance，计算服务nova（默认使用KVM虚拟化），网络服务neutron，仪表板horizon。也需要包含一些支持服务，例如：SQL数据库，消息队列和NTP。</p><h1 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h1><h2 id="更换sources-list（可选）"><a href="#更换sources-list（可选）" class="headerlink" title="更换sources.list（可选）"></a>更换sources.list（可选）</h2><p>参考<a href="https://www.voidking.com/dev-ubuntu-change-sources/">《Ubuntu更换源列表》</a>。</p><p>1、备份源列表文件<br><code>sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak</code></p><p>2、编辑源列表文件<br><code>sudo vim /etc/apt/sources.list</code></p><p>修改为：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">deb http:<span class="regexp">//mi</span>rrors.aliyun.com<span class="regexp">/ubuntu/</span> xenial main restricted universe multiverse  </span><br><span class="line">deb http:<span class="regexp">//mi</span>rrors.aliyun.com<span class="regexp">/ubuntu/</span> xenial-security main restricted universe multiverse  </span><br><span class="line">deb http:<span class="regexp">//mi</span>rrors.aliyun.com<span class="regexp">/ubuntu/</span> xenial-updates main restricted universe multiverse  </span><br><span class="line">deb http:<span class="regexp">//mi</span>rrors.aliyun.com<span class="regexp">/ubuntu/</span> xenial-proposed main restricted universe multiverse  </span><br><span class="line">deb http:<span class="regexp">//mi</span>rrors.aliyun.com<span class="regexp">/ubuntu/</span> xenial-backports main restricted universe multiverse  </span><br><span class="line">deb-src http:<span class="regexp">//mi</span>rrors.aliyun.com<span class="regexp">/ubuntu/</span> xenial main restricted universe multiverse  </span><br><span class="line">deb-src http:<span class="regexp">//mi</span>rrors.aliyun.com<span class="regexp">/ubuntu/</span> xenial-security main restricted universe multiverse  </span><br><span class="line">deb-src http:<span class="regexp">//mi</span>rrors.aliyun.com<span class="regexp">/ubuntu/</span> xenial-updates main restricted universe multiverse  </span><br><span class="line">deb-src http:<span class="regexp">//mi</span>rrors.aliyun.com<span class="regexp">/ubuntu/</span> xenial-proposed main restricted universe multiverse  </span><br><span class="line">deb-src http:<span class="regexp">//mi</span>rrors.aliyun.com<span class="regexp">/ubuntu/</span> xenial-backports main restricted universe multiverse</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>3、更新资源包<br><code>sudo apt-get update</code></p><h2 id="时间同步"><a href="#时间同步" class="headerlink" title="时间同步"></a>时间同步</h2><p>1、同步时区<br>执行命令<code>sudo dpkg-reconfigure tzdata</code>，然后选择Asia，Shanghai。</p><p>2、安装时间同步工具</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install ntpdate</span><br><span class="line">sudo ntpdate cn<span class="selector-class">.pool</span><span class="selector-class">.ntp</span><span class="selector-class">.org</span></span><br><span class="line">date</span><br></pre></td></tr></table></figure><h2 id="devstack下载"><a href="#devstack下载" class="headerlink" title="devstack下载"></a>devstack下载</h2><p>1、安装git<br><code>sudo apt-get install git</code></p><p>2、下载devstack并切换到queens分支<br><code>git clone https://git.openstack.org/openstack-dev/devstack -b stable/queens</code></p><h2 id="创建stack用户"><a href="#创建stack用户" class="headerlink" title="创建stack用户"></a>创建stack用户</h2><p><strong>方法一：</strong><br>1、执行创建用户脚本<br><code>sudo devstack/tools/create-stack-user.sh</code></p><p>2、将devstack目录放到/opt/stack中并设置权限<br><code>sudo mv devstack /opt/stack</code></p><p><code>sudo chown -R stack:stack /opt/stack</code></p><p>3、切换到stack用户<br><code>sudo su - stack</code></p><p><strong>方法二：</strong><br>1、添加stack用户<br><code>sudo useradd -s /bin/bash -d /opt/stack -m stack</code></p><p>2、给stack用户添加sudo权限<br><code>echo &quot;stack ALL=(ALL) NOPASSWD: ALL&quot; | sudo tee /etc/sudoers.d/stack</code></p><p>3、将devstack目录放到/opt/stack中并设置权限<br><code>sudo mv devstack /opt/stack</code></p><p><code>sudo chown -R stack:stack /opt/stack</code></p><p>4、切换到stack用户<br><code>sudo su - stack</code></p><h2 id="更换pip源（可选）"><a href="#更换pip源（可选）" class="headerlink" title="更换pip源（可选）"></a>更换pip源（可选）</h2><p>参考<a href="https://www.voidking.com/dev-pip-source/">《python pip更换国内源》</a>。</p><p>1、安装python<br><code>sudo apt-get install python</code></p><p>2、创建pip.conf<br><code>mkdir ~/.pip &amp;&amp; vim ~/.pip/pip.conf</code></p><p>写入内容如下：</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">global</span>]</span><br><span class="line"><span class="keyword">index</span>-url = http://mirrors.aliyun.com/pypi/simple/</span><br><span class="line"></span><br><span class="line">[install]</span><br><span class="line"><span class="keyword">trusted</span>-host = http://mirrors.aliyun.com/pypi/simple/</span><br></pre></td></tr></table></figure><h2 id="编译安装"><a href="#编译安装" class="headerlink" title="编译安装"></a>编译安装</h2><p>1、拷贝local.conf<br><code>cd devstack &amp;&amp; cp samples/local.conf ./</code></p><p>2、修改local.conf密码配置为：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">ADMIN_PASSWORD</span>=secret</span><br><span class="line"><span class="attr">DATABASE_PASSWORD</span>=<span class="variable">$ADMIN_PASSWORD</span></span><br><span class="line"><span class="attr">RABBIT_PASSWORD</span>=<span class="variable">$ADMIN_PASSWORD</span></span><br><span class="line"><span class="attr">SERVICE_PASSWORD</span>=<span class="variable">$ADMIN_PASSWORD</span></span><br></pre></td></tr></table></figure><p>同时在最后添加：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GIT_BASE=http:<span class="regexp">//gi</span>t.trystack.cn</span><br><span class="line">NOVNC_REPO=http:<span class="regexp">//gi</span>t.trystack.cn<span class="regexp">/kanaka/</span>noVNC.git</span><br><span class="line">SPICE_REPO=http:<span class="regexp">//gi</span>t.trystack.cn<span class="regexp">/git/</span>spice/spice-html5.git</span><br></pre></td></tr></table></figure><p>3、拷贝local.sh<br><code>cp samples/local.sh ./</code></p><p>4、执行安装<br><code>./stack.sh</code></p><p>安装报错：E: Unable to locate package libsystemd-dev。<br>（1）安装libsystemd-dev，<code>sudo apt install libsystemd-dev</code>，没有找到libsystemd-dev这个包。</p><p>（2）查找libsystemd-dev，<code>sudo apt search libsystemd-dev</code>，果然没有找到libsystemd-dev。</p><p>（3）猜测是sources.list的锅，改成原sources.list，问题解决。</p><p>然后报错pip版本太低，升级却失败，删除.pip目录，问题解决。。。</p><p>接下来，顺利安装，最后报错：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">2018</span>-<span class="number">06</span>-<span class="number">27</span> <span class="number">00</span>:<span class="number">47</span>:<span class="number">54</span>.<span class="number">156</span> | More than one SecurityGroup exists with the name &#x27;default&#x27;.</span><br><span class="line"><span class="attribute">2018</span>-<span class="number">06</span>-<span class="number">27</span> <span class="number">00</span>:<span class="number">47</span>:<span class="number">55</span>.<span class="number">193</span> | More than one SecurityGroup exists with the name &#x27;default&#x27;.</span><br><span class="line"><span class="attribute">2018</span>-<span class="number">06</span>-<span class="number">27</span> <span class="number">00</span>:<span class="number">47</span>:<span class="number">55</span>.<span class="number">246</span> | ++./stack.sh:main:<span class="number">1390</span>                   err_trap</span><br><span class="line"><span class="attribute">2018</span>-<span class="number">06</span>-<span class="number">27</span> <span class="number">00</span>:<span class="number">47</span>:<span class="number">55</span>.<span class="number">254</span> | ++./stack.sh:err_trap:<span class="number">551</span>                   local r=<span class="number">1</span></span><br><span class="line"><span class="attribute">2018</span>-<span class="number">06</span>-<span class="number">27</span> <span class="number">00</span>:<span class="number">47</span>:<span class="number">55</span>.<span class="number">261</span> | stack.sh failed: full log in /opt/stack/logs/stack.sh.log.<span class="number">2018</span>-<span class="number">06</span>-<span class="number">27</span>-<span class="number">082830</span></span><br><span class="line"><span class="attribute">2018</span>-<span class="number">06</span>-<span class="number">27</span> <span class="number">00</span>:<span class="number">47</span>:<span class="number">55</span>.<span class="number">264</span> | Error <span class="literal">on</span> exit</span><br></pre></td></tr></table></figure><p>参考<a target="_blank" rel="noopener" href="https://www.sohu.com/a/151470875_609513">如何修改默认OpenStack安全组中的规则</a>，查看securitygroup规则，<code>openstack security group list</code></p><p>在多租户OpenStack环境中，存在多个名为“default”的安全组。在这种情况下，请使用安全组ID而不是安全组名称。云管理员可以使用OpenStack安全组列表来显示所有安全组及其当前分配的名称。</p><h2 id="再次安装"><a href="#再次安装" class="headerlink" title="再次安装"></a>再次安装</h2><p>我觉得上面的安装好像失败了，打算重装。<br>1、先在devstack目录中，执行卸载</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./unstack.sh</span><br><span class="line">./clean.sh</span><br></pre></td></tr></table></figure><p>2、再次安装<br><code>./stack.sh</code></p><p>最后还是报同样的错误。不管了，测试下看看。</p><h2 id="测试使用"><a href="#测试使用" class="headerlink" title="测试使用"></a>测试使用</h2><p>1、访问 <a target="_blank" rel="noopener" href="http://172.16.0.105/dashboard">http://172.16.0.105/dashboard</a> ，用户名输入admin，密码输入secret，登录控制台。</p><p>2、项目，网络，创建网络和路由<br><img src="http://cdn.voidking.com//imgs/ubuntu16-openstack/net.jpg?imageView2/0/h/800"></p><p>3、项目，计算，创建实例<br><img src="http://cdn.voidking.com//imgs/ubuntu16-openstack/instance.jpg?imageView2/0/h/800"></p><p>报错：</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error: Failed to perform requested operation on<span class="built_in"> instance </span><span class="string">&quot;vm1&quot;</span>, the<span class="built_in"> instance </span>has an error status: Please try again later [Error: Host &#x27;ccrfox105&#x27; is<span class="built_in"> not </span>mapped to any cell].</span><br></pre></td></tr></table></figure><p>我们查看一下openstack的服务是否正常：</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">openstack service <span class="type">list</span></span><br><span class="line">openstack endpoint <span class="type">list</span></span><br><span class="line">openstack compute service <span class="type">list</span></span><br></pre></td></tr></table></figure><p>提示：Missing value auth-url required for auth plugin password<br>解决办法：进入devstack目录，执行</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">source</span> openrc voidking <span class="keyword">project</span></span><br><span class="line"><span class="keyword">source</span> openrc admin admin</span><br></pre></td></tr></table></figure><p>虽然Missing value auth-url required for auth plugin password的问题解决了，但是还是无法创建实例。</p><p>参考<a target="_blank" rel="noopener" href="https://www.leolan.top/index.php/posts/209.html">OpenStack应用、报错</a>，执行<code>nova-manage cell_v2 discover_hosts</code>，问题解决。</p><h2 id="网络问题"><a href="#网络问题" class="headerlink" title="网络问题"></a>网络问题</h2><p>实例创建成功了，也分配了浮动IP为172.24.4.7，但是从ccrfox105上却ping不通实例。参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/yasyal515/article/details/74946977">Openstack创建实例–horizon篇</a>，进行如下设置：</p><p>1、项目，网络，安全组，创建安全组。<br><img src="http://cdn.voidking.com//imgs/ubuntu16-openstack/create.jpg?imageView2/0/w/800"></p><p>2、管理规则，添加出口入口icmp规则和tcp规则。<br><img src="http://cdn.voidking.com//imgs/ubuntu16-openstack/rule.jpg?imageView2/0/w/800"></p><p>3、实例的安全组选择新建的规则。<br><img src="http://cdn.voidking.com//imgs/ubuntu16-openstack/select.jpg?imageView2/0/h/800"></p><p>然后，再次<code>ping 172.24.4.7</code>，网络就通了。</p><h2 id="测试访问"><a href="#测试访问" class="headerlink" title="测试访问"></a>测试访问</h2><p>1、项目，计算，实例，实例名称，日志。即可看到cirros系统的用户名和密码。<br><img src="http://cdn.voidking.com//imgs/ubuntu16-openstack/username.jpg?imageView2/0/w/800"></p><p>2、然后在ccrfox105上，ssh登录cirros系统。<br><img src="http://cdn.voidking.com//imgs/ubuntu16-openstack/login.jpg?imageView2/0/w/800"></p><h2 id="卸载devstack"><a href="#卸载devstack" class="headerlink" title="卸载devstack"></a>卸载devstack</h2><p>如果devstack安装失败或者不再需要，那么可以对它进行卸载。</p><p>执行<code>./unstack.sh</code>和<code>./clean.sh</code>，卸载openstack。然后删除stack用户，删除<code>/opt/stack</code>目录。</p><p>或者，干脆重装系统，因为卸载后会有很多遗留问题。</p><h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>至此，完成了单节点OpenStack的安装，也进行了简单地创建实例和测试，nice。</p><p>接下来有两个计划，一个是尝试OpenStack更多的操作和设置，以便熟悉这个平台。另一个是使用devstack安装多节点OpenStack，或者手动安装多节点Openstack。计划搭建一个Controller节点和两个Compute节点。</p><p>在安装时，自作聪明地更换了sources.list和pip.conf，以为可以加速安装，没想到却给自己挖了坑，同学们引以为鉴啊。</p></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 好好学习的郝</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://www.voidking.com/dev-ubuntu16-openstack/" title="Ubuntu16安装OpenStack">https://www.voidking.com/dev-ubuntu16-openstack/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！源站会及时更新知识点及修正错误，阅读体验也更好。欢迎分享，欢迎收藏~</li></ul></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/linux/" rel="tag"># linux</a> <a href="/tags/ubuntu/" rel="tag"># ubuntu</a> <a href="/tags/openstack/" rel="tag"># openstack</a> <a href="/tags/devstack/" rel="tag"># devstack</a></div><div class="post-nav"><div class="post-nav-item"><a href="/dev-linux-virtualbox/" rel="prev" title="Linux下使用VirtualBox"><i class="fa fa-chevron-left"></i> Linux下使用VirtualBox</a></div><div class="post-nav-item"> <a href="/dev-openstack-add-mirror/" rel="next" title="OpenStack添加镜像">OpenStack添加镜像<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><div class="comments"><div id="lv-container" data-id="city" data-uid="MTAyMC8zODU3Mi8xNTEwMA=="></div></div><script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%9B%AE%E6%A0%87"><span class="nav-number">2.</span> <span class="nav-text">目标</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="nav-number">3.</span> <span class="nav-text">环境准备</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9B%B4%E6%8D%A2sources-list%EF%BC%88%E5%8F%AF%E9%80%89%EF%BC%89"><span class="nav-number">3.1.</span> <span class="nav-text">更换sources.list（可选）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%97%B6%E9%97%B4%E5%90%8C%E6%AD%A5"><span class="nav-number">3.2.</span> <span class="nav-text">时间同步</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#devstack%E4%B8%8B%E8%BD%BD"><span class="nav-number">3.3.</span> <span class="nav-text">devstack下载</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BAstack%E7%94%A8%E6%88%B7"><span class="nav-number">3.4.</span> <span class="nav-text">创建stack用户</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9B%B4%E6%8D%A2pip%E6%BA%90%EF%BC%88%E5%8F%AF%E9%80%89%EF%BC%89"><span class="nav-number">3.5.</span> <span class="nav-text">更换pip源（可选）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85"><span class="nav-number">3.6.</span> <span class="nav-text">编译安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%86%8D%E6%AC%A1%E5%AE%89%E8%A3%85"><span class="nav-number">3.7.</span> <span class="nav-text">再次安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95%E4%BD%BF%E7%94%A8"><span class="nav-number">3.8.</span> <span class="nav-text">测试使用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E9%97%AE%E9%A2%98"><span class="nav-number">3.9.</span> <span class="nav-text">网络问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95%E8%AE%BF%E9%97%AE"><span class="nav-number">3.10.</span> <span class="nav-text">测试访问</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%B8%E8%BD%BDdevstack"><span class="nav-number">3.11.</span> <span class="nav-text">卸载devstack</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%90%8E%E8%AE%B0"><span class="nav-number">4.</span> <span class="nav-text">后记</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="好好学习的郝" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">好好学习的郝</p><div class="site-description" itemprop="description">学而不思则罔，思而不学则殆！</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">627</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">29</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">232</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:voidking@qq.com" title="E-Mail → mailto:voidking@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://github.com/voidking" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="http://weibo.com/voidking" title="Weibo → http:&#x2F;&#x2F;weibo.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i> Weibo</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/voidking" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-quora"></i> Zhihu</a></span></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2014 – <span itemprop="copyrightYear">2023</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">好好学习的郝</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="footer-beian"> <a href="http://beian.miit.gov.cn/" target="_blank">苏ICP备14021030号</a>&nbsp;|&nbsp; <img src="/images/beian.png" alt=""> <a target="_blank" href="http://www.beian.gov.cn/">苏公网安备 32032202000223号</a></div></div></footer><div id="needsharebutton-float"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div></div><script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css"><script src="/lib/needsharebutton/needsharebutton.js"></script><script>pbOptions={iconStyle:"box",boxForm:"horizontal",position:"bottomCenter",networks:"Weibo,Wechat,Douban,QQZone,Twitter,Facebook"},new needShareButton("#needsharebutton-postbottom",pbOptions),flOptions={iconStyle:"box",boxForm:"horizontal",position:"topRight",networks:"Weibo,Wechat,Douban,QQZone,Twitter,Facebook"},new needShareButton("#needsharebutton-float",flOptions)</script><script>
NexT.utils.loadComments(document.querySelector('#lv-container'), () => {
  // window.livereOptions = {
  //   refer: location.pathname.replace(CONFIG.root, '').replace('index.html', '')
  // };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
});
</script></body></html>