<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:new URL("https://www.voidking.com").hostname,root:"/",scheme:"Gemini",version:"7.7.1",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1,cdn:{enable:!0,url:"//qiniu-cdn.voidking.com/doc/search.xml"}},path:"search.xml",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="前言在笔记本电脑作为Ubuntu服务器使用时，大部分时候是不需要使用桌面（图形界面）的。但是，某些软件是必须要图形界面的，比如自带的浏览器，比如办公软件等等。 我们当然可以打开笔记本，直接使用桌面，但是这样就失去了笔记本电脑作为服务器的初衷。我们想要的是，服务器固定在一个位置，不需要再变动，一切操作都可以远程。"><meta property="og:type" content="article"><meta property="og:title" content="废弃笔记本电脑复活：第四篇 远程控制Ubuntu桌面"><meta property="og:url" content="https://www.voidking.com/dev-laptop-recycling-04-ubuntu-desktop-remote-control/index.html"><meta property="og:site_name" content="好好学习的郝"><meta property="og:description" content="前言在笔记本电脑作为Ubuntu服务器使用时，大部分时候是不需要使用桌面（图形界面）的。但是，某些软件是必须要图形界面的，比如自带的浏览器，比如办公软件等等。 我们当然可以打开笔记本，直接使用桌面，但是这样就失去了笔记本电脑作为服务器的初衷。我们想要的是，服务器固定在一个位置，不需要再变动，一切操作都可以远程。"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2023-12-02T08:00:00.000Z"><meta property="article:modified_time" content="2024-11-09T08:00:00.000Z"><meta property="article:author" content="好好学习的郝"><meta property="article:tag" content="linux"><meta property="article:tag" content="ubuntu"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://www.voidking.com/dev-laptop-recycling-04-ubuntu-desktop-remote-control/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0}</script><title>废弃笔记本电脑复活：第四篇 远程控制Ubuntu桌面 | 好好学习的郝</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?b759ac2a7fa45129e3ef060bf68259f0";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="好好学习的郝" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">好好学习的郝</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">一个计算机技术爱好者与学习者</h1></div><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/voidking" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.voidking.com/dev-laptop-recycling-04-ubuntu-desktop-remote-control/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="好好学习的郝"><meta itemprop="description" content="一个计算机技术爱好者与学习者"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="好好学习的郝"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> 废弃笔记本电脑复活：第四篇 远程控制Ubuntu桌面</h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2023-12-02 08:00:00" itemprop="dateCreated datePublished" datetime="2023-12-02T08:00:00+00:00">2023-12-02</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2024-11-09 08:00:00" itemprop="dateModified" datetime="2024-11-09T08:00:00+00:00">2024-11-09</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/" itemprop="url" rel="index"><span itemprop="name">engineering</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="前言"><span class="post-title-index">1.</span><a href="#前言" class="headerlink" title="前言"></a> 前言</h1><p>在笔记本电脑作为Ubuntu服务器使用时，大部分时候是不需要使用桌面（图形界面）的。但是，某些软件是必须要图形界面的，比如自带的浏览器，比如办公软件等等。</p><p>我们当然可以打开笔记本，直接使用桌面，但是这样就失去了笔记本电脑作为服务器的初衷。我们想要的是，服务器固定在一个位置，不需要再变动，一切操作都可以远程。</p><span id="more"></span><h1 id="远程控制Ubuntu桌面概述"><span class="post-title-index">2.</span><a href="#远程控制Ubuntu桌面概述" class="headerlink" title="远程控制Ubuntu桌面概述"></a> 远程控制Ubuntu桌面概述</h1><p>远程控制Ubuntu桌面，常用的方法包括：</p><ul><li>使用VNCServer：安装配置VNCServer，通过VNC远程</li><li>使用自带的远程控制功能：开启Ubuntu22自带的远程控制，通过RDP或VNC远程</li><li>使用专业的远程控制软件：安装使用专业的远程控制软件，比如向日葵和RustDesk</li></ul><h1 id="使用VNCServer"><span class="post-title-index">3.</span><a href="#使用VNCServer" class="headerlink" title="使用VNCServer"></a> 使用VNCServer</h1><h2 id="安装配置VNCServer"><span class="post-title-index">3.1.</span><a href="#安装配置VNCServer" class="headerlink" title="安装配置VNCServer"></a> 安装配置VNCServer</h2><p>1、安装图形化界面gnome</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt-get update &amp;&amp; apt-get upgrade -y</span><br><span class="line">apt-get install -y ubuntu-desktop gnome-panel gnome-settings-daemon metacity nautilus gnome-terminal</span><br><span class="line">reboot</span><br></pre></td></tr></table></figure><p>2、安装vncserver并运行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">apt-get install -y vnc4server <span class="comment"># Ubuntu18/Ubuntu20</span></span><br><span class="line"><span class="comment"># apt-get install -y tightvncserver # Ubuntu22</span></span><br><span class="line">vncserver <span class="comment"># 按照提示配置vnc连接时的密码</span></span><br><span class="line">ps -ef | grep vnc <span class="comment"># 看到 Xvnc4 :1 ，说明是 5901 端口</span></span><br></pre></td></tr></table></figure><p>3、修改vncserver配置</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> -p ~/.vnc/xstartup ~/.vnc/xstartup.bak </span><br><span class="line">vim ~/.vnc/xstartup</span><br></pre></td></tr></table></figure><p>写入内容为：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="built_in">export</span> XKL_XMODMAP_DISABLE=1</span><br><span class="line"><span class="built_in">export</span> XDG_CURRENT_DESKTOP=<span class="string">&quot;GNOME-Flashback:GNOME&quot;</span></span><br><span class="line"><span class="built_in">export</span> XDG_MENU_PREFIX=<span class="string">&quot;gnome-flashback-&quot;</span></span><br><span class="line">gnome-session --session=gnome-flashback-metacity --disable-acceleration-check &amp;</span><br></pre></td></tr></table></figure><p>4、重启vnc会话</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vncserver -<span class="built_in">kill</span> :1 </span><br><span class="line">vncserver -geometry 1920x1080 :1</span><br></pre></td></tr></table></figure><p>参考文档：</p><ul><li><a target="_blank" rel="noopener" href="https://cloud.baidu.com/doc/BCC/s/Jkbrow425">百度智能云 - Ubuntu18.04安装图形化界面并使用VNCViewer连接</a></li><li><a target="_blank" rel="noopener" href="https://help.aliyun.com/zh/simple-application-server/use-cases/use-vnc-to-build-guis-on-ubuntu-18-04-and-20-04">阿里云 - 通过VNC搭建Ubuntu 18.04和20.04图形界面</a></li><li><a target="_blank" rel="noopener" href="https://linuxstory.org/how-to-install-and-configure-vnc-on-ubuntu-22-04/">在 Ubuntu 22.04 上安装和配置 VNC 远程桌面</a></li></ul><h2 id="使用VNCViewer远程"><span class="post-title-index">3.2.</span><a href="#使用VNCViewer远程" class="headerlink" title="使用VNCViewer远程"></a> 使用VNCViewer远程</h2><p>1、本地安装VNCViewer</p><p>2、启动VNCViewer，新建连接<br>参数包括：</p><ul><li>主机的IP和端口（5901）</li><li>VNC连接密码</li></ul><h2 id="问题：VNC连接灰屏"><span class="post-title-index">3.3.</span><a href="#问题：VNC连接灰屏" class="headerlink" title="问题：VNC连接灰屏"></a> 问题：VNC连接灰屏</h2><p>问题描述：在使用VNCViewer连接Ubuntu22中安装的vncserver时，第一次连接正常，第二次连接出现了灰屏。</p><p>解决办法：修改 xstartup 配置，然后重启vnc会话</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line">autocutsel -fork</span><br><span class="line">xrdb <span class="variable">$HOME</span>/.Xresources</span><br><span class="line">xsetroot -solid grey</span><br><span class="line"><span class="built_in">export</span> XKL_XMODMAP_DISABLE=1</span><br><span class="line"><span class="built_in">export</span> XDG_CURRENT_DESKTOP=<span class="string">&quot;GNOME-Flashback:Unity&quot;</span></span><br><span class="line"><span class="built_in">export</span> XDG_MENU_PREFIX=<span class="string">&quot;gnome-flashback-&quot;</span></span><br><span class="line"><span class="built_in">unset</span> DBUS_SESSION_BUS_ADDRESS</span><br><span class="line">gnome-session --session=gnome-flashback-metacity --disable-acceleration-check --debug &amp;</span><br></pre></td></tr></table></figure><p>参考文档：<a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/2387064">Ubuntu 安装 TightVNCServer 时灰屏</a></p><h2 id="问题：弹窗prevents-Wi-Fi-scans"><span class="post-title-index">3.4.</span><a href="#问题：弹窗prevents-Wi-Fi-scans" class="headerlink" title="问题：弹窗prevents Wi-Fi scans"></a> 问题：弹窗prevents Wi-Fi scans</h2><p>问题描述：在使用VNCViewer连接Ubuntu22中安装的vncserver时，正常连接，但是会不停弹窗提示输入密码。<br>弹窗提示内容为：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">System policy prevents Wi-Fi scans</span><br><span class="line">An application is attempting to perform an action that requires privileges</span><br><span class="line">Authentication is required to perform this action.</span><br></pre></td></tr></table></figure><p>输入密码后，还会继续弹窗，无限循环。</p><p>解决办法：wifi scan授权。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/polkit-1/localauthority/50-local.d/wifi.scan.pkla</span><br></pre></td></tr></table></figure><p>写入如下内容：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[Allow Wifi Scan]</span><br><span class="line">Identity=unix-user:*</span><br><span class="line">Action=org.freedesktop.NetworkManager.wifi.scan;org.freedesktop.NetworkManager.enable-disable-wifi;org.freedesktop.NetworkManager.settings.modify.own;org.freedesktop.NetworkManager.settings.modify.system;org.freedesktop.NetworkManager.network-control</span><br><span class="line">ResultAny=yes</span><br><span class="line">ResultInactive=yes</span><br><span class="line">ResultActive=yes</span><br></pre></td></tr></table></figure><p>参考文档：<a target="_blank" rel="noopener" href="https://blog.yanjingang.com/?p=6258">解决Ubuntu”Authentication required. System policy prevents WiFi scans”问题</a></p><h1 id="使用自带的远程控制功能"><span class="post-title-index">4.</span><a href="#使用自带的远程控制功能" class="headerlink" title="使用自带的远程控制功能"></a> 使用自带的远程控制功能</h1><h2 id="开启Ubuntu22自带的远程控制"><span class="post-title-index">4.1.</span><a href="#开启Ubuntu22自带的远程控制" class="headerlink" title="开启Ubuntu22自带的远程控制"></a> 开启Ubuntu22自带的远程控制</h2><p>【安装配置VNC Server】一节中的方法，同样适用Ubuntu22。<br>除此之外，Ubuntu22内置了远程控制功能，可以直接开启RDP和VNC。因此，在使用Ubuntu22时，这种方法更加简单。</p><p>图形界面操作：Settings -&gt; Sharing -&gt; Remote Desktop</p><ul><li>开启 Remote Desktop：支持Windows的Remote Desktop Connection远程连接</li><li>开启 Remote Control：支持使用远程连接软件进行操作控制</li><li>开启 Enable Legacy VNC Protocol：支持使用VNC客户端连接和操作，同时建议选择 Require a password</li><li>设置 Password：在Authentication部分设置密码，用于VNC连接</li></ul><p>这种方法开启的VNC服务，端口默认为 5900</p><p>参考文档：</p><ul><li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/pipci/p/16377032.html">Ubuntu22.04远程桌面配置（RDP，VNC）</a></li></ul><h2 id="问题：VNC连接报错bad-rectangle"><span class="post-title-index">4.2.</span><a href="#问题：VNC连接报错bad-rectangle" class="headerlink" title="问题：VNC连接报错bad rectangle"></a> 问题：VNC连接报错bad rectangle</h2><p>在使用VNCViewer连接Ubuntu22自带的VNC时，可能会报错：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Attempting to reconnect to VNC Server...</span><br><span class="line">Protocol error: bad rectangle: 0x0 at 16191,5376 exceeds 1920x1080 at 0,0</span><br></pre></td></tr></table></figure><p>解决办法：在VNCViewer中的Properties配置中，把Options中的 Picture quality 从 Automatic 调成 High<br>参考文档：</p><ul><li><a target="_blank" rel="noopener" href="https://askubuntu.com/questions/1448924/how-do-i-get-headless-vnc-working">How do I get headless VNC working?</a></li><li><a target="_blank" rel="noopener" href="https://www.su.sh.cn/2020/04/15/solution_on_rfb_protocol_error_bad_rectangle_16384/">rfb protocol error bad rectangle 16384 的解决方案</a></li></ul><h2 id="问题：Ubuntu22自带的远程控制重启失效"><span class="post-title-index">4.3.</span><a href="#问题：Ubuntu22自带的远程控制重启失效" class="headerlink" title="问题：Ubuntu22自带的远程控制重启失效"></a> 问题：Ubuntu22自带的远程控制重启失效</h2><p>问题描述：Ubuntu22自带的远程控制功能，在重启后会失效。<br>具体来说：</p><ul><li>原生的登录功能，需要我们的设备连接显示器，并解锁登录才能够使用。</li><li>原生的桌面共享，设置的用于连接的用户密码，会随着系统重启而使用随机字符串填充，影响我们登录。</li></ul><p>解决办法：使用脚本自动对系统远程控制相关功能进行配置。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/soulteary/ubuntu-remote-control-helper/raw/main/example/installer.sh</span><br><span class="line">bash installer.sh</span><br><span class="line">UBUNTU_REMOTE_USER=ubuntu UBUNTU_REMOTE_PASS=ubuntu123 urch</span><br></pre></td></tr></table></figure><p>参考文档：</p><ul><li><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/s6Z8czUB562IMUI6X7j6_Q">使用 Urch 让 Ubuntu 原生远程控制功能稳定可靠</a></li></ul><h1 id="使用专业的远程控制软件"><span class="post-title-index">5.</span><a href="#使用专业的远程控制软件" class="headerlink" title="使用专业的远程控制软件"></a> 使用专业的远程控制软件</h1><h2 id="安装配置向日葵"><span class="post-title-index">5.1.</span><a href="#安装配置向日葵" class="headerlink" title="安装配置向日葵"></a> 安装配置向日葵</h2><p>配置了VNC，为什么还需要向日葵？答：使用向日葵的好处是不用考虑vnc配置问题，直接连Ubuntu原生桌面。</p><p>1、参考向日葵官方文档，安装向日葵<br>安装过程可能报错：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dpkg: dependency problems prevent configuration of sunloginclient:</span><br><span class="line"> sunloginclient depends on libgconf-2-4; however:</span><br><span class="line">  Package libgconf-2-4 is not installed.</span><br></pre></td></tr></table></figure><p>解决办法：安装 libgconf-2-4</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt-get install libgconf-2-4</span><br><span class="line">apt --fix-broken install</span><br><span class="line">apt-get install libgconf-2-4</span><br></pre></td></tr></table></figure><p>安装过程可能报错报错缺少 libwebkit2gtk-xxx<br>解决办法：安装 libwebkit2gtk ，修改并重新打包 deb</p><p>参考文档：</p><ul><li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/691858812">Linux安装向日葵解决libgconf-2-4依赖问题</a></li><li><a target="_blank" rel="noopener" href="https://blog.csdn.net/ikkyphoenix/article/details/142771988">Ubuntu-24.10无法安装Sunlogin-15.2的解决方案</a></li><li><a target="_blank" rel="noopener" href="https://www.mixuying.com/archives/7cef09ef-8fc7-4ad2-981f-b726ab78c301">ubuntu24.04缺少libwebkit2gtk-4.0-37 依赖</a></li><li><a target="_blank" rel="noopener" href="https://pkgs.org/search/?q=libwebkit2gtk">pkgs.org - Search Results for libwebkit2gtk</a></li></ul><p>2、安装 lightdm ，并重启主机</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt install -y lightdm</span><br><span class="line">reboot</span><br></pre></td></tr></table></figure><p>3、查看向日葵服务状态</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl status runsunloginclient</span><br></pre></td></tr></table></figure><p>4、运行向日葵<br>图形界面运行（推荐）：<br>图形界面启动向日葵，登录个人账号，并设置开机自动启动。</p><p>命令行运行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> /usr/local/sunlogin/bin/sunloginclient</span><br></pre></td></tr></table></figure><p>参考文档：</p><ul><li><a target="_blank" rel="noopener" href="https://service.oray.com/question/11017.html">向日葵 - Linux 个人版（命令行版本）使用手册</a></li><li><a target="_blank" rel="noopener" href="https://blog.csdn.net/fighting_88412/article/details/133857593">Ubuntu重启后向日葵远程连接一直卡在连接界面</a></li></ul><h2 id="问题：向日葵连接卡住或黑屏"><span class="post-title-index">5.2.</span><a href="#问题：向日葵连接卡住或黑屏" class="headerlink" title="问题：向日葵连接卡住或黑屏"></a> 问题：向日葵连接卡住或黑屏</h2><p>问题描述：使用向日葵远程，可能会卡在 正在建立远程连接… ，或者登录后黑屏。</p><p>问题原因：向日葵要求显示管理器使用 lightdm，或者 gdm 不开启 wayland。</p><p>解决办法：显示管理器切换 lightdm，或者 gdm 关闭 wayland。</p><p>切换lightdm：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /etc/X11/default-display-manager</span><br><span class="line">dpkg-reconfigure lightdm <span class="comment"># 选择 lightdm</span></span><br><span class="line">reboot</span><br></pre></td></tr></table></figure><p>gdm 关闭 wayland：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /etc/X11/default-display-manager</span><br><span class="line">vim /etc/gdm3/custom.conf <span class="comment"># 修改 gdm3 配置：WaylandEnable=false</span></span><br><span class="line">systemctl restart gdm3</span><br><span class="line">reboot</span><br></pre></td></tr></table></figure><p>参考文档：<a href="https://www.voidking.com/dev-ubuntu22-android-emulator-waydroid/">《Ubuntu22安装使用安卓模拟器Waydroid》</a></p><h2 id="安装配置RustDesk"><span class="post-title-index">5.3.</span><a href="#安装配置RustDesk" class="headerlink" title="安装配置RustDesk"></a> 安装配置RustDesk</h2><p>参考文档：<a href="https://www.voidking.com/dev-docker-install-rustdesk-server/">《好好学Docker：自建RustDesk Server》</a></p></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 好好学习的郝</li><li class="post-copyright-link"> <strong>原文链接：</strong> <a href="https://www.voidking.com/dev-laptop-recycling-04-ubuntu-desktop-remote-control/" title="废弃笔记本电脑复活：第四篇 远程控制Ubuntu桌面">https://www.voidking.com/dev-laptop-recycling-04-ubuntu-desktop-remote-control/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本文采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议，转载请注明出处！源站会即时更新知识点并修正错误，欢迎访问~</li></ul></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/linux/" rel="tag"># linux</a> <a href="/tags/ubuntu/" rel="tag"># ubuntu</a></div><div class="post-nav"><div class="post-nav-item"><a href="/dev-centos-rescue-mode/" rel="prev" title="好好学Linux：CentOS救援模式使用说明"><i class="fa fa-chevron-left"></i> 好好学Linux：CentOS救援模式使用说明</a></div><div class="post-nav-item"> <a href="/dev-laptop-recycling-03-aliyunpan/" rel="next" title="废弃笔记本电脑复活：第三篇 利用阿里云盘扩展存储">废弃笔记本电脑复活：第三篇 利用阿里云盘扩展存储<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><div class="footer-ads" style="margin-top:10px"><ins class="adsbygoogle" style="display:block" data-ad-format="autorelaxed" data-ad-client="ca-pub-3284447971731414" data-ad-slot="9697986181"></ins><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3284447971731414" crossorigin="anonymous"></script><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div class="comments" id="gitalk-container"></div><script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-text">1. 前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6Ubuntu%E6%A1%8C%E9%9D%A2%E6%A6%82%E8%BF%B0"><span class="nav-text">2. 远程控制Ubuntu桌面概述</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8VNCServer"><span class="nav-text">3. 使用VNCServer</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEVNCServer"><span class="nav-text">3.1. 安装配置VNCServer</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8VNCViewer%E8%BF%9C%E7%A8%8B"><span class="nav-text">3.2. 使用VNCViewer远程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%97%AE%E9%A2%98%EF%BC%9AVNC%E8%BF%9E%E6%8E%A5%E7%81%B0%E5%B1%8F"><span class="nav-text">3.3. 问题：VNC连接灰屏</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%97%AE%E9%A2%98%EF%BC%9A%E5%BC%B9%E7%AA%97prevents-Wi-Fi-scans"><span class="nav-text">3.4. 问题：弹窗prevents Wi-Fi scans</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E8%87%AA%E5%B8%A6%E7%9A%84%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6%E5%8A%9F%E8%83%BD"><span class="nav-text">4. 使用自带的远程控制功能</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%80%E5%90%AFUbuntu22%E8%87%AA%E5%B8%A6%E7%9A%84%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6"><span class="nav-text">4.1. 开启Ubuntu22自带的远程控制</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%97%AE%E9%A2%98%EF%BC%9AVNC%E8%BF%9E%E6%8E%A5%E6%8A%A5%E9%94%99bad-rectangle"><span class="nav-text">4.2. 问题：VNC连接报错bad rectangle</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%97%AE%E9%A2%98%EF%BC%9AUbuntu22%E8%87%AA%E5%B8%A6%E7%9A%84%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6%E9%87%8D%E5%90%AF%E5%A4%B1%E6%95%88"><span class="nav-text">4.3. 问题：Ubuntu22自带的远程控制重启失效</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E4%B8%93%E4%B8%9A%E7%9A%84%E8%BF%9C%E7%A8%8B%E6%8E%A7%E5%88%B6%E8%BD%AF%E4%BB%B6"><span class="nav-text">5. 使用专业的远程控制软件</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE%E5%90%91%E6%97%A5%E8%91%B5"><span class="nav-text">5.1. 安装配置向日葵</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%97%AE%E9%A2%98%EF%BC%9A%E5%90%91%E6%97%A5%E8%91%B5%E8%BF%9E%E6%8E%A5%E5%8D%A1%E4%BD%8F%E6%88%96%E9%BB%91%E5%B1%8F"><span class="nav-text">5.2. 问题：向日葵连接卡住或黑屏</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AERustDesk"><span class="nav-text">5.3. 安装配置RustDesk</span></a></li></ol></li></ol></div></div><div class="sidecar-ads" style="margin-top:10px"><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="好好学习的郝" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">好好学习的郝</p><div class="site-description" itemprop="description">一个计算机技术爱好者与学习者</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">776</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">33</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">269</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:voidking@qq.com" title="E-Mail → mailto:voidking@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://github.com/voidking" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="http://weibo.com/voidking" title="Weibo → http:&#x2F;&#x2F;weibo.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i> Weibo</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/voidking" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-quora"></i> Zhihu</a></span></div></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2014 – <span itemprop="copyrightYear">2026</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">好好学习的郝</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="footer-beian"> <a href="http://beian.miit.gov.cn/" target="_blank">苏ICP备14021030号</a>&nbsp;|&nbsp; <img src="/images/beian.png" alt=""> <a target="_blank" href="http://www.beian.gov.cn/">苏公网安备 32032202000223号</a></div></div></footer></div><script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><link rel="stylesheet" href="https://cdn.staticfile.net/gitalk/1.7.2/gitalk.min.css"><script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('https://cdn.staticfile.net/gitalk/1.7.2/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: '5a238b8c32b1e4dd2156',
      clientSecret: 'bfb5d518626f6fdc7da0351d1e0cd37ab75c6361',
      repo: 'gitalk-comments',
      owner: 'voidking',
      admin: ['voidking'],
      id: '7019b3b3664e07a9caea328d5d21d10d',
      title: '废弃笔记本电脑复活：第四篇 远程控制Ubuntu桌面',
      body: '欢迎留言，互相交流学习~',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script></body></html>