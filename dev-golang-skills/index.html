<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:new URL("https://www.voidking.com").hostname,root:"/",scheme:"Gemini",version:"7.7.1",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1,cdn:{enable:!0,url:"//qiniu.cdn.voidking.com/doc/search.xml"}},path:"search.xml",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="前言最近学到了一些Go语言开发时的小技巧，做下记录。 提高下载速度方法一：科学上网 方法二：配置代理，详情参考《Golang包管理工具》 1234# export GOPROXY&#x3D;https:&#x2F;&#x2F;goproxy.cnexport GOPROXY&#x3D;https:&#x2F;&#x2F;goproxy.ioexport GO111MODULE&#x3D;ongo get -v golang.org&#x2F;x&#x2F;tools&#x2F;cmd&#x2F;goimp"><meta property="og:type" content="article"><meta property="og:title" content="好好学Golang：Go语言开发的小技巧"><meta property="og:url" content="https://www.voidking.com/dev-golang-skills/index.html"><meta property="og:site_name" content="好好学习的郝"><meta property="og:description" content="前言最近学到了一些Go语言开发时的小技巧，做下记录。 提高下载速度方法一：科学上网 方法二：配置代理，详情参考《Golang包管理工具》 1234# export GOPROXY&#x3D;https:&#x2F;&#x2F;goproxy.cnexport GOPROXY&#x3D;https:&#x2F;&#x2F;goproxy.ioexport GO111MODULE&#x3D;ongo get -v golang.org&#x2F;x&#x2F;tools&#x2F;cmd&#x2F;goimp"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2020-09-10T20:00:00.000Z"><meta property="article:modified_time" content="2020-09-10T20:00:00.000Z"><meta property="article:author" content="好好学习的郝"><meta property="article:tag" content="golang"><meta property="article:tag" content="好好学Golang"><meta property="article:tag" content="idea"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://www.voidking.com/dev-golang-skills/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0}</script><title>好好学Golang：Go语言开发的小技巧 | 好好学习的郝</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?b759ac2a7fa45129e3ef060bf68259f0";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="好好学习的郝" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">好好学习的郝</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">一个计算机技术爱好者与学习者</h1></div><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/voidking" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.voidking.com/dev-golang-skills/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="好好学习的郝"><meta itemprop="description" content="一个计算机技术爱好者与学习者"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="好好学习的郝"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> 好好学Golang：Go语言开发的小技巧</h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2020-09-10 20:00:00" itemprop="dateCreated datePublished" datetime="2020-09-10T20:00:00+00:00">2020-09-10</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/" itemprop="url" rel="index"><span itemprop="name">engineering</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/golang/" itemprop="url" rel="index"><span itemprop="name">golang</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="前言"><span class="post-title-index">1.</span><a href="#前言" class="headerlink" title="前言"></a> 前言</h1><p>最近学到了一些Go语言开发时的小技巧，做下记录。</p><h1 id="提高下载速度"><span class="post-title-index">2.</span><a href="#提高下载速度" class="headerlink" title="提高下载速度"></a> 提高下载速度</h1><p>方法一：科学上网</p><p>方法二：配置代理，详情参考<a href="https://www.voidking.com/dev-golang-gpm/">《Golang包管理工具》</a></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># export GOPROXY=https://goproxy.cn</span></span><br><span class="line"><span class="built_in">export</span> <span class="attribute">GOPROXY</span>=https://goproxy.io</span><br><span class="line"><span class="built_in">export</span> <span class="attribute">GO111MODULE</span>=on</span><br><span class="line">go <span class="built_in">get</span> -v golang.org/x/tools/cmd/goimports</span><br></pre></td></tr></table></figure><p>方法三：使用gopm</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">go <span class="keyword">get</span> <span class="operator">-</span>v github.com<span class="regexp">/gpmgo/</span>gopm</span><br><span class="line">gopm <span class="keyword">get</span> <span class="operator">-</span>v golang.org<span class="regexp">/x/</span>tools<span class="regexp">/cmd/</span>goimports</span><br></pre></td></tr></table></figure><span id="more"></span><h1 id="编译安装软件"><span class="post-title-index">3.</span><a href="#编译安装软件" class="headerlink" title="编译安装软件"></a> 编译安装软件</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">go build golang.org<span class="regexp">/x/</span>tools<span class="regexp">/cmd/g</span>oimports</span><br><span class="line">go install golang.org<span class="regexp">/x/</span>tools<span class="regexp">/cmd/g</span>oimports</span><br></pre></td></tr></table></figure><h1 id="自动格式化"><span class="post-title-index">4.</span><a href="#自动格式化" class="headerlink" title="自动格式化"></a> 自动格式化</h1><p>Golang希望统一代码风格，因此推出了gofmt工具。gofmt可以格式化单个文件，也可以格式化整个目录下的所有go文件。<br>除了gofmt工具，go语言中还有一个go fmt命令，该命令是gofmt的简单封装。</p><p>在IDEA中，怎样使用gofmt呢？<br>1、菜单栏，IntelliJ IDEA，Preferences…。<br>2、Plugins，搜索File，找到File Watchers插件并安装。<br>3、Tools，File Watchers，添加或修改gofmt模版。</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">File</span> type：Go</span><br><span class="line">Scope：Project <span class="keyword">files</span></span><br><span class="line">Program：/usr/local/go/bin/gofmt</span><br><span class="line">Arguments：-l -w -s <span class="symbol">$</span>FilePath<span class="symbol">$</span></span><br><span class="line">Output paths to refresh：<span class="symbol">$</span>FilePath<span class="symbol">$</span></span><br></pre></td></tr></table></figure><p>4、勾选Enabled。</p><p>保存源码时，就会执行代码格式化了。</p><h1 id="自动引入依赖包"><span class="post-title-index">5.</span><a href="#自动引入依赖包" class="headerlink" title="自动引入依赖包"></a> 自动引入依赖包</h1><p>参考上一节自动格式化，配置 goimports ，自动引入依赖包。</p><h1 id="查看文档"><span class="post-title-index">6.</span><a href="#查看文档" class="headerlink" title="查看文档"></a> 查看文档</h1><p>如果对一个包或者函数不熟悉，可以使用go doc命令查看文档。比如：</p><figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go <span class="meta">doc</span> http.ListenAndServe</span><br></pre></td></tr></table></figure><p>如果想要看一个项目的帮助文档，可以使用godoc工具启动一个文档服务器。</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">go <span class="keyword">get</span> <span class="operator">-</span>v golang.org<span class="regexp">/x/</span>tools<span class="regexp">/cmd/</span>godoc</span><br><span class="line">godoc <span class="operator">-</span>http :<span class="number">6060</span></span><br></pre></td></tr></table></figure><h1 id="测试"><span class="post-title-index">7.</span><a href="#测试" class="headerlink" title="测试"></a> 测试</h1><p>Debugging Sucks! Testing Rocks!<br>Go语言支持三种测试：单元测试、性能测试和http测试，下面分别来看一下。</p><h2 id="单元测试"><span class="post-title-index">7.1.</span><a href="#单元测试" class="headerlink" title="单元测试"></a> 单元测试</h2><p>Go语言单元测试函数以Test为前缀，详情参考<a target="_blank" rel="noopener" href="https://books.studygolang.com/gopl-zh/ch11/ch11-02.html">测试函数</a>。</p><p>实际开发中推荐使用表格驱动测试，就是把测试数据和测试逻辑分开。比如：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestShortFilename</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">    tests := []<span class="keyword">struct</span> &#123;</span><br><span class="line">        in       <span class="type">string</span></span><br><span class="line">        expected <span class="type">string</span></span><br><span class="line">    &#125;&#123;</span><br><span class="line">        &#123;<span class="string">&quot;???&quot;</span>, <span class="string">&quot;???&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&quot;filename.go&quot;</span>, <span class="string">&quot;filename.go&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&quot;hello/filename.go&quot;</span>, <span class="string">&quot;filename.go&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&quot;main/hello/filename.go&quot;</span>, <span class="string">&quot;filename.go&quot;</span>&#125;,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> _, tt := <span class="keyword">range</span> tests &#123;</span><br><span class="line">        actual := getShortFilename(tt.in)</span><br><span class="line">        <span class="keyword">if</span> strings.Compare(actual, tt.expected) != <span class="number">0</span> &#123;</span><br><span class="line">            t.Fail()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在IDEA中查看代码覆盖率：<br>在单元测试函数左边，会出现一个三角箭头，点击它，选择 Run ‘Testxxx’ with Coverage，即可看到代码覆盖率。绿线代表覆盖到了，红线代表没有覆盖到。</p><p>也可以使用命令查看代码覆盖率：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">go test <span class="attribute">-coverprofile</span>=c.out</span><br><span class="line">go<span class="built_in"> tool </span>cover</span><br><span class="line">go<span class="built_in"> tool </span>cover <span class="attribute">html</span>=c.out</span><br></pre></td></tr></table></figure><h2 id="性能测试"><span class="post-title-index">7.2.</span><a href="#性能测试" class="headerlink" title="性能测试"></a> 性能测试</h2><p>1、编写性能测试函数，以Benchmark为前缀，详情参考<a target="_blank" rel="noopener" href="https://books.studygolang.com/gopl-zh/ch11/ch11-04.html">基准测试</a>。</p><p>2、运行基准测试</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go <span class="built_in">test</span> -bench .</span><br></pre></td></tr></table></figure><p>3、详细分析（文本）</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">go <span class="keyword">test</span> bench . -cpuprofile <span class="meta">cpu</span><span class="number">.</span><span class="keyword">out</span></span><br><span class="line">go tool pprof -text -nodecount=<span class="number">10</span> ./<span class="meta">cpu</span><span class="number">.</span><span class="keyword">test</span> <span class="meta">cpu</span><span class="number">.</span><span class="keyword">out</span></span><br></pre></td></tr></table></figure><p>4、详细分析（图表）</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">go tool pprof <span class="meta">cpu</span><span class="number">.</span><span class="keyword">out</span></span><br><span class="line">web</span><br></pre></td></tr></table></figure><p>PS：需要安装<a target="_blank" rel="noopener" href="http://www.graphviz.org/">graphviz</a>，以便生成图表。</p><h2 id="http测试"><span class="post-title-index">7.3.</span><a href="#http测试" class="headerlink" title="http测试"></a> http测试</h2><p>Go语言的http测试使用 net/http/httptest 包，测试方法可以分为两种：一种是使用假的Request/Response，速度快，测试粒度小，适用于测试函数和方法；另外一种是启动http服务器，速度慢，代码覆盖量更大，适用于测试和模拟后端接口。</p><p>先说第一种，使用假的Request/Response：<br>1、已知函数</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">func <span class="built_in">HelloHandler</span>(w http<span class="selector-class">.ResponseWriter</span>, r *http.Request) &#123;</span><br><span class="line">	w<span class="selector-class">.Write</span>(<span class="selector-attr">[]</span><span class="built_in">byte</span>(<span class="string">&quot;hello world&quot;</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2、测试代码</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;io/ioutil&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http/httptest&quot;</span></span><br><span class="line">	<span class="string">&quot;testing&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestHelloHandler</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">	req := httptest.NewRequest(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;http://www.voidking.com/&quot;</span>, <span class="literal">nil</span>)</span><br><span class="line">	w := httptest.NewRecorder()</span><br><span class="line">	HelloHandler(w, req)</span><br><span class="line">	bytes, _ := ioutil.ReadAll(w.Result().Body)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> <span class="type">string</span>(bytes) != <span class="string">&quot;hello world&quot;</span> &#123;</span><br><span class="line">		t.Fatal(<span class="string">&quot;expected hello world, but got&quot;</span>, <span class="type">string</span>(bytes))</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3、运行测试<br><code>go test -v .</code></p><p>再说第二种，启动http服务器。<br>1、已知函数</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">func <span class="built_in">HelloHandler</span>(w http<span class="selector-class">.ResponseWriter</span>, r *http.Request) &#123;</span><br><span class="line">	w<span class="selector-class">.Write</span>(<span class="selector-attr">[]</span><span class="built_in">byte</span>(<span class="string">&quot;hello world&quot;</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2、测试代码</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import (</span><br><span class="line">	<span class="string">&quot;io/ioutil&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http/httptest&quot;</span></span><br><span class="line">	<span class="string">&quot;testing&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func <span class="built_in">TestHelloHandler</span>(t *testing.T) &#123;</span><br><span class="line">	ts := httptest<span class="selector-class">.NewServer</span>(http<span class="selector-class">.HandlerFunc</span>(HelloHandler))</span><br><span class="line">	defer ts<span class="selector-class">.Close</span>()</span><br><span class="line"> </span><br><span class="line">	res, err := http<span class="selector-class">.Get</span>(ts.URL)</span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		t<span class="selector-class">.Fatal</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">	bytes, err := ioutil<span class="selector-class">.ReadAll</span>(res.Body)</span><br><span class="line">	res<span class="selector-class">.Body</span><span class="selector-class">.Close</span>()</span><br><span class="line">	<span class="keyword">if</span> err != nil &#123;</span><br><span class="line">		t<span class="selector-class">.Fatal</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">string</span>(bytes) != <span class="string">&quot;hello world&quot;</span> &#123;</span><br><span class="line">		t<span class="selector-class">.Fatal</span>(<span class="string">&quot;expected hello world, but got&quot;</span>, <span class="built_in">string</span>(bytes))</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3、运行测试<br><code>go test -v .</code></p></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 好好学习的郝</li><li class="post-copyright-link"> <strong>原文链接：</strong> <a href="https://www.voidking.com/dev-golang-skills/" title="好好学Golang：Go语言开发的小技巧">https://www.voidking.com/dev-golang-skills/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本文采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议，转载请注明出处！源站会即时更新知识点并修正错误，欢迎访问~</li><li> <img width="200" height="200" src="/images/avatar.jpg"><p style="text-align:center;margin-bottom:0">微信公众号同步更新，欢迎关注~</p></li></ul></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/golang/" rel="tag"># golang</a> <a href="/tags/%E5%A5%BD%E5%A5%BD%E5%AD%A6Golang/" rel="tag"># 好好学Golang</a> <a href="/tags/idea/" rel="tag"># idea</a></div><div class="post-nav"><div class="post-nav-item"><a href="/dev-idea-golang-python/" rel="prev" title="使用IDEA开发Golang和Python"><i class="fa fa-chevron-left"></i> 使用IDEA开发Golang和Python</a></div><div class="post-nav-item"> <a href="/dev-idea-git-merge-code/" rel="next" title="使用IDEA合并代码的个人实践">使用IDEA合并代码的个人实践<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><div class="footer-ads" style="margin-top:10px"><ins class="adsbygoogle" style="display:block" data-ad-format="autorelaxed" data-ad-client="ca-pub-3284447971731414" data-ad-slot="9697986181"></ins><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3284447971731414" crossorigin="anonymous"></script><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div class="comments" id="gitalk-container"></div><script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-text">1. 前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%8F%90%E9%AB%98%E4%B8%8B%E8%BD%BD%E9%80%9F%E5%BA%A6"><span class="nav-text">2. 提高下载速度</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85%E8%BD%AF%E4%BB%B6"><span class="nav-text">3. 编译安装软件</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%87%AA%E5%8A%A8%E6%A0%BC%E5%BC%8F%E5%8C%96"><span class="nav-text">4. 自动格式化</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%87%AA%E5%8A%A8%E5%BC%95%E5%85%A5%E4%BE%9D%E8%B5%96%E5%8C%85"><span class="nav-text">5. 自动引入依赖包</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E6%96%87%E6%A1%A3"><span class="nav-text">6. 查看文档</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95"><span class="nav-text">7. 测试</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95"><span class="nav-text">7.1. 单元测试</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95"><span class="nav-text">7.2. 性能测试</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#http%E6%B5%8B%E8%AF%95"><span class="nav-text">7.3. http测试</span></a></li></ol></li></ol></div></div><div class="sidecar-ads" style="margin-top:10px"><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="好好学习的郝" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">好好学习的郝</p><div class="site-description" itemprop="description">一个计算机技术爱好者与学习者</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">707</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">31</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">253</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:voidking@qq.com" title="E-Mail → mailto:voidking@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://github.com/voidking" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="http://weibo.com/voidking" title="Weibo → http:&#x2F;&#x2F;weibo.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i> Weibo</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/voidking" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-quora"></i> Zhihu</a></span></div></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2014 – <span itemprop="copyrightYear">2024</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">好好学习的郝</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="footer-beian"> <a href="http://beian.miit.gov.cn/" target="_blank">苏ICP备14021030号</a>&nbsp;|&nbsp; <img src="/images/beian.png" alt=""> <a target="_blank" href="http://www.beian.gov.cn/">苏公网安备 32032202000223号</a></div></div></footer></div><script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.css"><script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: '5a238b8c32b1e4dd2156',
      clientSecret: 'bfb5d518626f6fdc7da0351d1e0cd37ab75c6361',
      repo: 'gitalk-comments',
      owner: 'voidking',
      admin: ['voidking'],
      id: '36f7dfe8789eba7b344aab1852f2adeb',
      title: '好好学Golang：Go语言开发的小技巧',
      body: '欢迎留言，互相交流学习~',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script></body></html>