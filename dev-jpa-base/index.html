<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:new URL("https://www.voidking.com").hostname,root:"/",scheme:"Gemini",version:"7.7.1",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1,cdn:{enable:!0,url:"//qiniu.cdn.voidking.com/doc/search.xml"}},path:"search.xml",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="简介Java持久化规范，是从EJB2.x以前的实体Bean(Entity bean)分离出来的，EJB3以后不再有实体bean，而是将实体bean放到JPA中实现。JPA是sun提出的一个对象持久化规范，各JavaEE应用服务器自主选择具体实现，JPA的设计者是Hibernate框架的作者，因此Hibernate作为Jboss服务器中JPA的默认实现，Oracle的Weblogic使用Eclips"><meta property="og:type" content="article"><meta property="og:title" content="JPA基础"><meta property="og:url" content="https://www.voidking.com/dev-jpa-base/index.html"><meta property="og:site_name" content="好好学习的郝"><meta property="og:description" content="简介Java持久化规范，是从EJB2.x以前的实体Bean(Entity bean)分离出来的，EJB3以后不再有实体bean，而是将实体bean放到JPA中实现。JPA是sun提出的一个对象持久化规范，各JavaEE应用服务器自主选择具体实现，JPA的设计者是Hibernate框架的作者，因此Hibernate作为Jboss服务器中JPA的默认实现，Oracle的Weblogic使用Eclips"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2015-07-30T22:00:12.000Z"><meta property="article:modified_time" content="2015-07-30T22:00:12.000Z"><meta property="article:author" content="好好学习的郝"><meta property="article:tag" content="java"><meta property="article:tag" content="eclipse"><meta property="article:tag" content="jpa"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://www.voidking.com/dev-jpa-base/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0}</script><title>JPA基础 | 好好学习的郝</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?b759ac2a7fa45129e3ef060bf68259f0";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="好好学习的郝" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">好好学习的郝</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">一个计算机技术爱好者与学习者</h1></div><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/voidking" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.voidking.com/dev-jpa-base/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="好好学习的郝"><meta itemprop="description" content="一个计算机技术爱好者与学习者"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="好好学习的郝"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> JPA基础</h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2015-07-30 22:00:12" itemprop="dateCreated datePublished" datetime="2015-07-30T22:00:12+00:00">2015-07-30</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/" itemprop="url" rel="index"><span itemprop="name">engineering</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="简介"><span class="post-title-index">1.</span><a href="#简介" class="headerlink" title="简介"></a> 简介</h2><p>Java持久化规范，是从EJB2.x以前的实体Bean(Entity bean)分离出来的，EJB3以后不再有实体bean，而是将实体bean放到JPA中实现。JPA是sun提出的一个对象持久化规范，各JavaEE应用服务器自主选择具体实现，JPA的设计者是Hibernate框架的作者，因此Hibernate作为Jboss服务器中JPA的默认实现，Oracle的Weblogic使用EclipseLink(以前叫TopLink)作为默认的JPA实现，IBM的Websphere和Sun的Glassfish默认使用OpenJPA(Apache的一个开源项目)作为其默认的JPA实现。</p><p>JPA的底层实现是一些流行的开源ORM(对象关系映射)框架，因此JPA其实也就是java实体对象和关系型数据库建立起映射关系，通过面向对象编程的思想操作关系型数据库的规范。</p><span id="more"></span><h2 id="JPA的持久化策略文件"><span class="post-title-index">2.</span><a href="#JPA的持久化策略文件" class="headerlink" title="JPA的持久化策略文件"></a> JPA的持久化策略文件</h2><p>根据JPA规范要求，在实体bean应用中，需要在应用类路径(classpath)的META-INF目录下加入持久化配置文件——persistence.xml，该文件就是持久化策略文件。其内容如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">persistence</span> <span class="attr">version</span>=<span class="string">&quot;1.0&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://java.sun.com/xml/ns/persistence&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">persistence-unit</span> <span class="attr">name</span>=<span class="string">&quot;持久化单元名&quot;</span> <span class="attr">transaction-type</span>=<span class="string">&quot;JTA&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">jta-data-source</span>&gt;</span>使用JCA部署在javaEE服务器上的数据源JNDI<span class="tag">&lt;/<span class="name">jta-data-source</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--指定JPA实现提供者，不指定就采用JavaEE服务器默认的JPA提供者，这里以OpenJPA为例--&gt;</span>	<span class="tag">&lt;<span class="name">provider</span>&gt;</span>org.apache.openjpa.persistence.PersistenceProviderImpl<span class="tag">&lt;/<span class="name">provider</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">class</span>&gt;</span>实体bean全路径名<span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line">		……</span><br><span class="line">		<span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--配置JPA实现提供者的一些信息--&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">persistence-unit</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">persistence</span>&gt;</span></span><br></pre></td></tr></table></figure><p>注意：可以在持久化策略文件中配置多个持久化单元persistence-unit，在使用分布式数据库时经常配置多个持久化单元。</p><h2 id="实体Bean的开发："><span class="post-title-index">3.</span><a href="#实体Bean的开发：" class="headerlink" title="实体Bean的开发："></a> 实体Bean的开发：</h2><p>JPA规范中定义的实体bean开发的基本规范：<br>(1)在实体bean上添加”@Entity”注解，标识该bean为实体bean。<br>(2)实体bean必须序列化。<br>(3)使用”@Table(name=数据库表名)”注解，标识该实体bean映射到关系型数据库中的表名，如果不指定则JPA实现会自动生成默认的表名称。<br>(4)必须有一个使用”@Id”注解标识的主键，如指定自增主键的写法为：</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@Id</span></span><br><span class="line"><span class="variable">@Column</span>(name=”列名”)</span><br><span class="line"><span class="variable">@GeneratedValue</span>(Strategy=GenerationType.Auto)</span><br><span class="line">private int id;</span><br></pre></td></tr></table></figure><p>注意：@Id和@GeneratedValue两个注解必须同时使用，标识了注解之后，要主键的生成策略。<br>(5)Bean的其他属性使用”@Column(name=列名)”注解，指定该属性映射到数据库表中的列名，如果不指定在JPA实现会自动生成默认的列名。<br>(6)实体Bean必须严格遵循JavaBean的规范，提供无参的默认构造方法，属性提供set和get方法。<br>(7)最好重写hashcode()和equals()方法，实体bean的唯一标识是主键，因此，使用实体bean的主键来比较。</p><h2 id="实体bean的主键生成策略"><span class="post-title-index">4.</span><a href="#实体bean的主键生成策略" class="headerlink" title="实体bean的主键生成策略"></a> 实体bean的主键生成策略</h2><p>实体bean的注解生成策略使用”@GeneratedValue”注解来指定主键的生成策略，默认使用Auto自增的策略，JPA不支持Hibernate的UUID主键生成策略，若要使用Hibernate的UUID做主键方式，方法如下：<br>(1)将Hibernate.annotation jar包加入到类路径下。<br>(2)在使用”@Id”的字段上同时加入如下的注解：</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@GeneratedValue</span>(generator=”UUID主键生成策略”)</span><br><span class="line"><span class="variable">@GenericGenerator</span>(name=”UUID主键生成策略”, strategy=”uuid”)</span><br></pre></td></tr></table></figure><h2 id="JPA开发的注意事项"><span class="post-title-index">5.</span><a href="#JPA开发的注意事项" class="headerlink" title="JPA开发的注意事项"></a> JPA开发的注意事项</h2><p>JPA支持xml方式和注解方式，目前随着注解方式越来越成熟和流行，开发JPA时候，基本都只用注解方式，因此必须在JavaEE5以上版本才行，因为以前的版本没有对注解的支持。<br>和xml文件相比，java注解的优缺点：<br>优势：<br>(1)描述符减少，大大提高开发效率。<br>(2)编译期校验，错误的注解在编译期间就会报错。<br>(3)注解在java代码中，从而避免了额外的文件维护工作。<br>(4)注解被编译成java字节码，消耗的内存小，读取速度快，往往比xml配置文件解析快几个数量级，利用测试和维护。<br>缺点：<br>(1)配置信息分散，不利于集中维护管理。<br>(2)改动时涉及到了程序源代码，需要找到类的源代码才可以，而且必须通过编译这一步。相比较之下xml文件可能不需要找到类源码，同时也不需要重新编译。</p><h2 id="JPA注解的使用注意事项"><span class="post-title-index">6.</span><a href="#JPA注解的使用注意事项" class="headerlink" title="JPA注解的使用注意事项"></a> JPA注解的使用注意事项</h2><p>JPA的注解支持字段注解，也支持属性注解。<br>字段注解：直接在变量上加注解。<br>属性注解：在set/get方法上加注解。<br>注意：不管使用哪种注解方式，在一个实体类中，不能混用两种注解方式。</p><h2 id="JPA其他的常用注解"><span class="post-title-index">7.</span><a href="#JPA其他的常用注解" class="headerlink" title="JPA其他的常用注解"></a> JPA其他的常用注解</h2><p>除了@Entity、@Id、@Table、@Column、@GeneratedValue等注解以外，JPA还有以下常用的注解：<br>(1)@Temporal：主要用于标注时间类型，在javax.persistence.TemporalType枚举中定义了3种时间类型：<br>a.DATE：等同于java.sql.Date；<br>b.TIME：等同于java.sql.Time；<br>c.TIMESTAMP：等同于java.sql.Timestamp；<br>(2)@Transient：实体bean中默认所有的字段都会被映射到数据库中，如果某个属性不想被映射到数据库中，则需要对其加该注解。<br>(3)@Lob：将属性持久化为Blob或者Clob类型，为大数据类型。<br>(4)@Basic：一般可以用来控制是否进行延迟加载，用法示例：<br>延迟加载：@Basic(fetch=FetchType.Lazy)<br>非延迟加载：@Basic(fetch=FetchType.EAGER)<br>(5)@NamedQueryies和@NamedQuery：在实体Bean上定义命名查询。<br>名称查询类似于jdbc中的PrepareStatement，是在数据库中预编译的查询，可以大大提高查询效率，用法如下：</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@NamedQueries</span>(&#123;</span><br><span class="line">       <span class="variable">@NamedQuery</span>(name=”命名查询名字”,query=JPQL查询语句),</span><br><span class="line">       ……</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>(6)@OneToOne：<br>一对一映射注解，双向的一对一关系需要在关系维护端(owner side)的@OneToOne注解中添加mappedBy属性，建表时在关系被维护端(inverse side)建立外键指向关系维护端的主键列。<br>用法：@OneToOne(optional=true,casecade=CasecadeType.ALL,mappedBy=”被维护端外键”)<br>(7)@OneToMany：<br>一对多映射注解，双向一对多关系中，一端是关系维护端(owner side)，只能在一端添加mapped属性。多端是关系被维护端(inverse side)。建表时在关系被维护端(多端)建立外键指向关系维护端(一端)的主键列。<br>用法：@OneToMany(mappedBy = “维护端(一端)主键”, cascade=CascadeType.ALL)<br>注意：在Hibernate中有个术语叫做维护关系反转，即由对方维护关联关系，使用inverse=false来表示关系维护放，在JPA的注解中，mappedBy就相当于inverse=false，即由mappedBy来维护关系。<br>(8)@ManyToOne：<br>多对一映射注解，在双向的一对多关系中，一端一方使用@OneToMany注解，多端的一方使用@ManyToOne注解。多对一注解用法很简单，它不用维护关系。<br>用法：@ManyToOne(optional = false, fetch = FetchType.EAGER)<br>(9)@ManyToMany：<br>多对多映射，采取中间表连接的映射策略，建立的中间关系表分别引入两边的主键作为外键，形成两个多对一关系。双向的多对多关系中，在关系维护端(owner side)的@ManyToMany注解中添加mappedBy属性，另一方是关系的被维护端(inverse side)，关系的被维护端不能加mappedBy属性，建表时，根据两个多端的主键生成一个中间表，中间表的外键是两个多端的主键。<br>用法：关系维护端——&gt;@ManyToMany(mappedBy=”另一方的关系引用属性”)<br>关系被维护端——&gt;@ManyToMany(cascade=CascadeType.ALL ,fetch = FetchType.Lazy)</p><h2 id="JPA的一对一关联映射"><span class="post-title-index">8.</span><a href="#JPA的一对一关联映射" class="headerlink" title="JPA的一对一关联映射"></a> JPA的一对一关联映射</h2><p>在JPA中两个实体之间是一一对应的关系称为一对一关联关系映射，如人和身份证号关系。<br>(1)一对一单向关联映射：<br>只能从映射端查找到随关联的一方，而不能反向查找。<br>在关联映射方关联属性上添加@OneToOne注解。<br>(2)一对一双向关联映射：<br>可以双向查找关联关系的实体。<br>关系维护端：在关联属性或字段上添加@OneToOne注解，同时制定@OneToOne注解的mappedBy属性。<br>关系被维护端：在关联属性或字段上添加@OneToOne注解。</p><h2 id="一对一关联映射两种策略"><span class="post-title-index">9.</span><a href="#一对一关联映射两种策略" class="headerlink" title="一对一关联映射两种策略"></a> 一对一关联映射两种策略</h2><p>(1)一对一主键关联：<br>一对一关联映射中，主键关联策略不会在两个关联实体对应的数据库表中添加外键字段，两个实体的表公用同一个主键(主键相同)，其中一个实体的主键既是主键又是外键。<br>主键关联映射：在实体关联属性或方法上添加@OneToOne注解的同时添加@PrimaryKeyJoinColumn注解(在一对一注解关联映射的任意一端实体添加即可)。<br>(2)一对一唯一外键关联：<br>一对一关联关系映射中，唯一外键关联策略会在其中一个实体对应数据库表中添加外键字段指向另一个实体表的主键，也是一对一映射关系中最常用的映射策略。<br>唯一外键关联：在关联属性或字段上添加@OneToOne注解的同时添加@JoinColumn(name=”数据表列名”，unique=true)注解。</p><h2 id="一对多关联映射"><span class="post-title-index">10.</span><a href="#一对多关联映射" class="headerlink" title="一对多关联映射"></a> 一对多关联映射</h2><p>在JPA中两个实体之间是一对多关系的称为一对多关联关系映射，如班级和学生关系。<br>(1)一对多单向关联映射：<br>在一对多单向关联映射中，JPA会在数据库中自动生成公有的中间表记录关联关系的情况。<br>在一端关联集合属性或字段上添加@OneToMany注解即可。<br>(2)一对多双向关联映射：<br>在一对多双向关联映射中，JPA不会在数据库中生成公有中间表。<br>在一端关联集合属性或字段上添加@OneToMany注解，同时指定其mappedBy属性。<br>在多端关联属性或字段上添加@ManyToOne注解。<br>注意：一对多关系映射中，mappedBy只能添加在OneToMany注解中，即在多端生成外键。</p><h2 id="多对多关联映射"><span class="post-title-index">11.</span><a href="#多对多关联映射" class="headerlink" title="多对多关联映射"></a> 多对多关联映射</h2><p>在JPA中两个实体之间是多对多关系的称为多对多关联关系映射，如学生和教师关系。<br>(1)多对多单向映射：<br>在其中任意实体一方关联属性或字段上添加@ManyToMany注解。<br>(2)多对多双向映射：<br>关系维护端关联属性或字段上添加@ManyToMany注解，同时指定该注解的mappedBy属性。<br>关系被维护端关联属性或字段上添加@ManyToMany注解。</p><h2 id="JPA中实体继承映射策略"><span class="post-title-index">12.</span><a href="#JPA中实体继承映射策略" class="headerlink" title="JPA中实体继承映射策略"></a> JPA中实体继承映射策略</h2><p>在JPA中，实体继承关系的映射策略共有三种：单表继承策略、Joined策略和Table_PER_Class策略。<br>(1)单表继承策略：<br>单表继承策略，父类实体和子类实体共用一张数据库表，在表中通过一列辨别字段来区别不同类别的实体。具体做法如下：<br>a.在父类实体的@Entity注解下添加如下的注解：</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@Inheritance</span>(Strategy=InheritanceType.SINGLE_TABLE)</span><br><span class="line"><span class="variable">@DiscriminatorColumn</span>(name=”辨别字段列名”)</span><br><span class="line"><span class="variable">@DiscriminatorValue</span>(父类实体辨别字段列值)</span><br></pre></td></tr></table></figure><p>b.在子类实体的@Entity注解下添加如下的注解：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@DiscriminatorValue(子类实体辨别字段列值)</span></span><br></pre></td></tr></table></figure><p>(2)Joined策略：<br>Joined策略，父类实体和子类实体分别对应数据库中不同的表，子类实体的表中只存在其扩展的特殊属性，父类的公共属性保存在父类实体映射表中。具体做法：<br>只需在父类实体的@Entity注解下添加如下注解：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Inheritance(Strategy=InheritanceType.JOINED)</span></span><br></pre></td></tr></table></figure><p>子类实体不需要特殊说明。<br>(3)Table_PER_Class策略：<br>Table_PER_Class策略，父类实体和子类实体每个类分别对应一张数据库中的表，子类表中保存所有属性，包括从父类实体中继承的属性。具体做法：<br>只需在父类实体的@Entity注解下添加如下注解：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Inheritance(Strategy=InheritanceType.TABLE_PER_CLASS)</span></span><br></pre></td></tr></table></figure><p>子类实体不需要特殊说明。</p><h2 id="参考文档"><span class="post-title-index">13.</span><a href="#参考文档" class="headerlink" title="参考文档"></a> 参考文档</h2><p>JPA学习笔记1——JPA基础<br><a target="_blank" rel="noopener" href="http://blog.csdn.net/chjttony/article/details/6086298">http://blog.csdn.net/chjttony/article/details/6086298</a></p><p>JPA学习笔记2——JPA高级<br><a target="_blank" rel="noopener" href="http://blog.csdn.net/chjttony/article/details/6086305">http://blog.csdn.net/chjttony/article/details/6086305</a></p><p>JPA学习笔记<br><a target="_blank" rel="noopener" href="http://www.blogjava.net/luyongfa/archive/390572.html">http://www.blogjava.net/luyongfa/archive/390572.html</a></p></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 好好学习的郝</li><li class="post-copyright-link"> <strong>原文链接：</strong> <a href="https://www.voidking.com/dev-jpa-base/" title="JPA基础">https://www.voidking.com/dev-jpa-base/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本文采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议，转载请注明出处！源站会即时更新知识点并修正错误，欢迎访问~</li><li> <img width="200" height="200" src="/images/avatar.jpg"><p style="text-align:center;margin-bottom:0">微信公众号同步更新，欢迎关注~</p></li></ul></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/java/" rel="tag"># java</a> <a href="/tags/eclipse/" rel="tag"># eclipse</a> <a href="/tags/jpa/" rel="tag"># jpa</a></div><div class="post-nav"><div class="post-nav-item"><a href="/essay-dianping-geek/" rel="prev" title="大众点评极客大赛"><i class="fa fa-chevron-left"></i> 大众点评极客大赛</a></div><div class="post-nav-item"> <a href="/dev-spring-jpa/" rel="next" title="Spring JPA">Spring JPA<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><div class="footer-ads" style="margin-top:10px"><ins class="adsbygoogle" style="display:block" data-ad-format="autorelaxed" data-ad-client="ca-pub-3284447971731414" data-ad-slot="9697986181"></ins><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3284447971731414" crossorigin="anonymous"></script><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div class="comments" id="gitalk-container"></div><script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E4%BB%8B"><span class="nav-text">1. 简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JPA%E7%9A%84%E6%8C%81%E4%B9%85%E5%8C%96%E7%AD%96%E7%95%A5%E6%96%87%E4%BB%B6"><span class="nav-text">2. JPA的持久化策略文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E4%BD%93Bean%E7%9A%84%E5%BC%80%E5%8F%91%EF%BC%9A"><span class="nav-text">3. 实体Bean的开发：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E4%BD%93bean%E7%9A%84%E4%B8%BB%E9%94%AE%E7%94%9F%E6%88%90%E7%AD%96%E7%95%A5"><span class="nav-text">4. 实体bean的主键生成策略</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JPA%E5%BC%80%E5%8F%91%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="nav-text">5. JPA开发的注意事项</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JPA%E6%B3%A8%E8%A7%A3%E7%9A%84%E4%BD%BF%E7%94%A8%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="nav-text">6. JPA注解的使用注意事项</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JPA%E5%85%B6%E4%BB%96%E7%9A%84%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3"><span class="nav-text">7. JPA其他的常用注解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JPA%E7%9A%84%E4%B8%80%E5%AF%B9%E4%B8%80%E5%85%B3%E8%81%94%E6%98%A0%E5%B0%84"><span class="nav-text">8. JPA的一对一关联映射</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E5%AF%B9%E4%B8%80%E5%85%B3%E8%81%94%E6%98%A0%E5%B0%84%E4%B8%A4%E7%A7%8D%E7%AD%96%E7%95%A5"><span class="nav-text">9. 一对一关联映射两种策略</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E5%AF%B9%E5%A4%9A%E5%85%B3%E8%81%94%E6%98%A0%E5%B0%84"><span class="nav-text">10. 一对多关联映射</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%9A%E5%AF%B9%E5%A4%9A%E5%85%B3%E8%81%94%E6%98%A0%E5%B0%84"><span class="nav-text">11. 多对多关联映射</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JPA%E4%B8%AD%E5%AE%9E%E4%BD%93%E7%BB%A7%E6%89%BF%E6%98%A0%E5%B0%84%E7%AD%96%E7%95%A5"><span class="nav-text">12. JPA中实体继承映射策略</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3"><span class="nav-text">13. 参考文档</span></a></li></ol></div></div><div class="sidecar-ads" style="margin-top:10px"><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="好好学习的郝" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">好好学习的郝</p><div class="site-description" itemprop="description">一个计算机技术爱好者与学习者</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">710</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">31</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">253</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:voidking@qq.com" title="E-Mail → mailto:voidking@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://github.com/voidking" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="http://weibo.com/voidking" title="Weibo → http:&#x2F;&#x2F;weibo.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i> Weibo</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/voidking" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-quora"></i> Zhihu</a></span></div></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2014 – <span itemprop="copyrightYear">2024</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">好好学习的郝</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="footer-beian"> <a href="http://beian.miit.gov.cn/" target="_blank">苏ICP备14021030号</a>&nbsp;|&nbsp; <img src="/images/beian.png" alt=""> <a target="_blank" href="http://www.beian.gov.cn/">苏公网安备 32032202000223号</a></div></div></footer></div><script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.css"><script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: '5a238b8c32b1e4dd2156',
      clientSecret: 'bfb5d518626f6fdc7da0351d1e0cd37ab75c6361',
      repo: 'gitalk-comments',
      owner: 'voidking',
      admin: ['voidking'],
      id: 'e36bbcf61b96a02db738abb6acdbbce8',
      title: 'JPA基础',
      body: '欢迎留言，互相交流学习~',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script></body></html>