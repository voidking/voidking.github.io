<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:new URL("https://www.voidking.com").hostname,root:"/",scheme:"Gemini",version:"7.7.1",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1,cdn:{enable:!0,url:"//qiniu.cdn.voidking.com/doc/search.xml"}},path:"search.xml",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="前言最近买了个85寸电视，就想搞个NAS。看了看价格，绿联NAS DX4600 2000左右，蜗牛星际NAS 1000左右，硬盘还需要另外购买。贫穷，让我想到了废弃已久的华为荣耀笔记本电脑。要不然，用它作为NAS？还可以作为软路由？还可以部署Nginx、Jupyter、ChatGPT代理等常用服务，还可以参考 Awesome-Selfhosted 部署更多有趣的项目，想想还挺不错。搞起来！"><meta property="og:type" content="article"><meta property="og:title" content="个人电脑作为Ubuntu服务器"><meta property="og:url" content="https://www.voidking.com/dev-pc-as-ubuntu-server/index.html"><meta property="og:site_name" content="好好学习的郝"><meta property="og:description" content="前言最近买了个85寸电视，就想搞个NAS。看了看价格，绿联NAS DX4600 2000左右，蜗牛星际NAS 1000左右，硬盘还需要另外购买。贫穷，让我想到了废弃已久的华为荣耀笔记本电脑。要不然，用它作为NAS？还可以作为软路由？还可以部署Nginx、Jupyter、ChatGPT代理等常用服务，还可以参考 Awesome-Selfhosted 部署更多有趣的项目，想想还挺不错。搞起来！"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2023-12-02T08:00:00.000Z"><meta property="article:modified_time" content="2024-01-06T08:00:00.000Z"><meta property="article:author" content="好好学习的郝"><meta property="article:tag" content="docker"><meta property="article:tag" content="linux"><meta property="article:tag" content="ubuntu"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://www.voidking.com/dev-pc-as-ubuntu-server/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0}</script><title>个人电脑作为Ubuntu服务器 | 好好学习的郝</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?b759ac2a7fa45129e3ef060bf68259f0";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="好好学习的郝" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">好好学习的郝</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">一个计算机技术爱好者与学习者</h1></div><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/voidking" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.voidking.com/dev-pc-as-ubuntu-server/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="好好学习的郝"><meta itemprop="description" content="一个计算机技术爱好者与学习者"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="好好学习的郝"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> 个人电脑作为Ubuntu服务器</h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2023-12-02 08:00:00" itemprop="dateCreated datePublished" datetime="2023-12-02T08:00:00+00:00">2023-12-02</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2024-01-06 08:00:00" itemprop="dateModified" datetime="2024-01-06T08:00:00+00:00">2024-01-06</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/" itemprop="url" rel="index"><span itemprop="name">engineering</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/devops/" itemprop="url" rel="index"><span itemprop="name">devops</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/docker/" itemprop="url" rel="index"><span itemprop="name">docker</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="前言"><span class="post-title-index">1.</span><a href="#前言" class="headerlink" title="前言"></a> 前言</h1><p>最近买了个85寸电视，就想搞个NAS。<br>看了看价格，绿联NAS DX4600 2000左右，蜗牛星际NAS 1000左右，硬盘还需要另外购买。贫穷，让我想到了废弃已久的华为荣耀笔记本电脑。<br>要不然，用它作为NAS？还可以作为软路由？还可以部署Nginx、Jupyter、ChatGPT代理等常用服务，还可以参考 <a target="_blank" rel="noopener" href="https://github.com/awesome-selfhosted/awesome-selfhosted">Awesome-Selfhosted</a> 部署更多有趣的项目，想想还挺不错。搞起来！</p><span id="more"></span><h1 id="NAS与软路由简介"><span class="post-title-index">2.</span><a href="#NAS与软路由简介" class="headerlink" title="NAS与软路由简介"></a> NAS与软路由简介</h1><blockquote><p>NAS，全称为网络附属存储(Network Attached Storage)，是一种专门的网络存储设备。NAS 设备通过网络直接连接到其他设备，用户可以随时随地通过网络存取NAS中的数据。<br>NAS设备的主要功能是提供数据存储和备份，同时还可能有流媒体服务、打印服务等其他功能。NAS设备可用于家庭和企业，帮助实现数据共享和存储管理，特别在企业场景下，NAS可以优化数据备份、共享和远程访问等业务流程。</p></blockquote><blockquote><p>软路由是指使用普通计算机和路由软件实现的具有路由功能的设备。与一般的硬件路由器不同，软路由器可以运行在商用操作系统上，并由用户自定义和配置，以满足特定网络环境和应用的需求。软路由可以提供诸如路由转发、防火墙、VPN、流量管理等多种功能。</p></blockquote><p>NAS和软路由一体化设备，就是同时实现网络路由和数据存储功能的设备。它既能提供网络路由和防火墙等网络服务，又能提供文件共享和数据备份等存储服务。以下是几种常见的一体化方案：</p><ul><li>在通用Linux系统中安装NAS软件和路由软件。通用Linux系统中（如Ubuntu、CentOS），安装NAS软件来实现存储功能，安装路由软件来实现路由功能。</li><li>在NAS系统中安装路由软件。NAS系统中（如FreeNAS、OpenMediaVault），安装路由软件来实现路由功能。</li><li>在软路由系统中安装NAS软件。软路由系统中（如OpenWrt、pfSense、OPNsense），安装NAS软件来实现存储功能。</li><li>虚拟化技术。在主机上创建两个虚拟机，分别安装软路由系统和NAS系统；或者使用Docker，运行软路由系统和NAS系统。</li><li>商业一体化设备。一些厂商推出了一体化的软路由NAS设备，如华硕的RT-AC86U、群晖的DS216j等。这些设备可以同时实现软路由和NAS的功能，方便用户快速搭建家庭网络。</li></ul><p>参考文档：</p><ul><li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/592292837">软路由/NAS - All in one(非虚拟化)方案</a></li><li><a target="_blank" rel="noopener" href="https://nas.xiaosiseo.com/post/12295.html">软路由NAS一体方案：打造智能物联网家庭网络</a></li><li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/411161467">NFS、FTP、SMB、WebDav、DLNA协议，傻傻分不清？</a></li><li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/104639279">从听说到上手，人人都能看懂的软路由入门指南</a></li><li><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/OpenWrt">Wikipedia - OpenWrt</a></li></ul><h1 id="安装Ubuntu系统"><span class="post-title-index">3.</span><a href="#安装Ubuntu系统" class="headerlink" title="安装Ubuntu系统"></a> 安装Ubuntu系统</h1><p>参考文档：<a target="_blank" rel="noopener" href="https://ubuntu.com/tutorials/create-a-usb-stick-on-macos#1-overview">Create a bootable USB stick on macOS</a></p><p>1、服务器系统选择 <a target="_blank" rel="noopener" href="https://releases.ubuntu.com/18.04.6/">ubuntu-18.04.6-desktop-amd64.iso</a><br>之所以选择desktop版，是因为desktop版是图形化界面，初始化配置很方便。后期不想要desktop的话，可以卸载掉。</p><p>2、使用<a target="_blank" rel="noopener" href="https://etcher.balena.io/">balenaEtcher</a>制作一个U盘启动盘</p><p>3、笔记本插入U盘，开机选择从U盘启动</p><p>4、根据提示安装Ubuntu系统</p><p>系统分区时注意事项：</p><ul><li>建议手动进行分区，<code>New Partition Table</code>，如果分错了就<code>Revert</code>重新搞。</li><li>32MB给 <code>bios</code>，格式reserved bios boot area</li><li>500MB给 <code>efi</code>，格式efi</li><li>2GB 给 <code>/boot</code>，格式ext4</li><li>其余空间给 <code>/</code>，格式ext4</li></ul><p>在现代电脑系统（使用UEFI模式）中，电脑首先引导到EFI分区，EFI分区中的UEFI启动加载器，接着加载/boot分区中的操作系统内核，然后操作系统开始运行。</p><p>参考文档：</p><ul><li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/569347838">如何安装 Ubuntu 22.04 LTS 桌面版 (图文教程)</a></li><li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/146e39f6178d">Ubuntu22.04安装时手动分区</a></li><li><a target="_blank" rel="noopener" href="https://baijiahao.baidu.com/s?id=1773827057913424371&wfr=spider&for=pc">XFS vs. EXT4：哪个更适合你的应用场景？</a></li></ul><h1 id="初始化Ubuntu系统"><span class="post-title-index">4.</span><a href="#初始化Ubuntu系统" class="headerlink" title="初始化Ubuntu系统"></a> 初始化Ubuntu系统</h1><h2 id="配置固定IP"><span class="post-title-index">4.1.</span><a href="#配置固定IP" class="headerlink" title="配置固定IP"></a> 配置固定IP</h2><p>图形界面配置。</p><p>或者参考<a href="https://www.voidking.com/dev-ubuntu18-static-ip/">《Ubuntu18配置静态IP》</a>，使用命令行配置。</p><h2 id="配置合上屏幕不休眠"><span class="post-title-index">4.2.</span><a href="#配置合上屏幕不休眠" class="headerlink" title="配置合上屏幕不休眠"></a> 配置合上屏幕不休眠</h2><p>1、编辑logind配置</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/systemd/logind.conf</span><br></pre></td></tr></table></figure><p>修改其中的配置为：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HandleLidSwitch=ignore</span><br></pre></td></tr></table></figure><p>HandleLidSwitch是指笔记本屏幕合起来，设置为ignore，也就是笔记本屏幕合起来时不进行任何改变。</p><p>2、重启 systemd-logind</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart systemd-logind</span><br></pre></td></tr></table></figure><h1 id="安装配置Samba"><span class="post-title-index">5.</span><a href="#安装配置Samba" class="headerlink" title="安装配置Samba"></a> 安装配置Samba</h1><h2 id="安装Samba"><span class="post-title-index">5.1.</span><a href="#安装Samba" class="headerlink" title="安装Samba"></a> 安装Samba</h2><p>1、安装Samba</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install samba</span><br></pre></td></tr></table></figure><p>2、查看Samba服务状态</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl status nmbd</span><br></pre></td></tr></table></figure><h2 id="配置Samba"><span class="post-title-index">5.2.</span><a href="#配置Samba" class="headerlink" title="配置Samba"></a> 配置Samba</h2><p>1、创建共享目录并设置权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /data/samba/video</span><br><span class="line"><span class="built_in">chgrp</span> sambashare /data/samba</span><br><span class="line"><span class="built_in">chgrp</span> sambashare /data/samba/video</span><br><span class="line"><span class="built_in">chmod</span> 2770 /data/samba/video</span><br></pre></td></tr></table></figure><p>用户组sambashare是在安装Samba过程中自动创建的。</p><p>3、创建samba用户并授权</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">useradd -m -s /usr/sbin/nologin -G sambashare samba</span><br><span class="line">smbpasswd -a samba</span><br></pre></td></tr></table></figure><p>Samba权限控制使用Linux用户和组的权限系统，但具有自己的身份验证机制，与标准Linux身份验证分开。</p><p>4、配置共享目录和用户<br>编辑samba配置文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/samba/smb.conf</span><br></pre></td></tr></table></figure><p>在文件最后添加：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[video]</span><br><span class="line">    path = /data/samba/video</span><br><span class="line">    browseable = yes</span><br><span class="line">    read only = no</span><br><span class="line">    force create mode = 0660</span><br><span class="line">    force directory mode = 2770</span><br><span class="line">    valid users = @sambashare @sadmin</span><br><span class="line"></span><br><span class="line">#[doc]</span><br><span class="line">#    path = /data/samba/doc</span><br><span class="line">#    browseable = no</span><br><span class="line">#    read only = yes</span><br><span class="line">#    force create mode = 0660</span><br><span class="line">#    force directory mode = 2770</span><br><span class="line">#    valid users = samba @sambashare</span><br></pre></td></tr></table></figure><p>配置说明：</p><ul><li><code>[video]</code> 和 <code>[doc]</code> 表示登录时使用的共享名称。</li><li><code>path</code> 表示共享的目录。</li><li><code>browseable</code> 表示可浏览，是否可在共享列表中列出此共享。如果设置为no，其他用户将看不到共享目录。</li><li><code>read only</code> 表示valid users列表中指定的用户是否设置仅允许读，如果值yes，则仅允许读。</li><li><code>force create mode</code> 表示此共享创建文件时设置的文件权限模式。</li><li><code>force directory mode</code> 表示此共享创建目录时设置目录权限的模式。</li><li><code>valid users</code> 表示允许访问共享的用户和组的列表。群组以<code>@</code>符号为前缀。</li></ul><p>更多配置选项，请参考文档 <a target="_blank" rel="noopener" href="https://www.samba.org/samba/docs/current/man-html/smb.conf.5.html">smb.conf — The configuration file for the Samba suite</a></p><p>5、重启samba</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart nmbd</span><br><span class="line">systemctl status nmbd</span><br></pre></td></tr></table></figure><h2 id="测试使用Samba"><span class="post-title-index">5.3.</span><a href="#测试使用Samba" class="headerlink" title="测试使用Samba"></a> 测试使用Samba</h2><p>1、安装 samba client</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install smbclient</span><br></pre></td></tr></table></figure><p>2、创建测试文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">touch</span> test.txt</span><br></pre></td></tr></table></figure><p>3、连接samba server</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbclient //192.168.5.233/users -U samba</span><br></pre></td></tr></table></figure><p>4、上传下载文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">smb: \&gt; <span class="built_in">ls</span></span><br><span class="line">smb: \&gt; put test.txt test.txt</span><br><span class="line">smb: \&gt; get test.txt test2.txt</span><br><span class="line">smb: \&gt; <span class="built_in">exit</span></span><br></pre></td></tr></table></figure><p>下载文件时，还可以使用smbget工具</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbget -U samba smb://192.168.5.233/video/test.txt -o test3.txt</span><br></pre></td></tr></table></figure><h2 id="配置防火墙"><span class="post-title-index">5.4.</span><a href="#配置防火墙" class="headerlink" title="配置防火墙"></a> 配置防火墙</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ufw allow <span class="string">&#x27;Samba&#x27;</span></span><br></pre></td></tr></table></figure><h1 id="本地挂载阿里云盘"><span class="post-title-index">6.</span><a href="#本地挂载阿里云盘" class="headerlink" title="本地挂载阿里云盘"></a> 本地挂载阿里云盘</h1><h2 id="安装Docker"><span class="post-title-index">6.1.</span><a href="#安装Docker" class="headerlink" title="安装Docker"></a> 安装Docker</h2><p>参考文档：<a href="https://www.voidking.com/dev-docker-start/">《Docker入门篇》</a></p><h2 id="获取阿里云盘refresh-token"><span class="post-title-index">6.2.</span><a href="#获取阿里云盘refresh-token" class="headerlink" title="获取阿里云盘refresh token"></a> 获取阿里云盘refresh token</h2><p>参考文档<a target="_blank" rel="noopener" href="https://hub.docker.com/r/messense/aliyundrive-webdav">dockerhub - messense/aliyundrive-webdav</a>，<a target="_blank" rel="noopener" href="https://messense-aliyundrive-webdav-backendrefresh-token-ucs0wn.streamlit.app/">通过在线工具获取 refresh token</a>。</p><p>以前通过浏览器自行获取refresh token的方法已失效，详情参考 <a target="_blank" rel="noopener" href="https://github.com/messense/aliyundrive-webdav/discussions/900">Error: Invalid refresh token value found in –refresh-token argument</a>。</p><h2 id="启动阿里云盘webdav容器"><span class="post-title-index">6.3.</span><a href="#启动阿里云盘webdav容器" class="headerlink" title="启动阿里云盘webdav容器"></a> 启动阿里云盘webdav容器</h2><p>1、拉取webdav镜像</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull messense/aliyundrive-webdav:2.3.3</span><br></pre></td></tr></table></figure><p>2、启动webdav容器（本地文件服务器）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name=aliyundrive-webdav \</span><br><span class="line">  --restart=unless-stopped \</span><br><span class="line">  -p 8080:8080 \</span><br><span class="line">  -e REFRESH_TOKEN=<span class="string">&#x27;your token&#x27;</span> \</span><br><span class="line">  -e WEBDAV_AUTH_USER=admin \</span><br><span class="line">  -e WEBDAV_AUTH_PASSWORD=admin\</span><br><span class="line">  messense/aliyundrive-webdav:2.3.3</span><br></pre></td></tr></table></figure><p>3、查看webdav容器状态</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker ps</span><br><span class="line">docker logs aliyundrive-webdav</span><br></pre></td></tr></table></figure><h2 id="挂载阿里云盘"><span class="post-title-index">6.4.</span><a href="#挂载阿里云盘" class="headerlink" title="挂载阿里云盘"></a> 挂载阿里云盘</h2><p>1、安装webdav驱动</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install -y davfs2</span><br></pre></td></tr></table></figure><p>2、创建挂载目录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /data/aliyundrive</span><br></pre></td></tr></table></figure><p>3、挂载阿里云盘</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -t davfs http://192.168.5.233:8080/ /data/aliyundrive</span><br></pre></td></tr></table></figure><p>4、查看挂载</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /data/aliyundrive</span><br><span class="line"><span class="built_in">ls</span> -l</span><br></pre></td></tr></table></figure><h2 id="通过samba共享"><span class="post-title-index">6.5.</span><a href="#通过samba共享" class="headerlink" title="通过samba共享"></a> 通过samba共享</h2><p>本地目录挂载阿里云盘后，和其他普通目录一样，也可以通过samba共享给其他主机。<br>samba配置如下：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[aliyundrive]</span><br><span class="line">    path = /data/aliyundrive</span><br><span class="line">    browseable = yes</span><br><span class="line">    read only = yes</span><br><span class="line">    valid users = @sambashare @sadmin</span><br></pre></td></tr></table></figure><h2 id="拷贝阿里云盘中的文件到本地"><span class="post-title-index">6.6.</span><a href="#拷贝阿里云盘中的文件到本地" class="headerlink" title="拷贝阿里云盘中的文件到本地"></a> 拷贝阿里云盘中的文件到本地</h2><p>如果担心访问阿里云盘时候的网络不稳定，可以把一部分文件下载到本地磁盘。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">screen rsync -P -azv <span class="string">&#x27;爱情公寓&#x27;</span> /data/samba/video</span><br></pre></td></tr></table></figure><p>下载速度很快，家庭千兆宽带大概平均 10MB/s，峰值 30MB/s。</p></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 好好学习的郝</li><li class="post-copyright-link"> <strong>原文链接：</strong> <a href="https://www.voidking.com/dev-pc-as-ubuntu-server/" title="个人电脑作为Ubuntu服务器">https://www.voidking.com/dev-pc-as-ubuntu-server/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本文采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议，转载请注明出处！源站会即时更新知识点并修正错误，欢迎访问~</li><li> <img width="200" height="200" src="/images/avatar.jpg"><p style="text-align:center;margin-bottom:0">微信公众号同步更新，欢迎关注~</p></li></ul></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/docker/" rel="tag"># docker</a> <a href="/tags/linux/" rel="tag"># linux</a> <a href="/tags/ubuntu/" rel="tag"># ubuntu</a></div><div class="post-nav"><div class="post-nav-item"><a href="/dev-centos-rescue-mode/" rel="prev" title="CentOS救援模式使用说明"><i class="fa fa-chevron-left"></i> CentOS救援模式使用说明</a></div><div class="post-nav-item"> <a href="/dev-docker-qinglong/" rel="next" title="好好学Docker：使用Docker安装配置青龙面板">好好学Docker：使用Docker安装配置青龙面板<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><div class="footer-ads" style="margin-top:10px"><ins class="adsbygoogle" style="display:block" data-ad-format="autorelaxed" data-ad-client="ca-pub-3284447971731414" data-ad-slot="9697986181"></ins><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3284447971731414" crossorigin="anonymous"></script><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div class="comments" id="gitalk-container"></div><script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-text">1. 前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#NAS%E4%B8%8E%E8%BD%AF%E8%B7%AF%E7%94%B1%E7%AE%80%E4%BB%8B"><span class="nav-text">2. NAS与软路由简介</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%89%E8%A3%85Ubuntu%E7%B3%BB%E7%BB%9F"><span class="nav-text">3. 安装Ubuntu系统</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96Ubuntu%E7%B3%BB%E7%BB%9F"><span class="nav-text">4. 初始化Ubuntu系统</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E5%9B%BA%E5%AE%9AIP"><span class="nav-text">4.1. 配置固定IP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E5%90%88%E4%B8%8A%E5%B1%8F%E5%B9%95%E4%B8%8D%E4%BC%91%E7%9C%A0"><span class="nav-text">4.2. 配置合上屏幕不休眠</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AESamba"><span class="nav-text">5. 安装配置Samba</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85Samba"><span class="nav-text">5.1. 安装Samba</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AESamba"><span class="nav-text">5.2. 配置Samba</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95%E4%BD%BF%E7%94%A8Samba"><span class="nav-text">5.3. 测试使用Samba</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E9%98%B2%E7%81%AB%E5%A2%99"><span class="nav-text">5.4. 配置防火墙</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%9C%AC%E5%9C%B0%E6%8C%82%E8%BD%BD%E9%98%BF%E9%87%8C%E4%BA%91%E7%9B%98"><span class="nav-text">6. 本地挂载阿里云盘</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85Docker"><span class="nav-text">6.1. 安装Docker</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E9%98%BF%E9%87%8C%E4%BA%91%E7%9B%98refresh-token"><span class="nav-text">6.2. 获取阿里云盘refresh token</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8%E9%98%BF%E9%87%8C%E4%BA%91%E7%9B%98webdav%E5%AE%B9%E5%99%A8"><span class="nav-text">6.3. 启动阿里云盘webdav容器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8C%82%E8%BD%BD%E9%98%BF%E9%87%8C%E4%BA%91%E7%9B%98"><span class="nav-text">6.4. 挂载阿里云盘</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%9A%E8%BF%87samba%E5%85%B1%E4%BA%AB"><span class="nav-text">6.5. 通过samba共享</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8B%B7%E8%B4%9D%E9%98%BF%E9%87%8C%E4%BA%91%E7%9B%98%E4%B8%AD%E7%9A%84%E6%96%87%E4%BB%B6%E5%88%B0%E6%9C%AC%E5%9C%B0"><span class="nav-text">6.6. 拷贝阿里云盘中的文件到本地</span></a></li></ol></li></ol></div></div><div class="sidecar-ads" style="margin-top:10px"><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="好好学习的郝" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">好好学习的郝</p><div class="site-description" itemprop="description">一个计算机技术爱好者与学习者</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">700</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">31</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">256</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:voidking@qq.com" title="E-Mail → mailto:voidking@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://github.com/voidking" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="http://weibo.com/voidking" title="Weibo → http:&#x2F;&#x2F;weibo.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i> Weibo</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/voidking" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-quora"></i> Zhihu</a></span></div></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2014 – <span itemprop="copyrightYear">2024</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">好好学习的郝</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="footer-beian"> <a href="http://beian.miit.gov.cn/" target="_blank">苏ICP备14021030号</a>&nbsp;|&nbsp; <img src="/images/beian.png" alt=""> <a target="_blank" href="http://www.beian.gov.cn/">苏公网安备 32032202000223号</a></div></div></footer></div><script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.css"><script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: '5a238b8c32b1e4dd2156',
      clientSecret: 'bfb5d518626f6fdc7da0351d1e0cd37ab75c6361',
      repo: 'gitalk-comments',
      owner: 'voidking',
      admin: ['voidking'],
      id: 'feb485718ba17fa283cca798a097ddae',
      title: '个人电脑作为Ubuntu服务器',
      body: '欢迎留言，互相交流学习~',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script></body></html>