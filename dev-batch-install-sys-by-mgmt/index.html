<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:new URL("https://www.voidking.com").hostname,root:"/",scheme:"Gemini",version:"7.7.1",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1,cdn:{enable:!0,url:"//qiniu-cdn.voidking.com/doc/search.xml"}},path:"search.xml",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="前言《通过远程控制接口给服务器安装系统》一文中，我们发现通过远程控制接口给服务器安装系统很方便。《Ubuntu系统批量自动安装》一文中，我们学会了使用PXE技术进行系统的批量安装。 这两者结合，能产生怎样的魔力？下面是见证奇迹的时刻。 需求：机房里有40台曙光I620-G20机器需要安装Ubuntu16 Server系统，曙光供应商说需要两天的工作量，报价五千元。那么自己安装的话，需要多长时间？也"><meta property="og:type" content="article"><meta property="og:title" content="通过远程控制接口批量安装系统"><meta property="og:url" content="https://www.voidking.com/dev-batch-install-sys-by-mgmt/index.html"><meta property="og:site_name" content="好好学习的郝"><meta property="og:description" content="前言《通过远程控制接口给服务器安装系统》一文中，我们发现通过远程控制接口给服务器安装系统很方便。《Ubuntu系统批量自动安装》一文中，我们学会了使用PXE技术进行系统的批量安装。 这两者结合，能产生怎样的魔力？下面是见证奇迹的时刻。 需求：机房里有40台曙光I620-G20机器需要安装Ubuntu16 Server系统，曙光供应商说需要两天的工作量，报价五千元。那么自己安装的话，需要多长时间？也"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/syslog.jpg?imageView2/0/w/600"><meta property="og:image" content="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/menu.jpg?imageView2/0/w/700"><meta property="og:image" content="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/archive.jpg?imageView2/0/w/700"><meta property="og:image" content="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/download.jpg?imageView2/0/w/700"><meta property="og:image" content="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/archive2.jpg?imageView2/0/w/700"><meta property="og:image" content="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/hostname.jpg?imageView2/0/w/700"><meta property="og:image" content="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/start.jpg?imageView2/0/w/600"><meta property="og:image" content="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/start2.jpg?imageView2/0/w/600"><meta property="og:image" content="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/localboot.jpg?imageView2/0/w/700"><meta property="og:image" content="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/partition.jpg?imageView2/0/w/700"><meta property="og:image" content="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/network.jpg?imageView2/0/w/700"><meta property="og:image" content="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/ks.jpg?imageView2/0/w/700"><meta property="og:image" content="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/ping.jpg?imageView2/0/w/700"><meta property="og:image" content="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/staticip.jpg?imageView2/0/w/700"><meta property="og:image" content="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/netrestart.jpg?imageView2/0/w/700"><meta property="og:image" content="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/removedata.jpg?imageView2/0/w/700"><meta property="og:image" content="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/diskdetect.jpg?imageView2/0/w/700"><meta property="article:published_time" content="2019-04-15T15:00:00.000Z"><meta property="article:modified_time" content="2019-04-15T15:00:00.000Z"><meta property="article:author" content="好好学习的郝"><meta property="article:tag" content="操作系统"><meta property="article:tag" content="pxe"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/syslog.jpg?imageView2/0/w/600"><link rel="canonical" href="https://www.voidking.com/dev-batch-install-sys-by-mgmt/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0}</script><title>通过远程控制接口批量安装系统 | 好好学习的郝</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?b759ac2a7fa45129e3ef060bf68259f0";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="好好学习的郝" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">好好学习的郝</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">一个计算机技术爱好者与学习者</h1></div><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/voidking" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.voidking.com/dev-batch-install-sys-by-mgmt/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="好好学习的郝"><meta itemprop="description" content="一个计算机技术爱好者与学习者"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="好好学习的郝"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> 通过远程控制接口批量安装系统</h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-04-15 15:00:00" itemprop="dateCreated datePublished" datetime="2019-04-15T15:00:00+00:00">2019-04-15</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/" itemprop="url" rel="index"><span itemprop="name">engineering</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/uncategories/" itemprop="url" rel="index"><span itemprop="name">uncategories</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="前言"><span class="post-title-index">1.</span><a href="#前言" class="headerlink" title="前言"></a> 前言</h1><p><a href="https://www.voidking.com/dev-install-sys-by-remote-controller-interface/">《通过远程控制接口给服务器安装系统》</a>一文中，我们发现通过远程控制接口给服务器安装系统很方便。<a href="https://www.voidking.com/dev-ubuntu-auto-install/">《Ubuntu系统批量自动安装》</a>一文中，我们学会了使用PXE技术进行系统的批量安装。</p><p>这两者结合，能产生怎样的魔力？下面是见证奇迹的时刻。</p><p>需求：机房里有40台曙光I620-G20机器需要安装Ubuntu16 Server系统，曙光供应商说需要两天的工作量，报价五千元。那么自己安装的话，需要多长时间？也需要两天吗？</p><span id="more"></span><h1 id="安装步骤"><span class="post-title-index">2.</span><a href="#安装步骤" class="headerlink" title="安装步骤"></a> 安装步骤</h1><p>1、进入机房，给40台机器配置远程控制接口的IP。参考<a href="https://www.voidking.com/dev-install-sys-by-remote-controller-interface/">《通过远程控制接口给服务器安装系统》</a>的远程控制接口配置部分。</p><p>2、搭建PXE服务器。参考<a href="https://www.voidking.com/dev-ubuntu-auto-install/">《Ubuntu系统批量自动安装》</a>，并且进行改进。</p><p>3、远程控制批量安装系统。</p><h1 id="搭建PXE服务器"><span class="post-title-index">3.</span><a href="#搭建PXE服务器" class="headerlink" title="搭建PXE服务器"></a> 搭建PXE服务器</h1><h2 id="基本准备"><span class="post-title-index">3.1.</span><a href="#基本准备" class="headerlink" title="基本准备"></a> 基本准备</h2><p>1、一台服务器，已经安装好了Ubuntu16 Server版系统，IP为172.16.0.162。<br>2、更换源列表并更新，参考<a href="https://www.voidking.com/dev-ubuntu-change-sources/">《Ubuntu更换源列表》</a>。<br>3、切换到root用户，<code>sudo -i</code><br>4、开启路由转发，<code>echo 1 &gt; /proc/sys/net/ipv4/ip_forward</code>。务必开启，因为PXE服务器同时作为网关，不开启的话安装会卡住。<br>5、在PXE服务器上安装DNS服务（可选操作，没有什么影响）。</p><h2 id="DHCP和FTP"><span class="post-title-index">3.2.</span><a href="#DHCP和FTP" class="headerlink" title="DHCP和FTP"></a> DHCP和FTP</h2><p>本节主要参考<a target="_blank" rel="noopener" href="https://www.tecmint.com/install-ubuntu-via-pxe-server-using-local-dvd-sources/">How to Install Ubuntu via PXE Server Using Local DVD Sources</a>。</p><p>1、安装DHCP和FTP服务<br><code>apt-get install dnsmasq</code></p><p>2、指定DHCP网卡<br><code>ip add</code>，看到正在使用的网卡为ens2f1（172.16.0.162）。</p><p>3、配置dnsmasq<br><code>vim /etc/dnsmasq.conf</code>，在文件末尾添加：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">interface</span>=ens2f1</span><br><span class="line"><span class="attribute">dhcp-range</span>=172.16.0.163,172.16.0.254,24h</span><br><span class="line"><span class="attribute">dhcp-option</span>=3,172.16.0.162</span><br><span class="line"><span class="attribute">dhcp-option</span>=6,172.16.0.162</span><br><span class="line"><span class="attribute">dhcp-option</span>=28,172.16.0.255</span><br><span class="line"><span class="attribute">dhcp-option</span>=42,0.0.0.0</span><br><span class="line"><span class="attribute">dhcp-boot</span>=pxelinux.0,172.16.0.162</span><br><span class="line">enable-tftp</span><br><span class="line"><span class="attribute">tftp-root</span>=/tftpboot</span><br><span class="line"><span class="comment"># gateway to Internet</span></span><br><span class="line"><span class="comment">#dhcp-option=3,172.16.0.135</span></span><br><span class="line"><span class="comment"># real dns server</span></span><br><span class="line"><span class="comment">#dhcp-option=6,172.20.1.4</span></span><br><span class="line"><span class="comment">#server=8.8.4.4</span></span><br></pre></td></tr></table></figure><p>dhcp-option=3表示网关，6表示域名服务器，28表示broadcast，48表示时间服务器。server表示DNS forwarder IPs Address。</p><p>需要注意的是，网关一定要配置，否则在使用内网镜像安装时会特别慢。在获取镜像时卡住半小时，查看安装日志如下图所示；在“Updating the list of available packages”时也会卡住半小时。<br><img src="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/syslog.jpg?imageView2/0/w/600"><br>而且，最好不要让服务器连接到外网，否则安装过程中会自动从网络中获取更新，安装就会很慢。就像本文中的配置，网关和域名服务器都设置为PXE服务器的IP，而不是真实的可以访问外网的网关和域名服务器。</p><p>4、查看服务<br><code>systemctl status dnsmasq</code></p><h2 id="配置netboot"><span class="post-title-index">3.3.</span><a href="#配置netboot" class="headerlink" title="配置netboot"></a> 配置netboot</h2><p>1、下载网络启动文件，只有43M</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http:<span class="regexp">//</span>ftp.ubuntu.com<span class="regexp">/ubuntu/</span>dists<span class="regexp">/xenial/m</span>ain<span class="regexp">/installer-amd64/</span>current<span class="regexp">/images/</span>netboot/netboot.tar.gz</span><br></pre></td></tr></table></figure><p>或者从ubuntu-16.04.4-server-amd64.iso镜像中拷贝，netboot.tar.gz相当于install/netboot目录的压缩文件。</p><p>2、解压文件</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -xzvf netboot<span class="selector-class">.tar</span><span class="selector-class">.gz</span> -C /tftpboot/</span><br></pre></td></tr></table></figure><p>解压后的文件包括：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ldlinux.c32 -&gt; ubuntu-installer/amd64/boot-screens/ldlinux.c32</span><br><span class="line">pxelinux.0  -&gt; ubuntu-installer/amd64/pxelinux.0</span><br><span class="line">pxelinux.cfg -&gt; ubuntu-installer/amd64/pxelinux.cfg/</span><br><span class="line">ubuntu-installer/</span><br><span class="line">version.info</span><br></pre></td></tr></table></figure><h2 id="安装系统"><span class="post-title-index">3.4.</span><a href="#安装系统" class="headerlink" title="安装系统"></a> 安装系统</h2><p>1、远程连接需要安装系统的服务器，设置BIOS，选择从网络启动。<br><img src="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/menu.jpg?imageView2/0/w/700"></p><p>2、选择Install，正常安装系统即可，不过，系统镜像需要从外网下载。这里没有连接外网，就不再往下演示。<br><img src="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/archive.jpg?imageView2/0/w/700"><br><img src="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/download.jpg?imageView2/0/w/700"></p><p>以上，实现了从网络安装源安装Ubuntu系统。但是存在两个问题，一个问题是系统镜像需要从外网下载，浪费带宽。另一个问题是安装过程中需要不断交互，浪费时间。</p><h1 id="PXE服务器升级"><span class="post-title-index">4.</span><a href="#PXE服务器升级" class="headerlink" title="PXE服务器升级"></a> PXE服务器升级</h1><h2 id="配置内网镜像"><span class="post-title-index">4.1.</span><a href="#配置内网镜像" class="headerlink" title="配置内网镜像"></a> 配置内网镜像</h2><p>1、安装apache2<br><code>apt-get install apache2 -y</code></p><p>web根目录是 <code>/var/www/html/</code></p><p>2、测试apache2<br><code>curl 127.0.0.1</code></p><p>3、重启apache2<br><code>/etc/init.d/apache2 restart</code></p><p>4、上传ubuntu-16.04.4-server-amd64.iso到用户目录。<br><code>scp ubuntu-16.04.4-server-amd64.iso test@172.16.0.162:~</code></p><p>5、挂载ubuntu-16.04.4-server-amd64.iso到ubuntu目录。在用户目录执行：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir <span class="regexp">/var/</span>www<span class="regexp">/html/u</span>buntu</span><br><span class="line">mount ubuntu-<span class="number">16.04</span>.<span class="number">4</span>-server-amd64.iso <span class="regexp">/var/</span>www<span class="regexp">/html/u</span>buntu</span><br></pre></td></tr></table></figure><p>6、替换netboot为镜像中的netboot，否则内核版本的差异会导致安装失败。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rm -rf <span class="regexp">/tftpboot/</span>*</span><br><span class="line">cp -r <span class="regexp">/var/</span>www<span class="regexp">/html/u</span>buntu<span class="regexp">/install/</span>netboot<span class="regexp">/* /</span>tftpboot/</span><br></pre></td></tr></table></figure><p>7、再次安装系统，此时就可以从PXE服务器获取系统镜像了。<br><img src="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/archive2.jpg?imageView2/0/w/700"><br>在选择镜像界面，上拉到enter information manually，回车。<br><img src="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/hostname.jpg?imageView2/0/w/700"><br>archive hostname输入<code>172.16.0.162</code>。directory输入<code>/ubuntu</code>，注意，ubuntu后面不要有斜杠。<br>如果系统安装卡住，那么Alt+F2进入控制台，<code>tail /var/log/syslog</code>查看系统安装日志，根据日志进行排错。查看错误后Alt+F1返回图形安装界面。</p><p>8、安装完成的系统，启动后发现卡住。<br><img src="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/start.jpg?imageView2/0/w/600"><br>这时Alt+F2切换到第二个终端，就可以正常使用系统了。<br><img src="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/start2.jpg?imageView2/0/w/600"></p><h2 id="添加硬盘启动"><span class="post-title-index">4.2.</span><a href="#添加硬盘启动" class="headerlink" title="添加硬盘启动"></a> 添加硬盘启动</h2><p>系统安装完成，如果依然从网络启动的话，那么每次启动依然会进入到Installer boot menu界面，除非再次修改BIOS首选启动项。不妨在Installer boot menu界面添加一个启动项，该启动项允许从本地硬盘启动。主要参考<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=S-gz9lizD2o">Install Ubuntu 16.04 via PXE and network boot</a>。</p><p>1、编辑pxelinux.cfg文件<br><code>vim /tftpboot/pxelinux.cfg/default</code>，修改为：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># D-I config version 2.0</span></span><br><span class="line"><span class="comment"># search path for the c32 support libraries (libcom32, libutil etc.)</span></span><br><span class="line">path ubuntu-installer/amd64/boot-screens/</span><br><span class="line">include ubuntu-installer/amd64/boot-screens/menu.cfg</span><br><span class="line">default ubuntu-installer/amd64/boot-screens/vesamenu.c32</span><br><span class="line">prompt 0</span><br><span class="line"><span class="comment"># add localboot here</span></span><br><span class="line">label localboot</span><br><span class="line">    menu label Boot from Disk</span><br><span class="line">    localboot 0</span><br><span class="line"></span><br><span class="line"><span class="built_in">timeout</span> 0</span><br></pre></td></tr></table></figure><p>此外，timeout默认是0，这里可以改为60，那么6秒后会自动选择install选项。</p><p>2、再次通过网络启动，即可看到硬盘启动选项。<br><img src="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/localboot.jpg?imageView2/0/w/700"><br>选中它回车，即可启动本地硬盘上的系统。</p><h2 id="自动选择安装源"><span class="post-title-index">4.3.</span><a href="#自动选择安装源" class="headerlink" title="自动选择安装源"></a> 自动选择安装源</h2><p>以上安装，我们需要手动输入archive hostname和directory，能不能在安装过程中自动选择？当然可以。本方法主要参考<a target="_blank" rel="noopener" href="https://help.ubuntu.com/community/PXEInstallServer">PXEInstallServer</a>。</p><p>1、编辑txt.cfg<br><code>vim /tftpboot/ubuntu-installer/amd64/boot-screens/txt.cfg</code>，原内容为：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">default install</span><br><span class="line">label install</span><br><span class="line">    menu label ^Install</span><br><span class="line">    menu<span class="built_in"> default</span></span><br><span class="line"><span class="built_in"></span>    kernel ubuntu-installer/amd64/linux</span><br><span class="line">    append <span class="attribute">vga</span>=788 <span class="attribute">initrd</span>=ubuntu-installer/amd64/initrd.gz --- quiet </span><br><span class="line">label cli</span><br><span class="line">    menu label ^Command-line install</span><br><span class="line">    kernel ubuntu-installer/amd64/linux</span><br><span class="line">    append <span class="attribute">tasks</span>=standard pkgsel/language-pack-patterns= pkgsel/<span class="attribute">install-language-support</span>=<span class="literal">false</span> <span class="attribute">vga</span>=788 <span class="attribute">initrd</span>=ubuntu-installer/amd64/initrd.gz --- quiet </span><br></pre></td></tr></table></figure><p>修改为：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">default install</span><br><span class="line">label install</span><br><span class="line">        menu label ^Install</span><br><span class="line">        menu<span class="built_in"> default</span></span><br><span class="line"><span class="built_in"></span>        kernel ubuntu-installer/amd64/linux</span><br><span class="line">        append <span class="attribute">ks</span>=http://172.16.0.162/ks.cfg <span class="attribute">vga</span>=788 <span class="attribute">initrd</span>=ubuntu-installer/amd64/initrd.gz --- quiet  </span><br><span class="line">label cli</span><br><span class="line">        menu label ^Command-line install</span><br><span class="line">        kernel ubuntu-installer/amd64/linux</span><br><span class="line">        append <span class="attribute">tasks</span>=standard pkgsel/language-pack-patterns= pkgsel/<span class="attribute">install-language-support</span>=<span class="literal">false</span> <span class="attribute">vga</span>=788 <span class="attribute">initrd</span>=ubuntu-installer/amd64/initrd.gz --- quiet</span><br></pre></td></tr></table></figure><p>2、在/var/www/html目录创建ks.cfg文件，内容为：</p><figure class="highlight qml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">install</span><br><span class="line"><span class="built_in">url</span> --<span class="built_in">url</span> <span class="attribute">http</span>:<span class="comment">//172.16.0.162/ubuntu/</span></span><br></pre></td></tr></table></figure><p>3、重新安装系统，即可省去设置archive hostname的步骤。</p><h2 id="配置无人值守"><span class="post-title-index">4.4.</span><a href="#配置无人值守" class="headerlink" title="配置无人值守"></a> 配置无人值守</h2><p>既然可以自动选择安装源，那么其他交互步骤可不可以自动选择？当然可以。控制安装过程的自动交互主要有两个文件：ks.cfg和ubuntu-server.seed。</p><h3 id="ks-cfg"><span class="post-title-index">4.4.1.</span><a href="#ks-cfg" class="headerlink" title="ks.cfg"></a> ks.cfg</h3><p>1、在安装菜单添加ks.cfg和ubuntu-server.seed<br><code>vim /tftpboot/ubuntu-installer/amd64/boot-screens/txt.cfg</code>，修改为：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">default install</span><br><span class="line">label install</span><br><span class="line">    menu label ^Install</span><br><span class="line">    menu<span class="built_in"> default</span></span><br><span class="line"><span class="built_in"></span>    kernel ubuntu-installer/amd64/linux</span><br><span class="line">    append <span class="attribute">ks</span>=http://172.16.0.162/ks.cfg preseed/<span class="attribute">url</span>=http://172.16.0.162/ubuntu-server.seed <span class="attribute">vga</span>=788 <span class="attribute">initrd</span>=ubuntu-installer/amd64/initrd.gz --- quiet</span><br><span class="line">label cli</span><br><span class="line">    menu label ^Command-line install</span><br><span class="line">    kernel ubuntu-installer/amd64/linux</span><br><span class="line">    append <span class="attribute">tasks</span>=standard pkgsel/language-pack-patterns= pkgsel/<span class="attribute">install-language-support</span>=<span class="literal">false</span> <span class="attribute">vga</span>=788 <span class="attribute">initrd</span>=ubuntu-installer/amd64/initrd.gz --- quiet </span><br></pre></td></tr></table></figure><p>2、编辑/var/www/html/ks.cfg文件<br>参考<a href="https://www.voidking.com/dev-ubuntu-auto-install/">《Ubuntu系统批量自动安装》</a>一文中的ks.cfg。<br>编辑后的ks.cfg文件内容如下：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#Generated</span> by Kickstart Configurator</span><br><span class="line">#platform=AMD64 or Intel EM64T</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#System</span> language</span><br><span class="line">lang en_US</span><br><span class="line"><span class="selector-id">#Language</span> modules to install</span><br><span class="line">langsupport en_US</span><br><span class="line"><span class="selector-id">#System</span> keyboard</span><br><span class="line">keyboard us</span><br><span class="line"><span class="selector-id">#System</span> mouse</span><br><span class="line">mouse</span><br><span class="line"><span class="selector-id">#System</span> timezone</span><br><span class="line">timezone Asia/Shanghai</span><br><span class="line"><span class="selector-id">#Root</span> password</span><br><span class="line">rootpw <span class="attr">--disabled</span></span><br><span class="line"><span class="selector-id">#Initial</span> user</span><br><span class="line">user test <span class="attr">--fullname</span> <span class="string">&quot;test&quot;</span> <span class="attr">--iscrypted</span> <span class="attr">--password</span> $<span class="number">1</span><span class="variable">$AKq0i3Yu</span><span class="variable">$Tunuha7bYwq5uUV62F2nF0</span></span><br><span class="line"><span class="selector-id">#Reboot</span> after installation</span><br><span class="line">reboot</span><br><span class="line"><span class="selector-id">#Use</span> <span class="selector-tag">text</span> mode install</span><br><span class="line"><span class="selector-tag">text</span></span><br><span class="line"><span class="selector-id">#Install</span> OS instead of upgrade</span><br><span class="line">install</span><br><span class="line"><span class="selector-id">#Use</span> Web installation</span><br><span class="line">url <span class="attr">--url</span> http:<span class="comment">//172.16.0.162/ubuntu/</span></span><br><span class="line"><span class="selector-id">#System</span> bootloader configuration</span><br><span class="line">bootloader <span class="attr">--location</span>=mbr </span><br><span class="line"><span class="selector-id">#Clear</span> the Master Boot Record</span><br><span class="line">zerombr yes</span><br><span class="line"><span class="selector-id">#Partition</span> clearing information</span><br><span class="line">clearpart <span class="attr">--all</span> <span class="attr">--initlabel</span> </span><br><span class="line"><span class="selector-id">#System</span> authorization infomation</span><br><span class="line">auth  <span class="attr">--useshadow</span>  <span class="attr">--enablemd5</span> </span><br><span class="line"><span class="selector-id">#Network</span> information</span><br><span class="line">network <span class="attr">--bootproto</span>=dhcp <span class="attr">--device</span>=ens2f0</span><br><span class="line"><span class="selector-id">#Firewall</span> configuration</span><br><span class="line"><span class="selector-id">#firewall</span> <span class="attr">--disabled</span> <span class="attr">--trust</span>=ens2f0 <span class="attr">--ssh</span> </span><br><span class="line"><span class="selector-id">#Do</span> not configure the X Window System</span><br><span class="line">skipx</span><br></pre></td></tr></table></figure><p>需要注意的是网卡的配置，这里的网卡名指的是需要安装系统的网卡名。</p><p>3、在/var/www/html目录创建ubuntu-server.seed文件，内容为空（暂时不配置）。</p><p>4、再次安装系统，绝大部分步骤都会自动进行选择了。但是，在分区部分卡住。<br><img src="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/partition.jpg?imageView2/0/w/700"><br>手动分区后，后续会全部自动安装。安装完成后，系统没有安装openssh服务。</p><h3 id="ubuntu-server-seed"><span class="post-title-index">4.4.2.</span><a href="#ubuntu-server-seed" class="headerlink" title="ubuntu-server.seed"></a> ubuntu-server.seed</h3><p>本文中，ubuntu-server.seed主要用来解决分区、选择软件等ks.cfg没有解决的问题。</p><p>1、编辑seed文件<br><code>vim /var/www/html/ubuntu-server.seed</code>，添加：</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">d-i pkgsel/<span class="keyword">include</span> string openssh-<span class="keyword">server</span></span><br><span class="line">d-i partman/confirm_write_new_label <span class="type">boolean</span> <span class="keyword">true</span></span><br><span class="line">d-i partman/choose_partition <span class="keyword">select</span> Finish partitioning <span class="keyword">and</span> <span class="keyword">write</span> changes <span class="keyword">to</span> disk</span><br><span class="line">d-i partman/confirm <span class="type">boolean</span> <span class="keyword">true</span></span><br></pre></td></tr></table></figure><p>其他配置可以参考/var/www/html/ubuntu/preseed/目录中的文件，不过本文中用不到其他配置了。</p><p>2、再次安装系统，此时就会自动分区，并且安装openssh服务了。全程不需要手动帮助设置，完美。</p><h2 id="配置手动安装"><span class="post-title-index">4.5.</span><a href="#配置手动安装" class="headerlink" title="配置手动安装"></a> 配置手动安装</h2><p>个别情况下，自动安装会失败，这时就需要手动安装，在Installer boot menu界面添加一个手动安装启动项即可。</p><p>1、编辑pxelinux.cfg文件<br><code>vim /tftpboot/pxelinux.cfg/default</code>，修改为：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># D-I config version 2.0</span></span><br><span class="line"><span class="comment"># search path for the c32 support libraries (libcom32, libutil etc.)</span></span><br><span class="line">path ubuntu-installer/amd64/boot-screens/</span><br><span class="line">include ubuntu-installer/amd64/boot-screens/menu.cfg</span><br><span class="line">default ubuntu-installer/amd64/boot-screens/vesamenu.c32</span><br><span class="line">prompt 0</span><br><span class="line"><span class="comment"># add localboot here</span></span><br><span class="line">label localboot</span><br><span class="line">    menu label Boot from Disk</span><br><span class="line">    localboot 0</span><br><span class="line"></span><br><span class="line">label manual install</span><br><span class="line">    menu label Manual Install</span><br><span class="line">    kernel ubuntu-installer/amd64/linux</span><br><span class="line">    append ks=http://172.16.0.162/manual.cfg vga=788 initrd=ubuntu-installer/amd64/initrd.gz --- quiet</span><br><span class="line"></span><br><span class="line"><span class="built_in">timeout</span> 0</span><br></pre></td></tr></table></figure><p>2、在/var/www/html目录创建manual.cfg文件，内容为：</p><figure class="highlight qml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">install</span><br><span class="line"><span class="built_in">url</span> --<span class="built_in">url</span> <span class="attribute">http</span>:<span class="comment">//172.16.0.162/ubuntu/</span></span><br></pre></td></tr></table></figure><p>3、重新安装系统，Installer boot menu界面就会出现手动安装选项。</p><h1 id="批量安装"><span class="post-title-index">5.</span><a href="#批量安装" class="headerlink" title="批量安装"></a> 批量安装</h1><p>1、远程连接需要安装系统的服务器，设置BIOS，选择从网络启动。</p><p>2、安装正常系统，有些机器在网络部分卡住。<br><img src="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/network.jpg?imageView2/0/w/700"><br>此时，可以手动给网卡配置IP。但是，如果系统只检测到一个网卡，而这个网卡没有连接网线，那么无法完成接下来的安装。因为没有IP，所以无法通过获取ks.cfg等文件。<br><img src="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/ks.jpg?imageView2/0/w/700"><br>Alt+F2进入控制台，<code>ip add</code>看到IP设置成功，但是无法ping通PXE服务器。Alt+F1返回图形界面。<br><img src="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/ping.jpg?imageView2/0/w/700"><br>此时，最好的做法是进入机房，把网线接到可以检测到的那个网卡。然后Ctrl+Alt+Del重启服务器。</p><p>3、再次安装系统，即可顺利安装。</p><h1 id="配置静态IP"><span class="post-title-index">6.</span><a href="#配置静态IP" class="headerlink" title="配置静态IP"></a> 配置静态IP</h1><p>系统安装完成后，此时不能上网，需要给系统配置静态IP和网关，这时发现了一个小问题：系统中没有安装vim，自带的vi也有毛病。怎么办？使用nano。</p><p>1、编辑interfaces<br><code>sudo nano /etc/network/interfaces</code><br><img src="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/staticip.jpg?imageView2/0/w/700"></p><p>2、保存文件<br>编辑完成，Ctrl+X退出，系统提示是否保存，输入Y回车，然后再次回车保存。</p><p>3、重启网络服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> /etc/init.d/networking restart</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line"><span class="built_in">sudo</span> ifdown ens2f0</span><br><span class="line"><span class="built_in">sudo</span> ifup ens2f0</span><br></pre></td></tr></table></figure><p>重启网络服务后发现，此时网卡上有两个IP地址，而且只有DHCP分配的旧的IP地址生效（第一个）。<br><img src="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/netrestart.jpg?imageView2/0/w/700"></p><p>4、取消IP地址并重启网络服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> ip addr flush dev ens2f0</span><br><span class="line"><span class="built_in">sudo</span> /etc/init.d/networking restart</span><br></pre></td></tr></table></figure><p>此时静态IP就配置成功了。</p><h1 id="后记"><span class="post-title-index">7.</span><a href="#后记" class="headerlink" title="后记"></a> 后记</h1><p>给40台机器配置远程控制接口的IP，搭建PXE服务器，安装系统，配置静态IP，总计用时一周左右。从效率上讲不如外包找人安装，从研究上讲还是有很多收获的。还好最近清闲了一些，不然还真没时间把整个安装流程搞清楚。<br>之所以用时很久，主要是因为有一些机器之前使用过，所以安装的时候需要手动确认remove volume data，或者disk detect报错需要手动安装，如下图所示。<br><img src="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/removedata.jpg?imageView2/0/w/700"><br><img src="http://cdn.voidking.com/img/batch-install-sys-by-mgmt/diskdetect.jpg?imageView2/0/w/700"></p><h1 id="书签"><span class="post-title-index">8.</span><a href="#书签" class="headerlink" title="书签"></a> 书签</h1><p><a target="_blank" rel="noopener" href="https://help.ubuntu.com/community/Installation/Netboot">Netboot Install</a></p><p><a target="_blank" rel="noopener" href="https://wiki.ubuntu.com/UEFI/PXE-netboot-install">PXE-netboot-install</a></p><p><a target="_blank" rel="noopener" href="http://cdimage.ubuntu.com/netboot/16.04/">Ubuntu 16.04 LTS (Xenial Xerus) Netboot</a></p><p><a target="_blank" rel="noopener" href="https://www.ostechnix.com/how-to-install-pxe-server-on-ubuntu-16-04/">How to install PXE Server on Ubuntu 16.04</a></p><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zhaoshuireshui/p/5593624.html">神奇的fdisk和dd命令</a></p><p><a target="_blank" rel="noopener" href="http://blog.sina.com.cn/s/blog_6fbc51e30102v59y.html">PXE网络克隆图文教程</a></p><p><a target="_blank" rel="noopener" href="https://blog.51cto.com/acadia627/778952">DHCP tftp PXE实现Ghost网络克隆</a></p></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 好好学习的郝</li><li class="post-copyright-link"> <strong>原文链接：</strong> <a href="https://www.voidking.com/dev-batch-install-sys-by-mgmt/" title="通过远程控制接口批量安装系统">https://www.voidking.com/dev-batch-install-sys-by-mgmt/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本文采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议，转载请注明出处！源站会即时更新知识点并修正错误，欢迎访问~</li></ul></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" rel="tag"># 操作系统</a> <a href="/tags/pxe/" rel="tag"># pxe</a></div><div class="post-nav"><div class="post-nav-item"><a href="/dev-install-sys-by-remote-controller-interface/" rel="prev" title="通过远程控制接口给服务器安装系统"><i class="fa fa-chevron-left"></i> 通过远程控制接口给服务器安装系统</a></div><div class="post-nav-item"> <a href="/dev-ubuntu-install-zabbix/" rel="next" title="Ubuntu安装配置zabbix">Ubuntu安装配置zabbix<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><div class="footer-ads" style="margin-top:10px"><ins class="adsbygoogle" style="display:block" data-ad-format="autorelaxed" data-ad-client="ca-pub-3284447971731414" data-ad-slot="9697986181"></ins><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3284447971731414" crossorigin="anonymous"></script><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div class="comments" id="gitalk-container"></div><script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-text">1. 前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4"><span class="nav-text">2. 安装步骤</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%90%AD%E5%BB%BAPXE%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="nav-text">3. 搭建PXE服务器</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E5%87%86%E5%A4%87"><span class="nav-text">3.1. 基本准备</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DHCP%E5%92%8CFTP"><span class="nav-text">3.2. DHCP和FTP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AEnetboot"><span class="nav-text">3.3. 配置netboot</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E7%B3%BB%E7%BB%9F"><span class="nav-text">3.4. 安装系统</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PXE%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8D%87%E7%BA%A7"><span class="nav-text">4. PXE服务器升级</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E5%86%85%E7%BD%91%E9%95%9C%E5%83%8F"><span class="nav-text">4.1. 配置内网镜像</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E7%A1%AC%E7%9B%98%E5%90%AF%E5%8A%A8"><span class="nav-text">4.2. 添加硬盘启动</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%AA%E5%8A%A8%E9%80%89%E6%8B%A9%E5%AE%89%E8%A3%85%E6%BA%90"><span class="nav-text">4.3. 自动选择安装源</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E6%97%A0%E4%BA%BA%E5%80%BC%E5%AE%88"><span class="nav-text">4.4. 配置无人值守</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ks-cfg"><span class="nav-text">4.4.1. ks.cfg</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ubuntu-server-seed"><span class="nav-text">4.4.2. ubuntu-server.seed</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E6%89%8B%E5%8A%A8%E5%AE%89%E8%A3%85"><span class="nav-text">4.5. 配置手动安装</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%89%B9%E9%87%8F%E5%AE%89%E8%A3%85"><span class="nav-text">5. 批量安装</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E9%9D%99%E6%80%81IP"><span class="nav-text">6. 配置静态IP</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%90%8E%E8%AE%B0"><span class="nav-text">7. 后记</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B9%A6%E7%AD%BE"><span class="nav-text">8. 书签</span></a></li></ol></div></div><div class="sidecar-ads" style="margin-top:10px"><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="好好学习的郝" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">好好学习的郝</p><div class="site-description" itemprop="description">一个计算机技术爱好者与学习者</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">748</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">32</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">259</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:voidking@qq.com" title="E-Mail → mailto:voidking@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://github.com/voidking" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="http://weibo.com/voidking" title="Weibo → http:&#x2F;&#x2F;weibo.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i> Weibo</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/voidking" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-quora"></i> Zhihu</a></span></div></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2014 – <span itemprop="copyrightYear">2025</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">好好学习的郝</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="footer-beian"> <a href="http://beian.miit.gov.cn/" target="_blank">苏ICP备14021030号</a>&nbsp;|&nbsp; <img src="/images/beian.png" alt=""> <a target="_blank" href="http://www.beian.gov.cn/">苏公网安备 32032202000223号</a></div></div></footer></div><script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.css"><script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: '5a238b8c32b1e4dd2156',
      clientSecret: 'bfb5d518626f6fdc7da0351d1e0cd37ab75c6361',
      repo: 'gitalk-comments',
      owner: 'voidking',
      admin: ['voidking'],
      id: 'ab1c1a0af32890748351c3cc20c1e126',
      title: '通过远程控制接口批量安装系统',
      body: '欢迎留言，互相交流学习~',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script></body></html>