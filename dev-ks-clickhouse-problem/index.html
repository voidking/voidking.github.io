<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:new URL("https://www.voidking.com").hostname,root:"/",scheme:"Gemini",version:"7.7.1",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1,cdn:{enable:!0,url:"//qiniu.cdn.voidking.com/doc/search.xml"}},path:"search.xml",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="问题描述参考在 KubeSphere 中部署 ClickHouse 集群，部署ClickHouse，添加应用仓库时，验证仓库的URL报错404。 仓库URL：https:&#x2F;&#x2F;radondb.github.io&#x2F;radondb-clickhouse-kubernetes&#x2F;"><meta property="og:type" content="article"><meta property="og:title" content="ks部署clickhouse验证仓库问题"><meta property="og:url" content="https://www.voidking.com/dev-ks-clickhouse-problem/index.html"><meta property="og:site_name" content="好好学习的郝"><meta property="og:description" content="问题描述参考在 KubeSphere 中部署 ClickHouse 集群，部署ClickHouse，添加应用仓库时，验证仓库的URL报错404。 仓库URL：https:&#x2F;&#x2F;radondb.github.io&#x2F;radondb-clickhouse-kubernetes&#x2F;"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://cdn.voidking.com/@/imgs/ks-clickhouse-problem/404.png?imageView2/0/w/800"><meta property="article:published_time" content="2022-09-05T20:00:00.000Z"><meta property="article:modified_time" content="2022-09-05T20:00:00.000Z"><meta property="article:author" content="好好学习的郝"><meta property="article:tag" content="k8s"><meta property="article:tag" content="问题排查"><meta property="article:tag" content="dns"><meta property="article:tag" content="网络"><meta property="article:tag" content="clickhouse"><meta property="article:tag" content="kubesphere"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://cdn.voidking.com/@/imgs/ks-clickhouse-problem/404.png?imageView2/0/w/800"><link rel="canonical" href="https://www.voidking.com/dev-ks-clickhouse-problem/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0}</script><title>ks部署clickhouse验证仓库问题 | 好好学习的郝</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?b759ac2a7fa45129e3ef060bf68259f0";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="好好学习的郝" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">好好学习的郝</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">一个计算机技术爱好者与学习者</h1></div><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/voidking" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.voidking.com/dev-ks-clickhouse-problem/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="好好学习的郝"><meta itemprop="description" content="一个计算机技术爱好者与学习者"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="好好学习的郝"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> ks部署clickhouse验证仓库问题</h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-09-05 20:00:00" itemprop="dateCreated datePublished" datetime="2022-09-05T20:00:00+00:00">2022-09-05</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/" itemprop="url" rel="index"><span itemprop="name">engineering</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/k8s/" itemprop="url" rel="index"><span itemprop="name">k8s</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/cloudnative/" itemprop="url" rel="index"><span itemprop="name">cloudnative</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/network/" itemprop="url" rel="index"><span itemprop="name">network</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/troubleshooting/" itemprop="url" rel="index"><span itemprop="name">troubleshooting</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="问题描述"><span class="post-title-index">1.</span><a href="#问题描述" class="headerlink" title="问题描述"></a> 问题描述</h1><p>参考<a target="_blank" rel="noopener" href="https://kubesphere.io/zh/docs/v3.3/application-store/external-apps/deploy-clickhouse/">在 KubeSphere 中部署 ClickHouse 集群</a>，部署ClickHouse，添加应用仓库时，验证仓库的URL报错404。</p><p>仓库URL：<code>https://radondb.github.io/radondb-clickhouse-kubernetes/</code></p><p><img src="http://cdn.voidking.com/@/imgs/ks-clickhouse-problem/404.png?imageView2/0/w/800"></p><span id="more"></span><h1 id="排查思路"><span class="post-title-index">2.</span><a href="#排查思路" class="headerlink" title="排查思路"></a> 排查思路</h1><p>1、确认仓库URL是否正确<br>2、确认ks的域名解析是否正常</p><h1 id="确认仓库URL"><span class="post-title-index">3.</span><a href="#确认仓库URL" class="headerlink" title="确认仓库URL"></a> 确认仓库URL</h1><p><code>curl https://radondb.github.io/radondb-clickhouse-kubernetes/</code><br>本地和ks-apiserver宿主机都是正常可以获取到数据的，浏览器访问 <a target="_blank" rel="noopener" href="https://radondb.github.io/radondb-clickhouse-kubernetes/index.yaml">https://radondb.github.io/radondb-clickhouse-kubernetes/index.yaml</a> 也正常，说明仓库URL没有问题。</p><h1 id="确认ks域名解析"><span class="post-title-index">4.</span><a href="#确认ks域名解析" class="headerlink" title="确认ks域名解析"></a> 确认ks域名解析</h1><h2 id="宿主机解析"><span class="post-title-index">4.1.</span><a href="#宿主机解析" class="headerlink" title="宿主机解析"></a> 宿主机解析</h2><p>先查看一下正常的解析。</p><p>1、nslookup查看解析</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nslookup radondb.github.io</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Server:     10.96.0.10</span><br><span class="line">Address:    10.96.0.10#53</span><br><span class="line"></span><br><span class="line">Non-authoritative answer:</span><br><span class="line">Name:   radondb.github.io</span><br><span class="line">Address: 185.199.111.153</span><br><span class="line">Name:   radondb.github.io</span><br><span class="line">Address: 185.199.108.153</span><br><span class="line">Name:   radondb.github.io</span><br><span class="line">Address: 185.199.110.153</span><br><span class="line">Name:   radondb.github.io</span><br><span class="line">Address: 185.199.109.153</span><br><span class="line">Name:   radondb.github.io</span><br><span class="line">Address: 2606:50c0:8002::153</span><br><span class="line">Name:   radondb.github.io</span><br><span class="line">Address: 2606:50c0:8003::153</span><br><span class="line">Name:   radondb.github.io</span><br><span class="line">Address: 2606:50c0:8000::153</span><br><span class="line">Name:   radondb.github.io</span><br><span class="line">Address: 2606:50c0:8001::153</span><br></pre></td></tr></table></figure><p>2、ping查看解析</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping radondb.github.io</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PING radondb.github.io (185.199.108.153) 56(84) bytes of data.</span><br></pre></td></tr></table></figure><p>nslookup和ping的结果一致。</p><h2 id="ks-apiserver-pod内解析"><span class="post-title-index">4.2.</span><a href="#ks-apiserver-pod内解析" class="headerlink" title="ks-apiserver pod内解析"></a> ks-apiserver pod内解析</h2><p>1、nslookup查看解析</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nslookup radondb.github.io</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Server:     10.96.0.10</span><br><span class="line">Address:    10.96.0.10:53</span><br><span class="line"></span><br><span class="line">Non-authoritative answer:</span><br><span class="line">Name:   radondb.github.io</span><br><span class="line">Address: 2606:50c0:8001::153</span><br><span class="line">Name:   radondb.github.io</span><br><span class="line">Address: 2606:50c0:8002::153</span><br><span class="line">Name:   radondb.github.io</span><br><span class="line">Address: 2606:50c0:8003::153</span><br><span class="line">Name:   radondb.github.io</span><br><span class="line">Address: 2606:50c0:8000::153</span><br><span class="line"></span><br><span class="line">Non-authoritative answer:</span><br><span class="line">Name:   radondb.github.io</span><br><span class="line">Address: 185.199.109.153</span><br><span class="line">Name:   radondb.github.io</span><br><span class="line">Address: 185.199.111.153</span><br><span class="line">Name:   radondb.github.io</span><br><span class="line">Address: 185.199.108.153</span><br><span class="line">Name:   radondb.github.io</span><br><span class="line">Address: 185.199.110.153</span><br></pre></td></tr></table></figure><p>2、ping查看解析</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping radondb.github.io</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PING radondb.github.io (192.168.50.11): 56 data bytes</span><br><span class="line">64 bytes from 192.168.50.11: seq=0 ttl=63 time=2.151 ms</span><br><span class="line">64 bytes from 192.168.50.11: seq=1 ttl=63 time=3.443 ms</span><br></pre></td></tr></table></figure><p>问题来了，这里nslookup和ping的解析结果不一致。</p><p>3、查看解析配置</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /etc/resolv.conf</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nameserver 10.96.0.10</span><br><span class="line">search kubesphere-system.svc.cluster.local svc.cluster.local cluster.local abc.com</span><br><span class="line">options ndots:5</span><br></pre></td></tr></table></figure><p>用host命令确认下解析过程：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">host -v radondb.github.io</span><br></pre></td></tr></table></figure><p>至此问题就明确了，nslookup/dig会直接查询DNS服务器，因此查询结果没问题。<br>而ping、host、curl等命令实际上会查看本地hosts，再根据resolv.conf中的配置查询域名，当域名的点的数量小于5个时会依次加上后缀（search）去DNS服务器查找，如果都找不到再直接去DNS服务器查找域名。<br>当查找radondb.github.io.abc.com域名时，因为匹配到了<code>*.abc.com</code>泛域名解析，所以找到了非预期的服务器去处理这个请求，因此报错404。<br>详情参考<a target="_blank" rel="noopener" href="http://www.ichenfu.com/2018/10/09/resolv-conf-desc/">/etc/resolv.conf search和ndots配置</a></p><h1 id="解决办法"><span class="post-title-index">5.</span><a href="#解决办法" class="headerlink" title="解决办法"></a> 解决办法</h1><h2 id="临时解法"><span class="post-title-index">5.1.</span><a href="#临时解法" class="headerlink" title="临时解法"></a> 临时解法</h2><p>直接修改ks-apiserver pod里的resolv.conf，改为</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nameserver 10.96.0.10</span><br><span class="line">search kubesphere-system.svc.cluster.local svc.cluster.local cluster.local abc.com</span><br><span class="line">options ndots:2</span><br></pre></td></tr></table></figure><h2 id="永久解法"><span class="post-title-index">5.2.</span><a href="#永久解法" class="headerlink" title="永久解法"></a> 永久解法</h2><p>修改ks-apiserver的deployment yaml文件，pod部分添加：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">dnsConfig:</span></span><br><span class="line">    <span class="attr">options:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">ndots</span></span><br><span class="line">      <span class="attr">value:</span> <span class="string">&quot;2&quot;</span></span><br></pre></td></tr></table></figure><p>options：可选的对象列表，其中每个对象可能具有 name 属性（必需）和 value 属性（可选）。 此属性中的内容将合并到从指定的 DNS 策略生成的选项，重复的条目将被删除。<br>详情参考<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/b9153181e372">k8s网络配置DNS</a></p><h2 id="全局解法"><span class="post-title-index">5.3.</span><a href="#全局解法" class="headerlink" title="全局解法"></a> 全局解法</h2><p>如果集群中所有pod的resolv.conf都想要修改，该怎么操作？<br>暂时没有找到配置方法，未完待续。。。</p></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 好好学习的郝</li><li class="post-copyright-link"> <strong>原文链接：</strong> <a href="https://www.voidking.com/dev-ks-clickhouse-problem/" title="ks部署clickhouse验证仓库问题">https://www.voidking.com/dev-ks-clickhouse-problem/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本文采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议，转载请注明出处！源站会即时更新知识点并修正错误，欢迎访问~</li><li> <img width="200" height="200" src="/images/avatar.jpg"><p style="text-align:center;margin-bottom:0">微信公众号同步更新，欢迎关注~</p></li></ul></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/k8s/" rel="tag"># k8s</a> <a href="/tags/%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5/" rel="tag"># 问题排查</a> <a href="/tags/dns/" rel="tag"># dns</a> <a href="/tags/%E7%BD%91%E7%BB%9C/" rel="tag"># 网络</a> <a href="/tags/clickhouse/" rel="tag"># clickhouse</a> <a href="/tags/kubesphere/" rel="tag"># kubesphere</a></div><div class="post-nav"><div class="post-nav-item"><a href="/dev-jumpserver-start/" rel="prev" title="JumpServer入门篇"><i class="fa fa-chevron-left"></i> JumpServer入门篇</a></div><div class="post-nav-item"> <a href="/dev-k8s-clickhouse/" rel="next" title="K8S中安装配置ClickHouse">K8S中安装配置ClickHouse<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><div class="footer-ads" style="margin-top:10px"><ins class="adsbygoogle" style="display:block" data-ad-format="autorelaxed" data-ad-client="ca-pub-3284447971731414" data-ad-slot="9697986181"></ins><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3284447971731414" crossorigin="anonymous"></script><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div class="comments" id="gitalk-container"></div><script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0"><span class="nav-text">1. 问题描述</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%8E%92%E6%9F%A5%E6%80%9D%E8%B7%AF"><span class="nav-text">2. 排查思路</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%A1%AE%E8%AE%A4%E4%BB%93%E5%BA%93URL"><span class="nav-text">3. 确认仓库URL</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%A1%AE%E8%AE%A4ks%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90"><span class="nav-text">4. 确认ks域名解析</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%BF%E4%B8%BB%E6%9C%BA%E8%A7%A3%E6%9E%90"><span class="nav-text">4.1. 宿主机解析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ks-apiserver-pod%E5%86%85%E8%A7%A3%E6%9E%90"><span class="nav-text">4.2. ks-apiserver pod内解析</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95"><span class="nav-text">5. 解决办法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%B4%E6%97%B6%E8%A7%A3%E6%B3%95"><span class="nav-text">5.1. 临时解法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B0%B8%E4%B9%85%E8%A7%A3%E6%B3%95"><span class="nav-text">5.2. 永久解法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%A8%E5%B1%80%E8%A7%A3%E6%B3%95"><span class="nav-text">5.3. 全局解法</span></a></li></ol></li></ol></div></div><div class="sidecar-ads" style="margin-top:10px"><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="好好学习的郝" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">好好学习的郝</p><div class="site-description" itemprop="description">一个计算机技术爱好者与学习者</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">682</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">30</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">247</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:voidking@qq.com" title="E-Mail → mailto:voidking@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://github.com/voidking" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="http://weibo.com/voidking" title="Weibo → http:&#x2F;&#x2F;weibo.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i> Weibo</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/voidking" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-quora"></i> Zhihu</a></span></div></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2014 – <span itemprop="copyrightYear">2023</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">好好学习的郝</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="footer-beian"> <a href="http://beian.miit.gov.cn/" target="_blank">苏ICP备14021030号</a>&nbsp;|&nbsp; <img src="/images/beian.png" alt=""> <a target="_blank" href="http://www.beian.gov.cn/">苏公网安备 32032202000223号</a></div></div></footer></div><script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.css"><script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: '5a238b8c32b1e4dd2156',
      clientSecret: 'bfb5d518626f6fdc7da0351d1e0cd37ab75c6361',
      repo: 'gitalk-comments',
      owner: 'voidking',
      admin: ['voidking'],
      id: 'a8a495f3924e3c02d2a89cf3802af38a',
      title: 'ks部署clickhouse验证仓库问题',
      body: '欢迎留言，互相交流学习~',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script></body></html>