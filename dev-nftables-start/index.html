<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:new URL("https://www.voidking.com").hostname,root:"/",scheme:"Gemini",version:"7.7.1",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1,cdn:{enable:!0,url:"//qiniu.cdn.voidking.com/doc/search.xml"}},path:"search.xml",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="什么是nftables？nftables是Linux内核的一个网络包过滤工具（框架），用于替代传统的iptables&#x2F;ip6tables&#x2F;arptables&#x2F;ebtables范式。nftables代表了对经典的iptables的进化与革新，它提供了一个简单、统一和高效的方式来管理网络数据包的流动，包括过滤和路由。 本文中，我们会学习nftables的基础知识，了解nftables的常用命令。 相关"><meta property="og:type" content="article"><meta property="og:title" content="nftables入门篇"><meta property="og:url" content="https://www.voidking.com/dev-nftables-start/index.html"><meta property="og:site_name" content="好好学习的郝"><meta property="og:description" content="什么是nftables？nftables是Linux内核的一个网络包过滤工具（框架），用于替代传统的iptables&#x2F;ip6tables&#x2F;arptables&#x2F;ebtables范式。nftables代表了对经典的iptables的进化与革新，它提供了一个简单、统一和高效的方式来管理网络数据包的流动，包括过滤和路由。 本文中，我们会学习nftables的基础知识，了解nftables的常用命令。 相关"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2024-06-15T08:00:00.000Z"><meta property="article:modified_time" content="2024-06-15T08:00:00.000Z"><meta property="article:author" content="好好学习的郝"><meta property="article:tag" content="linux"><meta property="article:tag" content="网络"><meta property="article:tag" content="iptables"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://www.voidking.com/dev-nftables-start/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0}</script><title>nftables入门篇 | 好好学习的郝</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?b759ac2a7fa45129e3ef060bf68259f0";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="好好学习的郝" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">好好学习的郝</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">一个计算机技术爱好者与学习者</h1></div><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/voidking" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.voidking.com/dev-nftables-start/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="好好学习的郝"><meta itemprop="description" content="一个计算机技术爱好者与学习者"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="好好学习的郝"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> nftables入门篇</h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2024-06-15 08:00:00" itemprop="dateCreated datePublished" datetime="2024-06-15T08:00:00+00:00">2024-06-15</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/" itemprop="url" rel="index"><span itemprop="name">engineering</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/devops/" itemprop="url" rel="index"><span itemprop="name">devops</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/shell/" itemprop="url" rel="index"><span itemprop="name">shell</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/network/" itemprop="url" rel="index"><span itemprop="name">network</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="什么是nftables？"><span class="post-title-index">1.</span><a href="#什么是nftables？" class="headerlink" title="什么是nftables？"></a> 什么是nftables？</h1><p><code>nftables</code>是Linux内核的一个网络包过滤工具（框架），用于替代传统的iptables/ip6tables/arptables/ebtables范式。<br><code>nftables</code>代表了对经典的<code>iptables</code>的进化与革新，它提供了一个简单、统一和高效的方式来管理网络数据包的流动，包括过滤和路由。</p><p>本文中，我们会学习<code>nftables</code>的基础知识，了解<code>nftables</code>的常用命令。</p><p>相关文档：</p><ul><li><a href="https://www.voidking.com/dev-iptables-start/">《iptables入门篇》</a></li></ul><span id="more"></span><h1 id="iptables-vs-nftables"><span class="post-title-index">2.</span><a href="#iptables-vs-nftables" class="headerlink" title="iptables vs nftables"></a> iptables vs nftables</h1><p><code>iptables</code>和<code>nftables</code>（nf表示netfilter）都是Linux系统中用于管理网络流量规则的工具，它们用于配置内核的网络包过滤、转发以及网络地址转换(NAT)等功能。</p><h2 id="iptables特点"><span class="post-title-index">2.1.</span><a href="#iptables特点" class="headerlink" title="iptables特点"></a> iptables特点</h2><ul><li><code>iptables</code>是在较早的Linux内核版本中引入的网络包过滤框架。</li><li>它主要和Netfilter框架交互，负责IPv4流量。</li><li><code>iptables</code>有自己的语法规则，通过命令行工具来管理。</li><li>它有多个表(table)，比如<code>filter</code>, <code>nat</code>, <code>mangle</code>, <code>raw</code>，每个表包含一组链(chain)，例如<code>INPUT</code>, <code>FORWARD</code>, <code>OUTPUT</code>。</li><li>命令行语法可能对新手来说比较复杂且难以理解。</li><li><code>iptables</code>没有直接的支持IPV6，需要通过<code>ip6tables</code>来进行配置。</li></ul><h2 id="nftables特点"><span class="post-title-index">2.2.</span><a href="#nftables特点" class="headerlink" title="nftables特点"></a> nftables特点</h2><ul><li><code>nftables</code>是<code>iptables</code>的现代替代品，随Linux内核3.13及以后版本发布。</li><li>它是为了解决<code>iptables</code>命令复杂和性能不佳等问题而设计的。</li><li><code>nftables</code>使用新的<code>nft</code>命令行工具，提供了一种更简洁的的语法，结构更为统一，并且可以同时处理IPv4、IPv6和其他协议，从而简化了规则集的管理和配置。</li><li><code>nftables</code>提供了一个内置的数据包分类引擎，用来代替<code>iptables</code>中的多个存在重叠功能的模块。</li><li><code>nftables</code>使用单个框架来取代<code>iptables</code>中的多个工具(<code>iptables</code>, <code>ip6tables</code>, <code>arptables</code>, <code>ebtables</code>)。</li></ul><h2 id="区别"><span class="post-title-index">2.3.</span><a href="#区别" class="headerlink" title="区别"></a> 区别</h2><ul><li>语法：<code>nftables</code>有更为简单和现代的语法。</li><li>性能：<code>nftables</code>旨在提供更好的性能。</li><li>易用性：<code>nftables</code>提供更为统一的处理方式，减少了之前版本的复杂度。</li><li>功能整合：<code>nftables</code>合并了<code>iptables</code>的多个实用工具和表，简化了管理过程。</li><li>协议支持：<code>nftables</code>可以同时支持多个协议。</li></ul><h2 id="联系"><span class="post-title-index">2.4.</span><a href="#联系" class="headerlink" title="联系"></a> 联系</h2><ul><li>目的：它们都旨在管理Linux内核的包过滤规则。</li><li>基础：<code>nftables</code>建立在<code>iptables</code>的基础上，尝试克服<code>iptables</code>现存的不足。</li><li>Netfilter：它们都使用Netfilter框架来实现网络包的过滤和处理。</li></ul><h2 id="小结"><span class="post-title-index">2.5.</span><a href="#小结" class="headerlink" title="小结"></a> 小结</h2><p>总的来说，虽然<code>nftables</code>是作为<code>iptables</code>的后续者被设计和构建的，但两者在很长一段时间内是并存的，而现在Linux社区鼓励大家使用<code>nftables</code>以取代被认为过时的<code>iptables</code>。不过，许多老系统和应用可能仍然依赖于<code>iptables</code>。</p><h1 id="nftables关键组成"><span class="post-title-index">3.</span><a href="#nftables关键组成" class="headerlink" title="nftables关键组成"></a> nftables关键组成</h1><ul><li>nftables子系统：这是Linux内核的一部分，是nftables操作的核心。它通过Netfilter提供的钩子（hooks）处理数据包。</li><li>nft命令行工具：用户通过<code>nft</code>命令行工具与nftables子系统进行交互。这个工具用于设置和更新规则集。</li><li>规则集：规则集（rulesets）是nftables配置的核心。它包含了基于各种条件对数据包进行处理的规则。</li></ul><h1 id="安装nftables"><span class="post-title-index">4.</span><a href="#安装nftables" class="headerlink" title="安装nftables"></a> 安装nftables</h1><p>在现代的Linux发行版上，默认情况下可能已经安装了<code>nftables</code>。如果没有安装，我们可以通过发行版的包管理工具来安装：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Debian/Ubuntu</span></span><br><span class="line"><span class="built_in">sudo</span> apt install nftables</span><br><span class="line"></span><br><span class="line"><span class="comment"># CentOS/RHEL</span></span><br><span class="line"><span class="built_in">sudo</span> yum install nftables</span><br><span class="line"></span><br><span class="line"><span class="comment"># Fedora</span></span><br><span class="line"><span class="built_in">sudo</span> dnf install nftables</span><br></pre></td></tr></table></figure><h1 id="nftables基础"><span class="post-title-index">5.</span><a href="#nftables基础" class="headerlink" title="nftables基础"></a> nftables基础</h1><h2 id="表、链和规则"><span class="post-title-index">5.1.</span><a href="#表、链和规则" class="headerlink" title="表、链和规则"></a> 表、链和规则</h2><p>在nftables中，表（tables）是存储链（chains）的容器，而链则是规则的集合。一个规则可以决定接受、拒绝、转发还是处理一个数据包。</p><h2 id="nft命令基础"><span class="post-title-index">5.2.</span><a href="#nft命令基础" class="headerlink" title="nft命令基础"></a> nft命令基础</h2><h3 id="创建表"><span class="post-title-index">5.2.1.</span><a href="#创建表" class="headerlink" title="创建表"></a> 创建表</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nft add table ip my_table</span><br></pre></td></tr></table></figure><p>其中 <code>ip</code> 指定了正在创建的表将用于IPv4流量。</p><h3 id="创建链到表中"><span class="post-title-index">5.2.2.</span><a href="#创建链到表中" class="headerlink" title="创建链到表中"></a> 创建链到表中</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nft add chain ip my_table my_chain &#123; <span class="built_in">type</span> filter hook input priority 0 \; &#125;</span><br></pre></td></tr></table></figure><h3 id="创建规则到链中"><span class="post-title-index">5.2.3.</span><a href="#创建规则到链中" class="headerlink" title="创建规则到链中"></a> 创建规则到链中</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nft add rule ip my_table my_chain ip saddr 192.168.1.0/24 accept</span><br></pre></td></tr></table></figure><p>这个命令会在<code>my_chain</code>中添加一个规则，允许来自子网<code>192.168.1.0/24</code>的所有进入数据包。</p><h3 id="查看表、链和规则"><span class="post-title-index">5.2.4.</span><a href="#查看表、链和规则" class="headerlink" title="查看表、链和规则"></a> 查看表、链和规则</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nft list tables</span><br><span class="line">nft list chains</span><br><span class="line">nft list ruleset</span><br></pre></td></tr></table></figure><p>输出结果为：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@gateway ~]# nft list tables</span><br><span class="line">table ip my_table</span><br><span class="line">[root@gateway ~]# nft list chains</span><br><span class="line">table ip my_table &#123;</span><br><span class="line">    chain my_chain &#123;</span><br><span class="line">        type filter hook input priority 0; policy accept;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">[root@gateway ~]# nft list ruleset</span><br><span class="line">table ip my_table &#123;</span><br><span class="line">    chain my_chain &#123;</span><br><span class="line">        type filter hook input priority 0; policy accept;</span><br><span class="line">        ip saddr 192.168.1.0/24 accept</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="删除规则"><span class="post-title-index">5.2.5.</span><a href="#删除规则" class="headerlink" title="删除规则"></a> 删除规则</h3><p>查看当前的规则集：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nft list ruleset</span><br></pre></td></tr></table></figure><p>删除某个特定的规则：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nft delete rule ip my_table my_chain handle 1</span><br></pre></td></tr></table></figure><h3 id="保存和恢复规则集"><span class="post-title-index">5.2.6.</span><a href="#保存和恢复规则集" class="headerlink" title="保存和恢复规则集"></a> 保存和恢复规则集</h3><p>当主机重启后，表、链和规则会全部清空，因此需要保存和恢复规则集。</p><p>保存当前的规则集到文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nft list ruleset &gt; /etc/nftables.conf</span><br></pre></td></tr></table></figure><p>从文件恢复规则集：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nft -f /etc/nftables.conf</span><br></pre></td></tr></table></figure><h1 id="示例：基本的端口过滤"><span class="post-title-index">6.</span><a href="#示例：基本的端口过滤" class="headerlink" title="示例：基本的端口过滤"></a> 示例：基本的端口过滤</h1><p>假设我们想要允许SSH（端口22）和HTTP（端口80）流量，但拒绝其他所有的入站流量。</p><p>1、新建一个表和链，默认允许所有流量</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nft add table ip filter</span><br><span class="line">nft add chain ip filter input &#123; <span class="built_in">type</span> filter hook input priority 0 \; policy accept \; &#125;</span><br></pre></td></tr></table></figure><p>2、添加规则允许SSH和HTTP流量</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nft add rule ip filter input tcp dport &#123;22, 80&#125; accept</span><br></pre></td></tr></table></figure><p>3、除了允许的规则外，拒绝所有流量</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nft add rule ip filter input counter drop</span><br><span class="line">nft list chain ip filter input</span><br></pre></td></tr></table></figure><p>通过插入一个计数器规则，丢弃并记录没有匹配到accept规则的流量。</p><p>或者：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nft chain ip filter input &#123; <span class="built_in">type</span> filter hook input priority 0 \; policy drop \; &#125;</span><br><span class="line">nft list chain ip filter input</span><br></pre></td></tr></table></figure><p>通过修改链的默认策略为drop，丢弃没有匹配到accept规则的流量。</p><p>以上命令建立了一个默认拒绝所有进入流量的策略，并明确设定了接受端口为22和80的TCP连接的规则。</p></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 好好学习的郝</li><li class="post-copyright-link"> <strong>原文链接：</strong> <a href="https://www.voidking.com/dev-nftables-start/" title="nftables入门篇">https://www.voidking.com/dev-nftables-start/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本文采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议，转载请注明出处！源站会即时更新知识点并修正错误，欢迎访问~</li><li> <img width="200" height="200" src="/images/avatar.jpg"><p style="text-align:center;margin-bottom:0">微信公众号同步更新，欢迎关注~</p></li></ul></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/linux/" rel="tag"># linux</a> <a href="/tags/%E7%BD%91%E7%BB%9C/" rel="tag"># 网络</a> <a href="/tags/iptables/" rel="tag"># iptables</a></div><div class="post-nav"><div class="post-nav-item"><a href="/dev-docker-buildx/" rel="prev" title="好好学Docker：基于Docker buildx构建多平台镜像"><i class="fa fa-chevron-left"></i> 好好学Docker：基于Docker buildx构建多平台镜像</a></div><div class="post-nav-item"> <a href="/dev-xfs-quota/" rel="next" title="好好学Linux：基于 xfs_quota 限制目录大小">好好学Linux：基于 xfs_quota 限制目录大小<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><div class="footer-ads" style="margin-top:10px"><ins class="adsbygoogle" style="display:block" data-ad-format="autorelaxed" data-ad-client="ca-pub-3284447971731414" data-ad-slot="9697986181"></ins><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3284447971731414" crossorigin="anonymous"></script><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div class="comments" id="gitalk-container"></div><script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFnftables%EF%BC%9F"><span class="nav-text">1. 什么是nftables？</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#iptables-vs-nftables"><span class="nav-text">2. iptables vs nftables</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#iptables%E7%89%B9%E7%82%B9"><span class="nav-text">2.1. iptables特点</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#nftables%E7%89%B9%E7%82%B9"><span class="nav-text">2.2. nftables特点</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8C%BA%E5%88%AB"><span class="nav-text">2.3. 区别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%81%94%E7%B3%BB"><span class="nav-text">2.4. 联系</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93"><span class="nav-text">2.5. 小结</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#nftables%E5%85%B3%E9%94%AE%E7%BB%84%E6%88%90"><span class="nav-text">3. nftables关键组成</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%89%E8%A3%85nftables"><span class="nav-text">4. 安装nftables</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#nftables%E5%9F%BA%E7%A1%80"><span class="nav-text">5. nftables基础</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A1%A8%E3%80%81%E9%93%BE%E5%92%8C%E8%A7%84%E5%88%99"><span class="nav-text">5.1. 表、链和规则</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#nft%E5%91%BD%E4%BB%A4%E5%9F%BA%E7%A1%80"><span class="nav-text">5.2. nft命令基础</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E8%A1%A8"><span class="nav-text">5.2.1. 创建表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E9%93%BE%E5%88%B0%E8%A1%A8%E4%B8%AD"><span class="nav-text">5.2.2. 创建链到表中</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E8%A7%84%E5%88%99%E5%88%B0%E9%93%BE%E4%B8%AD"><span class="nav-text">5.2.3. 创建规则到链中</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E8%A1%A8%E3%80%81%E9%93%BE%E5%92%8C%E8%A7%84%E5%88%99"><span class="nav-text">5.2.4. 查看表、链和规则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E8%A7%84%E5%88%99"><span class="nav-text">5.2.5. 删除规则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%9D%E5%AD%98%E5%92%8C%E6%81%A2%E5%A4%8D%E8%A7%84%E5%88%99%E9%9B%86"><span class="nav-text">5.2.6. 保存和恢复规则集</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%9F%BA%E6%9C%AC%E7%9A%84%E7%AB%AF%E5%8F%A3%E8%BF%87%E6%BB%A4"><span class="nav-text">6. 示例：基本的端口过滤</span></a></li></ol></div></div><div class="sidecar-ads" style="margin-top:10px"><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="好好学习的郝" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">好好学习的郝</p><div class="site-description" itemprop="description">一个计算机技术爱好者与学习者</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">723</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">31</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">254</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:voidking@qq.com" title="E-Mail → mailto:voidking@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://github.com/voidking" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="http://weibo.com/voidking" title="Weibo → http:&#x2F;&#x2F;weibo.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i> Weibo</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/voidking" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-quora"></i> Zhihu</a></span></div></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2014 – <span itemprop="copyrightYear">2024</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">好好学习的郝</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="footer-beian"> <a href="http://beian.miit.gov.cn/" target="_blank">苏ICP备14021030号</a>&nbsp;|&nbsp; <img src="/images/beian.png" alt=""> <a target="_blank" href="http://www.beian.gov.cn/">苏公网安备 32032202000223号</a></div></div></footer></div><script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.css"><script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: '5a238b8c32b1e4dd2156',
      clientSecret: 'bfb5d518626f6fdc7da0351d1e0cd37ab75c6361',
      repo: 'gitalk-comments',
      owner: 'voidking',
      admin: ['voidking'],
      id: 'a1f9e903ad5c4f30368107aed768085c',
      title: 'nftables入门篇',
      body: '欢迎留言，互相交流学习~',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script></body></html>