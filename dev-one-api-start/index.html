<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:new URL("https://www.voidking.com").hostname,root:"/",scheme:"Gemini",version:"7.7.1",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1,cdn:{enable:!0,url:"//qiniu-cdn.voidking.com/doc/search.xml"}},path:"search.xml",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="One API简介One API是一个LLM代理系统，支持LLM接口管理和消息分发。使得用户可以通过标准的 OpenAI API 格式访问所有的大模型，开箱即用。 One API 比 openai-forword 更强大，因为 One API 除了作为LLM代理，还可以作为LLM一个中间商系统。 相关文档：  github - one-api 《好好学Docker：使用Docker安装配置OPAN"><meta property="og:type" content="article"><meta property="og:title" content="LLM 接口管理和分发系统 One API"><meta property="og:url" content="https://www.voidking.com/dev-one-api-start/index.html"><meta property="og:site_name" content="好好学习的郝"><meta property="og:description" content="One API简介One API是一个LLM代理系统，支持LLM接口管理和消息分发。使得用户可以通过标准的 OpenAI API 格式访问所有的大模型，开箱即用。 One API 比 openai-forword 更强大，因为 One API 除了作为LLM代理，还可以作为LLM一个中间商系统。 相关文档：  github - one-api 《好好学Docker：使用Docker安装配置OPAN"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2024-10-26T08:00:00.000Z"><meta property="article:modified_time" content="2025-06-01T08:00:00.000Z"><meta property="article:author" content="好好学习的郝"><meta property="article:tag" content="docker"><meta property="article:tag" content="chatgpt"><meta property="article:tag" content="aigc"><meta property="article:tag" content="llm"><meta property="article:tag" content="one-api"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://www.voidking.com/dev-one-api-start/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0}</script><title>LLM 接口管理和分发系统 One API | 好好学习的郝</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?b759ac2a7fa45129e3ef060bf68259f0";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="好好学习的郝" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">好好学习的郝</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">一个计算机技术爱好者与学习者</h1></div><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/voidking" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.voidking.com/dev-one-api-start/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="好好学习的郝"><meta itemprop="description" content="一个计算机技术爱好者与学习者"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="好好学习的郝"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> LLM 接口管理和分发系统 One API</h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2024-10-26 08:00:00" itemprop="dateCreated datePublished" datetime="2024-10-26T08:00:00+00:00">2024-10-26</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2025-06-01 08:00:00" itemprop="dateModified" datetime="2025-06-01T08:00:00+00:00">2025-06-01</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/" itemprop="url" rel="index"><span itemprop="name">engineering</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/docker/" itemprop="url" rel="index"><span itemprop="name">docker</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="One-API简介"><span class="post-title-index">1.</span><a href="#One-API简介" class="headerlink" title="One API简介"></a> One API简介</h1><p>One API是一个LLM代理系统，支持LLM接口管理和消息分发。使得用户可以通过标准的 OpenAI API 格式访问所有的大模型，开箱即用。</p><p>One API 比 <a target="_blank" rel="noopener" href="https://github.com/KenyonY/openai-forward">openai-forword</a> 更强大，因为 One API 除了作为LLM代理，还可以作为LLM一个中间商系统。</p><p>相关文档：</p><ul><li><a target="_blank" rel="noopener" href="https://github.com/songquanpeng/one-api/">github - one-api</a></li><li><a href="https://www.voidking.com/dev-docker-openai-api-proxy/">《好好学Docker：使用Docker安装配置OPANAI API代理》</a></li></ul><span id="more"></span><h1 id="One-API核心功能"><span class="post-title-index">2.</span><a href="#One-API核心功能" class="headerlink" title="One API核心功能"></a> One API核心功能</h1><ul><li>支持多种大模型：OpenAI、Claude、Gemini、Mistral、豆包、文心一言、通义千问、腾讯混元、SiliconCloud等等等等。</li><li>支持 stream 模式，可以通过流式传输实现打字机效果</li><li>支持绘图接口</li><li>支持失败自动重试</li><li>支持多机部署，提高并发</li><li>支持渠道管理，批量创建渠道，支持渠道设置模型列表，支持通过负载均衡访问多个渠道</li><li>支持多用户管理，支持用户额度配置，支持充值，支持用户分组以及渠道分组，支持为不同分组设置不同的倍率</li><li>支持令牌管理，设置令牌的过期时间、额度、允许的 IP 范围以及允许的模型访问</li></ul><h1 id="安装配置-One-API"><span class="post-title-index">3.</span><a href="#安装配置-One-API" class="headerlink" title="安装配置 One API"></a> 安装配置 One API</h1><h2 id="安装配置-One-API-概述"><span class="post-title-index">3.1.</span><a href="#安装配置-One-API-概述" class="headerlink" title="安装配置 One API 概述"></a> 安装配置 One API 概述</h2><p>One API 提供了多种安装部署方式，包括Docker部署、裸机编译部署、多机部署、宝塔部署、第三方平台一键部署等。<br>本文中选择使用Docker部署，数据库选择MySQL，不使用Redis。</p><h2 id="安装MySQL（可选）"><span class="post-title-index">3.2.</span><a href="#安装MySQL（可选）" class="headerlink" title="安装MySQL（可选）"></a> 安装MySQL（可选）</h2><p>1、安装MySQL8，参考文档<a href="https://www.voidking.com/dev-docker-mysql/">好好学MySQL：使用Docker安装配置MySQL</a></p><p>2、创建一个数据库，名称为 oneapi</p><h2 id="安装-One-API"><span class="post-title-index">3.3.</span><a href="#安装-One-API" class="headerlink" title="安装 One API"></a> 安装 One API</h2><p>1、下载 one-api 镜像</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull justsong/one-api:v0.6.10-alpha.1</span><br></pre></td></tr></table></figure><p>2、运行 one-api 容器<br>使用SQLite数据库：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run --name one-api -d \</span><br><span class="line">  --restart always \</span><br><span class="line">  -p 3000:3000 \</span><br><span class="line">  -e TZ=Asia/Shanghai \</span><br><span class="line">  -v /opt/one-api/data:/data \</span><br><span class="line">  justsong/one-api:v0.6.11-alpha.8</span><br></pre></td></tr></table></figure><p>备用镜像地址：<code>ghcr.io/songquanpeng/one-api:v0.6.11-alpha.8</code></p><p>使用MySQL数据库：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker run --name one-api -d \</span><br><span class="line">  --restart always \</span><br><span class="line">  -p 3000:3000 \</span><br><span class="line">  -e SQL_DSN=<span class="string">&quot;root:123456@tcp(localhost:3306)/oneapi&quot;</span> \</span><br><span class="line">  -e TZ=Asia/Shanghai \</span><br><span class="line">  -v /opt/one-api/data:/data \</span><br><span class="line">  justsong/one-api:v0.6.11-alpha.8</span><br></pre></td></tr></table></figure><p>其中，SQL_DSN的值要改成自己的MySQL配置。</p><p>3、查看容器状态</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker ps | grep one-api</span><br><span class="line">docker logs one-api</span><br></pre></td></tr></table></figure><h2 id="配置Nginx"><span class="post-title-index">3.4.</span><a href="#配置Nginx" class="headerlink" title="配置Nginx"></a> 配置Nginx</h2><p>参考配置：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">server&#123;</span><br><span class="line">  server_name oneapi.voidking.com;  # 请根据实际情况修改你的域名</span><br><span class="line"></span><br><span class="line">  location / &#123;</span><br><span class="line">    client_max_body_size  64m;</span><br><span class="line">    proxy_http_version 1.1;</span><br><span class="line">    proxy_pass http://localhost:3000;  # 请根据实际情况修改你的端口</span><br><span class="line">    proxy_set_header Host $host;</span><br><span class="line">    proxy_set_header X-Forwarded-For $remote_addr;</span><br><span class="line">    proxy_cache_bypass $http_upgrade;</span><br><span class="line">    proxy_set_header Accept-Encoding gzip;</span><br><span class="line">    proxy_read_timeout 300s;  # GPT-4 需要较长的超时时间，请自行调整</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="使用-One-API"><span class="post-title-index">4.</span><a href="#使用-One-API" class="headerlink" title="使用 One API"></a> 使用 One API</h1><h2 id="登录-One-API"><span class="post-title-index">4.1.</span><a href="#登录-One-API" class="headerlink" title="登录 One API"></a> 登录 One API</h2><p>1、使用 <code>IP+端口</code> 或者 <code>域名</code> 访问 One API 首页</p><p>2、点击页面右上角 登录，登录进入管理页面<br>默认用户名为 <code>root</code> ，密码为 <code>123456</code>，登录后请先修改密码</p><h2 id="系统配置"><span class="post-title-index">4.2.</span><a href="#系统配置" class="headerlink" title="系统配置"></a> 系统配置</h2><h3 id="配置服务器地址"><span class="post-title-index">4.2.1.</span><a href="#配置服务器地址" class="headerlink" title="配置服务器地址"></a> 配置服务器地址</h3><p>1、点击设置</p><p>2、配置服务器地址<br>该地址要和配置的域名一致。</p><h3 id="配置用户登录和注册方式"><span class="post-title-index">4.2.2.</span><a href="#配置用户登录和注册方式" class="headerlink" title="配置用户登录和注册方式"></a> 配置用户登录和注册方式</h3><p>1、点击设置</p><p>2、配置登录注册部分，选择登录和注册方式</p><p>3、配置邮箱域名白名单</p><h2 id="配置渠道"><span class="post-title-index">4.3.</span><a href="#配置渠道" class="headerlink" title="配置渠道"></a> 配置渠道</h2><p>1、点击渠道，添加新的渠道</p><p>2、填入渠道信息</p><ul><li>选择类型</li><li>填入名称</li><li>选择分组</li><li>选择模型或者填入模型</li><li>填入密钥</li><li>部分类型需要填入 base_url</li><li>填入模型重定向（可选）</li></ul><p>填入的模型，其实是oneapi中的模型名，默认与真实模型名相同。如果oneapi中的模型名，与真实模型名不同，那么可以配置模型重定向。<br>例如：oneapi中模型名是 gpt3.5-test，真实模型名是 gpt-3.5-turbo-16k ，那么模型重定向配置如下</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;gpt3.5-test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gpt-3.5-turbo-16k&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>3、提交，并点击测试</p><p>注意：根据个人经验，添加渠道并且测试成功后，并不能立刻通过API调用。<br>如果立刻调用，会报错：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openai.InternalServerError: Error code: 503 - &#123;&#x27;error&#x27;: &#123;&#x27;message&#x27;: &#x27;当前分组 default 下对于模型 xxx 无可用渠道 (request id: xxx)&#x27;, &#x27;type&#x27;: &#x27;one_api_error&#x27;&#125;&#125;</span><br></pre></td></tr></table></figure><p>需要等待2到3分钟，再进行API调用才会正常，也许是oneapi的什么机制。</p><h2 id="配置额度"><span class="post-title-index">4.4.</span><a href="#配置额度" class="headerlink" title="配置额度"></a> 配置额度</h2><p>1、点击用户，选择某一个用户，编辑</p><p>2、剩余额度填入 token 数，会自动显示等价金额<br>100000 token，等价金额 0.2 刀</p><p>3、提交</p><h2 id="配置令牌"><span class="post-title-index">4.5.</span><a href="#配置令牌" class="headerlink" title="配置令牌"></a> 配置令牌</h2><p>1、用户登录 One API</p><p>2、点击令牌，添加新的令牌</p><p>3、填入令牌信息</p><ul><li>名称</li><li>模型范围</li><li>IP限制</li><li>过期时间</li><li>额度</li></ul><p>4、提交</p><p>5、复制 token<br>找到新创建的令牌，点击复制，就可以获取到 token<br>注意：该 token 对应的 base_url 是我们配置的域名 <code>https://oneapi.voidking.com/v1</code></p><p>6、聊天<br>找到新创建的令牌，点击聊天，会自动跳转到 <a target="_blank" rel="noopener" href="https://app.nextchat.dev/#/">NextChat</a>，同时提示自动填入 base_url 和 token，点击确定，就可以使用 One API 代理进行聊天了。</p><h1 id="模型价格与倍率"><span class="post-title-index">5.</span><a href="#模型价格与倍率" class="headerlink" title="模型价格与倍率"></a> 模型价格与倍率</h1><p>参考文档：</p><ul><li><a target="_blank" rel="noopener" href="https://github.com/songquanpeng/one-api/?tab=readme-ov-file#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98">one-api 常见问题</a></li><li><a target="_blank" rel="noopener" href="https://linux.do/t/topic/79867">oneapi倍率讨论</a></li><li><a target="_blank" rel="noopener" href="https://shabi.uk/">倍率计算器</a></li></ul><p>模型倍率和补全倍率算法：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">基准价格：0.002 $ /1k tokens</span><br><span class="line">模型倍率 = 输入价格 / 基准价格</span><br><span class="line">补全倍率 = 输出价格 / 输入价格</span><br></pre></td></tr></table></figure><p>假设X模型的价格为 <code>$0.18/M input tokens</code> 和 <code>$0.72/M output tokens</code>，那么它的模型倍率和补全倍率如下：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">模型倍率 = 输入价格 / 基准价格 = (0.18/1000) / 0.002 = 0.09</span><br><span class="line">补全倍率 = 输出价格 / 输入价格 = 0.72 / 0.18 = 4</span><br></pre></td></tr></table></figure><p>在oneapi代码中，在计算费用时，涉及到变量包括：</p><ul><li>model_name：模型名（针对模型名配置模型倍率和补全倍率）</li><li>base_price：基准价格，<code>0.002 $ /1k tokens</code></li><li>prompt_tokens：提示词token数</li><li>completion_tokens：返回token数</li><li>model_ratio：模型倍率</li><li>completion_ratio：补全倍率</li><li>group_ratio：分组倍率（针对不同用户类型，控制打折或溢价）</li><li>quota：某个大模型的提示词token数和返回token数，换算成基准价格token数</li></ul><p>变量关系如下：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">quota = ((prompt_tokens * model_ratio) + (completion_ratio * model_ratio * completion_ratio)) * group_ratio</span><br></pre></td></tr></table></figure><p>最终费用为：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cost = quota * base_price = quota * (0.002/1000)</span><br></pre></td></tr></table></figure><h1 id="API-调用-One-API"><span class="post-title-index">6.</span><a href="#API-调用-One-API" class="headerlink" title="API 调用 One API"></a> API 调用 One API</h1><p>参考文档：</p><ul><li><a target="_blank" rel="noopener" href="https://platform.openai.com/docs/quickstart">OpenAI - Developer quickstart</a></li><li><a target="_blank" rel="noopener" href="https://openrouter.ai/docs/quickstart">OpenRouter - Quickstart</a></li></ul><h2 id="curl调用测试"><span class="post-title-index">6.1.</span><a href="#curl调用测试" class="headerlink" title="curl调用测试"></a> curl调用测试</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">curl <span class="string">&quot;https://oneapi.voidking.com/v1/chat/completions&quot;</span> \</span><br><span class="line">    -H <span class="string">&quot;Content-Type: application/json&quot;</span> \</span><br><span class="line">    -H <span class="string">&quot;Authorization: Bearer &lt;ONE_API_KEY&gt;&quot;</span> \</span><br><span class="line">    -d <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">        &quot;model&quot;: &quot;gpt-3.5-turbo-16k&quot;,</span></span><br><span class="line"><span class="string">        &quot;messages&quot;: [</span></span><br><span class="line"><span class="string">            &#123;</span></span><br><span class="line"><span class="string">                &quot;role&quot;: &quot;user&quot;,</span></span><br><span class="line"><span class="string">                &quot;content&quot;: &quot;hello!&quot;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">        ]</span></span><br><span class="line"><span class="string">    &#125;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="python调用测试"><span class="post-title-index">6.2.</span><a href="#python调用测试" class="headerlink" title="python调用测试"></a> python调用测试</h2><p>1、编写测试脚本 test.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> openai <span class="keyword">import</span> OpenAI</span><br><span class="line"></span><br><span class="line">client = OpenAI(</span><br><span class="line">  base_url=<span class="string">&quot;https://oneapi.voidking.com/v1&quot;</span>,</span><br><span class="line">  api_key=<span class="string">&quot;&lt;ONE_API_KEY&gt;&quot;</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">completion = client.chat.completions.create(</span><br><span class="line">  model=<span class="string">&quot;gpt-3.5-turbo-16k&quot;</span>,</span><br><span class="line">  messages=[</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>,</span><br><span class="line">      <span class="string">&quot;content&quot;</span>: <span class="string">&quot;hello!&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(completion.choices[<span class="number">0</span>].message.content)</span><br></pre></td></tr></table></figure><p>2、运行脚本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python test.py</span><br></pre></td></tr></table></figure></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 好好学习的郝</li><li class="post-copyright-link"> <strong>原文链接：</strong> <a href="https://www.voidking.com/dev-one-api-start/" title="LLM 接口管理和分发系统 One API">https://www.voidking.com/dev-one-api-start/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本文采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议，转载请注明出处！源站会即时更新知识点并修正错误，欢迎访问~</li></ul></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/docker/" rel="tag"># docker</a> <a href="/tags/chatgpt/" rel="tag"># chatgpt</a> <a href="/tags/aigc/" rel="tag"># aigc</a> <a href="/tags/llm/" rel="tag"># llm</a> <a href="/tags/one-api/" rel="tag"># one-api</a></div><div class="post-nav"><div class="post-nav-item"><a href="/dev-k8s-leader-election/" rel="prev" title="好好学K8S：K8S中的Leader Election机制"><i class="fa fa-chevron-left"></i> 好好学K8S：K8S中的Leader Election机制</a></div><div class="post-nav-item"> <a href="/dev-one-api-develop/" rel="next" title="One API 开发环境配置">One API 开发环境配置<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><div class="footer-ads" style="margin-top:10px"></div><div class="comments" id="gitalk-container"></div><script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#One-API%E7%AE%80%E4%BB%8B"><span class="nav-text">1. One API简介</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#One-API%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD"><span class="nav-text">2. One API核心功能</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE-One-API"><span class="nav-text">3. 安装配置 One API</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE-One-API-%E6%A6%82%E8%BF%B0"><span class="nav-text">3.1. 安装配置 One API 概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85MySQL%EF%BC%88%E5%8F%AF%E9%80%89%EF%BC%89"><span class="nav-text">3.2. 安装MySQL（可选）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85-One-API"><span class="nav-text">3.3. 安装 One API</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AENginx"><span class="nav-text">3.4. 配置Nginx</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-One-API"><span class="nav-text">4. 使用 One API</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%99%BB%E5%BD%95-One-API"><span class="nav-text">4.1. 登录 One API</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B3%BB%E7%BB%9F%E9%85%8D%E7%BD%AE"><span class="nav-text">4.2. 系统配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9C%B0%E5%9D%80"><span class="nav-text">4.2.1. 配置服务器地址</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E5%92%8C%E6%B3%A8%E5%86%8C%E6%96%B9%E5%BC%8F"><span class="nav-text">4.2.2. 配置用户登录和注册方式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E6%B8%A0%E9%81%93"><span class="nav-text">4.3. 配置渠道</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E9%A2%9D%E5%BA%A6"><span class="nav-text">4.4. 配置额度</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E4%BB%A4%E7%89%8C"><span class="nav-text">4.5. 配置令牌</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%A8%A1%E5%9E%8B%E4%BB%B7%E6%A0%BC%E4%B8%8E%E5%80%8D%E7%8E%87"><span class="nav-text">5. 模型价格与倍率</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#API-%E8%B0%83%E7%94%A8-One-API"><span class="nav-text">6. API 调用 One API</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#curl%E8%B0%83%E7%94%A8%E6%B5%8B%E8%AF%95"><span class="nav-text">6.1. curl调用测试</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#python%E8%B0%83%E7%94%A8%E6%B5%8B%E8%AF%95"><span class="nav-text">6.2. python调用测试</span></a></li></ol></li></ol></div></div><div class="sidecar-ads" style="margin-top:10px"><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="好好学习的郝" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">好好学习的郝</p><div class="site-description" itemprop="description">一个计算机技术爱好者与学习者</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">779</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">34</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">271</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:voidking@qq.com" title="E-Mail → mailto:voidking@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://github.com/voidking" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="http://weibo.com/voidking" title="Weibo → http:&#x2F;&#x2F;weibo.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i> Weibo</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/voidking" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-quora"></i> Zhihu</a></span></div></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2014 – <span itemprop="copyrightYear">2026</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">好好学习的郝</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="footer-beian"> <a href="http://beian.miit.gov.cn/" target="_blank">苏ICP备14021030号</a>&nbsp;|&nbsp; <img src="/images/beian.png" alt=""> <a target="_blank" href="http://www.beian.gov.cn/">苏公网安备 32032202000223号</a></div></div></footer></div><script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><link rel="stylesheet" href="https://cdn.staticfile.net/gitalk/1.7.2/gitalk.min.css"><script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('https://cdn.staticfile.net/gitalk/1.7.2/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: '5a238b8c32b1e4dd2156',
      clientSecret: 'bfb5d518626f6fdc7da0351d1e0cd37ab75c6361',
      repo: 'gitalk-comments',
      owner: 'voidking',
      admin: ['voidking'],
      id: '6f784442fb8fe701750ae9ed35dfeea4',
      title: 'LLM 接口管理和分发系统 One API',
      body: '欢迎留言，互相交流学习~',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script></body></html>