<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:new URL("https://www.voidking.com").hostname,root:"/",scheme:"Gemini",version:"7.7.1",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1,cdn:{enable:!0,url:"//qiniu-cdn.voidking.com/doc/search.xml"}},path:"search.xml",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="Ansible简介ansible是一个用于自动化运维的配置管理和应用部署工具。基于Python开发，集合了众多运维工具（puppet、cfengine、chef、func、fabric.SaltStack ）的优点，实现了批量系统配置、批量程序部署、批量运行命令等功能。ansible是基于模块工作的，本身没有批量部署的能力，真正具有批量部署能力的是ansible所运行的模块。 ansible的基本"><meta property="og:type" content="article"><meta property="og:title" content="Ansible入门篇"><meta property="og:url" content="https://www.voidking.com/dev-ansible-start/index.html"><meta property="og:site_name" content="好好学习的郝"><meta property="og:description" content="Ansible简介ansible是一个用于自动化运维的配置管理和应用部署工具。基于Python开发，集合了众多运维工具（puppet、cfengine、chef、func、fabric.SaltStack ）的优点，实现了批量系统配置、批量程序部署、批量运行命令等功能。ansible是基于模块工作的，本身没有批量部署的能力，真正具有批量部署能力的是ansible所运行的模块。 ansible的基本"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2018-08-06T09:00:00.000Z"><meta property="article:modified_time" content="2023-07-16T08:00:00.000Z"><meta property="article:author" content="好好学习的郝"><meta property="article:tag" content="linux"><meta property="article:tag" content="ubuntu"><meta property="article:tag" content="ansible"><meta property="article:tag" content="ssh"><meta property="article:tag" content="sshpass"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://www.voidking.com/dev-ansible-start/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0}</script><title>Ansible入门篇 | 好好学习的郝</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?b759ac2a7fa45129e3ef060bf68259f0";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="好好学习的郝" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">好好学习的郝</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">一个计算机技术爱好者与学习者</h1></div><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/voidking" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.voidking.com/dev-ansible-start/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="好好学习的郝"><meta itemprop="description" content="一个计算机技术爱好者与学习者"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="好好学习的郝"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> Ansible入门篇</h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2018-08-06 09:00:00" itemprop="dateCreated datePublished" datetime="2018-08-06T09:00:00+00:00">2018-08-06</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2023-07-16 08:00:00" itemprop="dateModified" datetime="2023-07-16T08:00:00+00:00">2023-07-16</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/" itemprop="url" rel="index"><span itemprop="name">engineering</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/devops/" itemprop="url" rel="index"><span itemprop="name">devops</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="Ansible简介"><span class="post-title-index">1.</span><a href="#Ansible简介" class="headerlink" title="Ansible简介"></a> Ansible简介</h1><p>ansible是一个用于自动化运维的配置管理和应用部署工具。基于Python开发，集合了众多运维工具（puppet、cfengine、chef、func、fabric.SaltStack ）的优点，实现了批量系统配置、批量程序部署、批量运行命令等功能。ansible是基于模块工作的，本身没有批量部署的能力，真正具有批量部署能力的是ansible所运行的模块。</p><p>ansible的基本架构：</p><ul><li>连接插件（connectior plugins）用于连接管理端和被管理端。</li><li>核心模块（core modules）连接主机实现操作，它依赖于具体的模块来做具体的事情。</li><li>自定义模块（custom modules）根据自己的需求编写具体的模块。</li><li>插件（plugins）完成模块功能的补充。</li><li>剧本（playbooks）ansible的配置文件，将多个任务定义在剧本中，由ansible自动执行。</li><li>主机清单（host inventory）定义ansible需要操作主机的范围。</li></ul><p>上述简介摘自<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/575ced3a08fa">ansible基础</a>。</p><p>参考文档：</p><ul><li><a target="_blank" rel="noopener" href="https://docs.ansible.com/">Ansible Documentation</a></li><li><a target="_blank" rel="noopener" href="http://www.ansible.com.cn/">Ansible中文权威指南</a></li><li><a target="_blank" rel="noopener" href="http://study.163.com/course/introduction.htm?courseId=1004525015">Ansible精讲</a></li><li><a target="_blank" rel="noopener" href="http://blog.51cto.com/191226139/2066936">运维自动化-Ansible ( 一 )</a></li><li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/wangxiaoqiangs/p/5685239.html">Ansible 运维自动化 ( 配置管理工具 )</a></li></ul><span id="more"></span><h1 id="实验环境准备"><span class="post-title-index">2.</span><a href="#实验环境准备" class="headerlink" title="实验环境准备"></a> 实验环境准备</h1><p>两台主机，都是ubuntu14.04.4 server版，用户都是voidking。一台作为管理机，IP为192.168.56.101，一台作为被管理机（以下称为客户机），IP为192.168.56.102。</p><p>在管理机上安装ansible，一条命令搞定：<code>sudo apt install ansible</code>。<br>不过，安装的ansible版本很低，默认1.5.4。这里我们通过添加源来安装最新版ansible：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt remove ansible</span><br><span class="line"><span class="built_in">sudo</span> apt-get install software-properties-common</span><br><span class="line"><span class="built_in">sudo</span> apt-add-repository ppa:ansible/ansible</span><br><span class="line"><span class="built_in">sudo</span> apt-get update</span><br><span class="line"><span class="built_in">sudo</span> apt-get install ansible</span><br></pre></td></tr></table></figure><p>或者，使用pip安装指定版本的ansible，本文选择安装 <code>2.6.11</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> pip install ansible==2.6.11 -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br></pre></td></tr></table></figure><p>想要知道都有哪些版本，可以查看<a target="_blank" rel="noopener" href="https://releases.ansible.com/ansible">ansible版本列表</a></p><p>PS：如果是centos系统，还可以下载<a target="_blank" rel="noopener" href="https://releases.ansible.com/ansible/rpm/release/epel-7-x86_64/">ansible rpm包</a>，通过rmp命令安装 <code>rpm -ivh ansible-2.6.11-1.el7.ans.noarch.rpm</code></p><h1 id="连接准备"><span class="post-title-index">3.</span><a href="#连接准备" class="headerlink" title="连接准备"></a> 连接准备</h1><p>1、在管理机生成密钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen</span><br></pre></td></tr></table></figure><p>连续回车即可。</p><p>2、将公钥写入客户机</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-copy-id -i .ssh/id_rsa.pub -p 22 voidking@192.168.56.102</span><br></pre></td></tr></table></figure><p>3、在管理机添加客户机到hosts</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> vim /etc/ansible/hosts</span><br></pre></td></tr></table></figure><p>在文档最后添加：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[commonservers]</span><br><span class="line">192.168.56.102</span><br></pre></td></tr></table></figure><p>4、在管理机执行第一条命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible all -m ping</span><br></pre></td></tr></table></figure><p>5、在客户机把voidking用户添加进sudo免密，方便以后的操作</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> vim /etc/sudoers</span><br></pre></td></tr></table></figure><p>添加</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">voidking ALL = NOPASSWD: ALL</span><br></pre></td></tr></table></figure><h1 id="Ansible程序说明"><span class="post-title-index">4.</span><a href="#Ansible程序说明" class="headerlink" title="Ansible程序说明"></a> Ansible程序说明</h1><h2 id="程序-命令列表"><span class="post-title-index">4.1.</span><a href="#程序-命令列表" class="headerlink" title="程序/命令列表"></a> 程序/命令列表</h2><ul><li>ansible：主程序，临时命令执行工具</li><li>ansible-doc：查看配置文档，模块功能查看工具</li><li>ansible-galaxy：下载/上传优秀代码或Roles模块的官网平台</li><li>ansible-lint：对playbook的语法进行检查的一个工具</li><li>ansible-playbook：定制自动化任务，编排剧本工具</li><li>ansible-pull：远程执行命令的工具</li><li>ansible-vault：文件加密工具</li><li>ansible-console：基于console界面与用户交互的执行工具</li></ul><p>其中，最重要和最常用的是ansible。</p><h2 id="ansible命令详解"><span class="post-title-index">4.2.</span><a href="#ansible命令详解" class="headerlink" title="ansible命令详解"></a> ansible命令详解</h2><p>ansible命令是ansible套装的核心部分，其主要用于执行ad-hoc命令，即单条命令。默认后面需要跟主机和选项部分，默认不指定模块时，使用的是command模块。command模块不是调用的shell的指令，所以没有bash的环境变量，也不能使用shell的一些操作方式，其他和shell模块没有区别。</p><p>格式：<code>ansible &lt;host-pattern&gt; [-m module_name] [options]</code></p><p>参数列表：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">ansible [-h] [--version] [-v] [-b] [--become-method BECOME_METHOD]</span><br><span class="line">        [--become-user BECOME_USER]</span><br><span class="line">        [-K | --become-password-file BECOME_PASSWORD_FILE]</span><br><span class="line">        [-i INVENTORY] [--list-hosts] [-l SUBSET] [-P POLL_INTERVAL]</span><br><span class="line">        [-B SECONDS] [-o] [-t TREE] [--private-key PRIVATE_KEY_FILE]</span><br><span class="line">        [-u REMOTE_USER] [-c CONNECTION] [-T TIMEOUT]</span><br><span class="line">        [--ssh-common-args SSH_COMMON_ARGS]</span><br><span class="line">        [--sftp-extra-args SFTP_EXTRA_ARGS]</span><br><span class="line">        [--scp-extra-args SCP_EXTRA_ARGS]</span><br><span class="line">        [--ssh-extra-args SSH_EXTRA_ARGS]</span><br><span class="line">        [-k | --connection-password-file CONNECTION_PASSWORD_FILE] [-C]</span><br><span class="line">        [--syntax-check] [-D] [-e EXTRA_VARS] [--vault-id VAULT_IDS]</span><br><span class="line">        [--ask-vault-password | --vault-password-file VAULT_PASSWORD_FILES]</span><br><span class="line">        [-f FORKS] [-M MODULE_PATH] [--playbook-dir BASEDIR]</span><br><span class="line">        [--task-timeout TASK_TIMEOUT] [-a MODULE_ARGS] [-m MODULE_NAME]</span><br><span class="line">        pattern</span><br></pre></td></tr></table></figure><p>常用参数：</p><ul><li>-m：指定模块</li><li>-a：指定参数</li><li>-i：指定主机列表</li></ul><p>例子：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看主机清单中的所有主机</span></span><br><span class="line">ansible all --list-hosts</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定主机清单，查看主机清单中的所有主机</span></span><br><span class="line">ansible all -i ./hosts --list-hosts</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看commonservers组的主机</span></span><br><span class="line">ansible commonservers --list-hosts</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试连通</span></span><br><span class="line">ansible all -m ping</span><br><span class="line"></span><br><span class="line"><span class="comment"># 单台主机执行命令</span></span><br><span class="line">ansible all -i <span class="string">&quot;192.168.56.102,&quot;</span> -m ping</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看客户机的内存</span></span><br><span class="line">ansible all -m <span class="built_in">command</span> -a <span class="string">&quot;free -h&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在客户机执行管理机脚本</span></span><br><span class="line"><span class="built_in">cp</span> /bin/echo ~/echo.sh</span><br><span class="line">ansible all -m script -a <span class="string">&quot;~/echo.sh hello&quot;</span> -vvv</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在客户机执行客户机脚本</span></span><br><span class="line">ansible all -m <span class="built_in">command</span> -a <span class="string">&quot;cp /bin/echo /home/voidking/echo.sh&quot;</span></span><br><span class="line">ansible all -m shell -a <span class="string">&quot;/home/voidking/echo.sh hello&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 向客户机拷贝文件</span></span><br><span class="line">ansible all -m copy -a <span class="string">&quot;src=/home/voidking/echo.sh dest=/tmp/ owner=voidking group=voidking mode=0755&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 后台执行命令</span></span><br><span class="line">ansible all -m ping -B 3600 -P 0</span><br><span class="line">ansible all -m async_status -a <span class="string">&quot;jid=&#x27;182829279182.2094&#x27;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 批量添加sudo权限</span></span><br><span class="line">ansible all -i hosts -s -m shell -a <span class="string">&quot;echo &#x27;haojin ALL=(ALL) NOPASSWD: ALL&#x27; &gt;&gt; /etc/sudoers&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 批量移除sudo权限</span></span><br><span class="line">ansible all -i hosts -s -m shell -a <span class="string">&quot;sed -i &#x27;/haojin ALL=(ALL) NOPASSWD: ALL/d&#x27; /etc/sudoers&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用root用户备份和拷贝文件</span></span><br><span class="line">ansible all -i hosts -s -m shell -a <span class="string">&quot;mv /tmp/run.sh /tmp/run.sh.bak&quot;</span></span><br><span class="line">ansible all -i hosts -b --become-user=root -m shell -a <span class="string">&quot;mv /tmp/run.sh /tmp/run.sh.bak&quot;</span></span><br><span class="line">ansible all -i hosts -s -m copy -a <span class="string">&quot;src=/root/run.sh dest=/tmp/run.sh owner=voidking group=root mode=0755&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 重启服务</span></span><br><span class="line">ansible all -i hosts -s -m shell -a <span class="string">&quot;/tmp/stop.sh&quot;</span></span><br><span class="line">ansible all -i hosts -s -m shell -a <span class="string">&quot;/tmp/run.sh&quot;</span> -u voidking</span><br></pre></td></tr></table></figure><h2 id="配置文件"><span class="post-title-index">4.3.</span><a href="#配置文件" class="headerlink" title="配置文件"></a> 配置文件</h2><ul><li>/etc/ansible/ansible.cfg，主配置文件，配置ansible工作特性</li><li>/etc/ansible/hosts，主机清单</li><li>/etc/ansible/roles/，存放角色的目录</li></ul><p>1、ansible.cfg的配置参考<a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/installation_guide/intro_configuration.html">Configuring Ansible</a>，主要关注inventory、forks、poll_interval、remote_port、log_path等参数。</p><p>2、hosts文件有一个特性很棒，可以指定变量，例如：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[commonservers]</span><br><span class="line">192.168.56.102</span><br><span class="line">[commonservers:vars]</span><br><span class="line">ansible_ssh_pass=&#x27;123456&#x27;</span><br><span class="line">ansible_ssh_port=22</span><br><span class="line"></span><br><span class="line">[commonservers1]</span><br><span class="line">192.168.56.103</span><br><span class="line">[commonservers:children]</span><br><span class="line">commonservers1</span><br></pre></td></tr></table></figure><p>如果在hosts文件中指定了用户名和密码，使用时报错 to use the ‘ssh’ connection type with passwords, you must install the sshpass program<br>那么需要先安装sshpass，安装命令为：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ubuntu</span></span><br><span class="line">apt-get install sshpass</span><br><span class="line"><span class="comment"># centos</span></span><br><span class="line">yum install epel-release -y</span><br><span class="line">yum install sshpass -y</span><br></pre></td></tr></table></figure><p>sshpass可以实现免交互指定密码登录机器，使用方法为：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sshpass -p xxx ssh ubuntu@192.168.56.102</span><br></pre></td></tr></table></figure><h2 id="ansible内置变量小结"><span class="post-title-index">4.4.</span><a href="#ansible内置变量小结" class="headerlink" title="ansible内置变量小结"></a> ansible内置变量小结</h2><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># 主机名</span><br><span class="line">ansible_ssh_host </span><br><span class="line"># 端口号</span><br><span class="line">ansible_ssh_port</span><br><span class="line"># 用户名 </span><br><span class="line">ansible_ssh_user </span><br><span class="line"># 密码</span><br><span class="line">ansible_ssh_pass </span><br><span class="line"># 使用sudo连接用户时的密码</span><br><span class="line">ansible_sudo_pass </span><br><span class="line"># 秘钥文件如果不想使用ssh-agent管理时可以使用此选项</span><br><span class="line">ansible_ssh_private_key_file </span><br><span class="line"># shell的类型默认sh</span><br><span class="line">ansible_shell_type </span><br><span class="line"># SSH 连接的类型</span><br><span class="line">ansible_connection </span><br><span class="line"># 指定python解释器的路径</span><br><span class="line">ansible_python_interpreter </span><br></pre></td></tr></table></figure><h2 id="ansible-doc"><span class="post-title-index">4.5.</span><a href="#ansible-doc" class="headerlink" title="ansible-doc"></a> ansible-doc</h2><p>格式：<code>ansible-doc [options] [module...]</code></p><p>例子：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ansible-doc ping</span><br><span class="line">ansible-doc -s ping</span><br><span class="line">ansible-doc -l</span><br><span class="line">ansible-doc -a</span><br></pre></td></tr></table></figure><h2 id="主机通配符"><span class="post-title-index">4.6.</span><a href="#主机通配符" class="headerlink" title="主机通配符"></a> 主机通配符</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 匹配所有主机，相当于all</span></span><br><span class="line">ansible <span class="string">&#x27;*&#x27;</span> -m ping</span><br><span class="line"><span class="comment"># 匹配含有common的主机组</span></span><br><span class="line">ansible <span class="string">&#x27;*common*&#x27;</span> -m ping</span><br><span class="line"><span class="comment"># 匹配IP为100-109的主机</span></span><br><span class="line">ansible <span class="string">&#x27;192.168.56.10?&#x27;</span> -m ping</span><br><span class="line"><span class="comment"># 匹配IP段</span></span><br><span class="line">ansible <span class="string">&#x27;192.168.56.101:192.168.56.200&#x27;</span> -m ping</span><br><span class="line"><span class="comment"># 逻辑与</span></span><br><span class="line">ansible <span class="string">&#x27;commonservers:&amp;dbservers&#x27;</span> --list</span><br><span class="line"><span class="comment"># 逻辑非</span></span><br><span class="line">ansible <span class="string">&#x27;commonservers:!dbservers&#x27;</span> --list</span><br><span class="line"><span class="comment"># 正则表达式</span></span><br><span class="line">ansible <span class="string">&#x27;~192\.168\.56\.[1-254]&#x27;</span> --list</span><br></pre></td></tr></table></figure><h2 id="常用模块"><span class="post-title-index">4.7.</span><a href="#常用模块" class="headerlink" title="常用模块"></a> 常用模块</h2><ul><li>command：在客户机运行命令</li><li>shell：在客户机shell进程下运行命令，支持shell特性，如管道等</li><li>copy：从管理机拷贝文件到客户机</li><li>fetch：从客户机获取文件</li><li>file：设置文件属性</li><li>yum：centos软件包管理</li><li>service：服务管理</li><li>script：执行脚本</li><li>user：用户管理</li><li>cron：crontab管理</li></ul><p>shell比command更强大，command比shell更安全。因为command不支持重定向、管道等，避免了shell注入的风险。</p><h1 id="指定ansible-cfg"><span class="post-title-index">5.</span><a href="#指定ansible-cfg" class="headerlink" title="指定ansible.cfg"></a> 指定ansible.cfg</h1><p>如果ansible没有指定ansible.cfg，或者想要临时使用自己定义的ansible.cfg，该怎么处理？</p><p>1、参考<a target="_blank" rel="noopener" href="https://github.com/ansible/ansible/blob/devel/examples/ansible.cfg">ansible.cfg</a>，创建ansible.cfg文件，假设路径为 /home/voidking/ansible.cfg</p><p>2、设置环境变量</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> ANSIBLE_CONFIG=/home/voidking/ansible.cfg</span><br></pre></td></tr></table></figure><p>3、查看配置</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible --version</span><br></pre></td></tr></table></figure><h1 id="批量推送公钥"><span class="post-title-index">6.</span><a href="#批量推送公钥" class="headerlink" title="批量推送公钥"></a> 批量推送公钥</h1><p>在本文的一开始，我们通过<code>ssh-copy-id</code>命令把管理机的公钥推送给了客户机。<br>如果客户机有几百个，肯定不能再手动搞了，这时可以使用ansible的<code>authorized_key</code>模块来实现推送。</p><p>1、创建hosts文件，把所有客户机都添加进去</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">192.168.56.102</span><br><span class="line">192.168.56.103</span><br><span class="line">192.168.56.104</span><br><span class="line">[common:vars]</span><br><span class="line">ansible_ssh_user=&quot;voidking&quot;</span><br><span class="line">ansible_ssh_pass=&quot;123456&quot;</span><br></pre></td></tr></table></figure><p>2、配置忽略host_key_checking</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ansible/ansible.cfg</span><br></pre></td></tr></table></figure><p>去掉 <code>host_key_checking = False</code> 的注释</p><p>3、测试连通性</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible all -i hosts -m ping</span><br></pre></td></tr></table></figure><p>4、编写剧本 ssh-copy.yaml</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">common</span>    </span><br><span class="line">  <span class="attr">remote_user:</span> <span class="string">voidking</span></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">authorized_key:</span></span><br><span class="line">     <span class="attr">user:</span> <span class="string">voidking</span></span><br><span class="line">     <span class="attr">key:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; lookup(&#x27;file&#x27;, &#x27;/home/voidking/.ssh/id_rsa.pub&#x27;) &#125;&#125;</span>&quot;</span></span><br></pre></td></tr></table></figure><p>5、推送公钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible-playbook -i hosts ssh-copy.yaml</span><br></pre></td></tr></table></figure><p>6、验证</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh voidking@192.168.56.102</span><br></pre></td></tr></table></figure><h1 id="ssh-agent"><span class="post-title-index">7.</span><a href="#ssh-agent" class="headerlink" title="ssh-agent"></a> ssh-agent</h1><p>ansible可能使用到ssh-agent，那就顺便学习一下，参考<a target="_blank" rel="noopener" href="http://www.zsythink.net/archives/2407">了解ssh代理：ssh-agent</a>。</p><p>ssh-agent是ssh代理程序，ssh-agent可以帮助我们管理私钥。</p><p>那么什么时候需要ssh代理帮助我们管理私钥呢？当遇到如下情况时，我们会需要ssh代理。</p><ul><li>使用不同的密钥连接到不同的主机时，需要手动指定对应的密钥，ssh代理可以帮助我们选择对应的密钥进行认证，不用手动指定密钥即可进行连接。</li><li>当私钥设置了密码，我们又需要频繁的使用私钥进行认证时，ssh代理可以帮助我们免去重复的输入密码的操作。</li><li>管理机可以通过密钥连接到客户机A和客户机B，但是客户机A无法通过密钥连接到客户机B，ssh代理可以帮助我们在客户机A也能通过密钥连接到客户机B。</li></ul><p>我们以添加.ssh/id_rsa私钥给ssh代理为例，查看一下使用流程。</p><p>1、启用ssh-agent<br><code>ssh-agent bash</code></p><p>2、把.ssh/id_rsa添加到ssh代理<br><code>ssh-add ~/.ssh/id_rsa</code></p><p>3、测试登录<br><code>ssh voidking@192.168.56.102</code><br>登录成功。<br>切换到root用户，ssh-agent失效。重新使用voidking登录，ssh-agent失效。想要重新登录依然生效，那就创建个脚本登录时自动执行。</p><p>常用命令：</p><ul><li><code>ssh-agent $SHELL</code>，启动</li><li><code>ssh-agent -k</code>，关闭</li><li><code>ssh-add ~/.ssh/key_name</code>，添加指定私钥</li><li><code>ssh-add -l</code>，查看私钥</li><li><code>ssh-add -L</code>，查看公钥</li><li><code>ssh-add -d /path/of/key/key_name</code>，删除指定私钥</li><li><code>ssh-add -D</code>，删除所有私钥</li><li><code>ssh-add -x</code>，设置密码，锁定ssh代理</li><li><code>ssh-add -X</code>，输入密码，解锁ssh代理</li></ul></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 好好学习的郝</li><li class="post-copyright-link"> <strong>原文链接：</strong> <a href="https://www.voidking.com/dev-ansible-start/" title="Ansible入门篇">https://www.voidking.com/dev-ansible-start/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本文采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议，转载请注明出处！源站会即时更新知识点并修正错误，欢迎访问~</li><li> <img width="200" height="200" src="/images/avatar.jpg"><p style="text-align:center;margin-bottom:0">微信公众号同步更新，欢迎关注~</p></li></ul></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/linux/" rel="tag"># linux</a> <a href="/tags/ubuntu/" rel="tag"># ubuntu</a> <a href="/tags/ansible/" rel="tag"># ansible</a> <a href="/tags/ssh/" rel="tag"># ssh</a> <a href="/tags/sshpass/" rel="tag"># sshpass</a></div><div class="post-nav"><div class="post-nav-item"><a href="/dev-kolla-instance-network/" rel="prev" title="Kolla配置实例网络"><i class="fa fa-chevron-left"></i> Kolla配置实例网络</a></div><div class="post-nav-item"> <a href="/dev-yaml/" rel="next" title="YAML语言">YAML语言<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><div class="footer-ads" style="margin-top:10px"><ins class="adsbygoogle" style="display:block" data-ad-format="autorelaxed" data-ad-client="ca-pub-3284447971731414" data-ad-slot="9697986181"></ins><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3284447971731414" crossorigin="anonymous"></script><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div class="comments" id="gitalk-container"></div><script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Ansible%E7%AE%80%E4%BB%8B"><span class="nav-text">1. Ansible简介</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="nav-text">2. 实验环境准备</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%BF%9E%E6%8E%A5%E5%87%86%E5%A4%87"><span class="nav-text">3. 连接准备</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Ansible%E7%A8%8B%E5%BA%8F%E8%AF%B4%E6%98%8E"><span class="nav-text">4. Ansible程序说明</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A8%8B%E5%BA%8F-%E5%91%BD%E4%BB%A4%E5%88%97%E8%A1%A8"><span class="nav-text">4.1. 程序&#x2F;命令列表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ansible%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3"><span class="nav-text">4.2. ansible命令详解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-text">4.3. 配置文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ansible%E5%86%85%E7%BD%AE%E5%8F%98%E9%87%8F%E5%B0%8F%E7%BB%93"><span class="nav-text">4.4. ansible内置变量小结</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ansible-doc"><span class="nav-text">4.5. ansible-doc</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%BB%E6%9C%BA%E9%80%9A%E9%85%8D%E7%AC%A6"><span class="nav-text">4.6. 主机通配符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97"><span class="nav-text">4.7. 常用模块</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%8C%87%E5%AE%9Aansible-cfg"><span class="nav-text">5. 指定ansible.cfg</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%89%B9%E9%87%8F%E6%8E%A8%E9%80%81%E5%85%AC%E9%92%A5"><span class="nav-text">6. 批量推送公钥</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ssh-agent"><span class="nav-text">7. ssh-agent</span></a></li></ol></div></div><div class="sidecar-ads" style="margin-top:10px"><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="好好学习的郝" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">好好学习的郝</p><div class="site-description" itemprop="description">一个计算机技术爱好者与学习者</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">744</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">32</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">258</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:voidking@qq.com" title="E-Mail → mailto:voidking@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://github.com/voidking" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="http://weibo.com/voidking" title="Weibo → http:&#x2F;&#x2F;weibo.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i> Weibo</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/voidking" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-quora"></i> Zhihu</a></span></div></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2014 – <span itemprop="copyrightYear">2024</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">好好学习的郝</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="footer-beian"> <a href="http://beian.miit.gov.cn/" target="_blank">苏ICP备14021030号</a>&nbsp;|&nbsp; <img src="/images/beian.png" alt=""> <a target="_blank" href="http://www.beian.gov.cn/">苏公网安备 32032202000223号</a></div></div></footer></div><script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.css"><script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: '5a238b8c32b1e4dd2156',
      clientSecret: 'bfb5d518626f6fdc7da0351d1e0cd37ab75c6361',
      repo: 'gitalk-comments',
      owner: 'voidking',
      admin: ['voidking'],
      id: '9a24dc1a71a4f8e5290526b4701c54da',
      title: 'Ansible入门篇',
      body: '欢迎留言，互相交流学习~',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script></body></html>