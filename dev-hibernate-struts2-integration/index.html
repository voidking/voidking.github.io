<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 4.2.1"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:new URL("https://www.voidking.com").hostname,root:"/",scheme:"Gemini",version:"7.7.1",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},path:"search.xml",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="应用实例：学生选课系统。要求：学生登录系统后，可以查看、修改个人信息，查看个人选课情况，选定课程及退选课程。 建立数据库和表小编仍然使用MySQL数据库，scott用户。在xscj数据库中建立登录表、学生表、专业表、课程表，以及学生课程表即连接表。 12345678910111213141516171819202122232425262728293031323334353637create tab"><meta property="og:type" content="article"><meta property="og:title" content="Hibernate与Struts2整合应用"><meta property="og:url" content="https://www.voidking.com/dev-hibernate-struts2-integration/index.html"><meta property="og:site_name" content="好好学习的郝"><meta property="og:description" content="应用实例：学生选课系统。要求：学生登录系统后，可以查看、修改个人信息，查看个人选课情况，选定课程及退选课程。 建立数据库和表小编仍然使用MySQL数据库，scott用户。在xscj数据库中建立登录表、学生表、专业表、课程表，以及学生课程表即连接表。 12345678910111213141516171819202122232425262728293031323334353637create tab"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2014-02-21T14:10:24.000Z"><meta property="article:modified_time" content="2020-07-09T06:37:13.343Z"><meta property="article:author" content="好好学习的郝"><meta property="article:tag" content="java"><meta property="article:tag" content="eclipse"><meta property="article:tag" content="hibernate"><meta property="article:tag" content="struts2"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://www.voidking.com/dev-hibernate-struts2-integration/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0}</script><title>Hibernate与Struts2整合应用 | 好好学习的郝</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?b759ac2a7fa45129e3ef060bf68259f0";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="好好学习的郝" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">好好学习的郝</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">好好学习，天天向上！</h1></div><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/voidking" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.voidking.com/dev-hibernate-struts2-integration/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="好好学习的郝"><meta itemprop="description" content="学而不思则罔，思而不学则殆！"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="好好学习的郝"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> Hibernate与Struts2整合应用</h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2014-02-21 14:10:24" itemprop="dateCreated datePublished" datetime="2014-02-21T14:10:24+00:00">2014-02-21</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E4%B8%93%E4%B8%9A/" itemprop="url" rel="index"><span itemprop="name">专业</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E4%B8%93%E4%B8%9A/%E5%90%8E%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">后端</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E4%B8%93%E4%B8%9A/%E5%90%8E%E7%AB%AF/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body" itemprop="articleBody"><p>应用实例：学生选课系统。<br>要求：学生登录系统后，可以查看、修改个人信息，查看个人选课情况，选定课程及退选课程。</p><h3 id="建立数据库和表"><a href="#建立数据库和表" class="headerlink" title="建立数据库和表"></a>建立数据库和表</h3><p>小编仍然使用MySQL数据库，scott用户。在xscj数据库中建立登录表、学生表、专业表、课程表，以及学生课程表即连接表。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> dlb(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span> primary <span class="keyword">key</span>,</span><br><span class="line">xh <span class="built_in">char</span>(<span class="number">6</span>) <span class="keyword">not</span> <span class="literal">null</span> ,</span><br><span class="line">kl <span class="built_in">varchar</span>(<span class="number">20</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> xsb(</span><br><span class="line">xh <span class="built_in">char</span>(<span class="number">6</span>) <span class="keyword">not</span> <span class="literal">null</span> primary <span class="keyword">key</span>,</span><br><span class="line">xm <span class="built_in">varchar</span>(<span class="number">8</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">xb <span class="built_in">bit</span> <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">check</span>(xb=<span class="number">0</span> <span class="keyword">or</span> xb=<span class="number">1</span>),</span><br><span class="line">cssj datetime ,</span><br><span class="line">zy_id <span class="built_in">int</span>,</span><br><span class="line">zxf <span class="built_in">int</span> <span class="keyword">default</span> <span class="number">0</span> <span class="keyword">check</span>(<span class="number">0</span>&lt;=zxf&lt;<span class="number">160</span>),</span><br><span class="line">bz <span class="built_in">varchar</span>(<span class="number">500</span>),</span><br><span class="line">zp longblob</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> zyb(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span> auto_increment primary <span class="keyword">key</span>,</span><br><span class="line">zym <span class="built_in">varchar</span>(<span class="number">12</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">rs <span class="built_in">int</span> <span class="keyword">default</span> <span class="number">0</span>,</span><br><span class="line">fdy <span class="built_in">varchar</span>(<span class="number">8</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> kcb(</span><br><span class="line">kch <span class="built_in">char</span>(<span class="number">3</span>) <span class="keyword">not</span> <span class="literal">null</span> primary <span class="keyword">key</span>,</span><br><span class="line">kcm <span class="built_in">varchar</span>(<span class="number">12</span>),</span><br><span class="line">kxxq <span class="built_in">smallint</span> <span class="keyword">check</span>(kxxq&gt;=<span class="number">1</span> <span class="keyword">and</span> kxxq&lt;=<span class="number">8</span>),</span><br><span class="line">xs <span class="built_in">int</span> <span class="keyword">default</span> <span class="number">0</span>,</span><br><span class="line">xf <span class="built_in">int</span> <span class="keyword">default</span> <span class="number">0</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> xs_kcb(</span><br><span class="line">xh <span class="built_in">char</span>(<span class="number">6</span>),</span><br><span class="line">kch <span class="built_in">char</span>(<span class="number">6</span>),</span><br><span class="line">primary <span class="keyword">key</span>(xh,kch)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><a id="more"></a><h3 id="创建Web项目"><a href="#创建Web项目" class="headerlink" title="创建Web项目"></a>创建Web项目</h3><p>新建Dynamic Web Project，命名为struts2_hibernate。</p><h3 id="添加Hibernate开发能力"><a href="#添加Hibernate开发能力" class="headerlink" title="添加Hibernate开发能力"></a>添加Hibernate开发能力</h3><p>右击项目名，Properties，Java Build Path，Libraries，Add Library…，User Library，Next，User Libraries…，New…，输入“hibernate”，OK，Add External JARs…，选中需要的jar文件，打开，OK。</p><h3 id="自动生成POJO类和映射文件"><a href="#自动生成POJO类和映射文件" class="headerlink" title="自动生成POJO类和映射文件"></a>自动生成POJO类和映射文件</h3><h4 id="新建JPA工程"><a href="#新建JPA工程" class="headerlink" title="新建JPA工程"></a>新建JPA工程</h4><p>新建JPA Project，输入一个工程名，Next，Next，走到一个界面，提示<code>At least one user library must be selected.</code>。<br>勾选User Library中hibernate之后，显示<code>The class &#39;javax.persistence.Convert&#39; is required to be in the selected libraries.</code>莫非Hibernate的某些包没包含？研究了所有的包，发现，确实没有含有Convert这个类的。估计又是版本问题，真麻烦！</p><p>Back，Back，在JPA version中选择v1.0。Next，Next，勾选hibernate，Finish。</p><p>右击工程名，JPA Tools，Generate Entities from Tables…。<br>选择Connection，激活连接，勾选Tables，Finish（或者一路Next，Finish）。</p><p>查看src文件夹，发现需要的POJO类已经生成，拷贝到需要的工程下即可。</p><p>但是，问题来了：POJO类有了，但是没有*.hbm.xml文件！</p><p>聪明的小伙伴肯定想到了，使用myeclipse生成POJO和*.hbm.xml，然后全部拷贝到eclipse的工程下。我只想说，同时安装eclipse和myeclipse，还换着用，这是有多无聊！</p><p>自己写？当然可以！但是人家myeclipse的POJO类和*.hbm.xml都可以自动生成，eclipse凭什么不可以？下面我们就研究一下方法。</p><h4 id="Hibernate-Tools插件"><a href="#Hibernate-Tools插件" class="headerlink" title="Hibernate Tools插件"></a>Hibernate Tools插件</h4><h5 id="第一招"><a href="#第一招" class="headerlink" title="第一招"></a>第一招</h5><p>Help，Eclipse Marketplace…，在find中输入“Hibernate”，搜索到的选项中有Hibernate Tools（Indigo）3.4.X，单击Install。<br>安装过程中，报错中断：</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'Installing Software '</span> <span class="built_in">has</span> encountered <span class="keyword">a</span> problem.</span><br><span class="line">An error occurred <span class="keyword">while</span> collecting <span class="built_in">items</span> <span class="keyword">to</span> <span class="keyword">be</span> installed</span><br></pre></td></tr></table></figure><p>本人的Eclipse是Luna版本（当前最新版），怀疑是兼容问题。重来，搜索到的选项中有JBoss Tools（Luna），单击Install。安装过程中选择Hibernate Tools安装，最终，依然报错，还能不能愉快地玩耍了！</p><h5 id="第二招"><a href="#第二招" class="headerlink" title="第二招"></a>第二招</h5><p>我们来到<a href="http://tools.jboss.org" target="_blank" rel="noopener">JBoss Tools官网</a>，然后找到<a href="http://tools.jboss.org/downloads/jbosstools/luna/4.2.3.Final.html" target="_blank" rel="noopener">下载界面</a>。可以看到，官方给出了三种下载方式：Eclipse Marketplace，Update Site和Artifacts。</p><p>刚才我们无意中使出第一招，失败了，让我们试试第二招。</p><p>Help ，Install New Software… ，Work with：<a href="http://download.jboss.org/jbosstools/updates/stable/luna/" target="_blank" rel="noopener">http://download.jboss.org/jbosstools/updates/stable/luna/</a> ，然后选择Hibernate Tools，Next。</p><p>慢，非常慢，完全受不了这个速度。。。</p><h5 id="第三招"><a href="#第三招" class="headerlink" title="第三招"></a>第三招</h5><p>第三招是我喜欢的方式：离线安装。感觉很靠谱，来试试看。<br>首先下载所需的zip文件，这里小编选择的是Update site (including sources) bundle of all Hibernate Tools。下载下来文件名为jbosstools-4.2.3.Final_2015-03-26_23-05-30-B264-updatesite-hibernatetools.zip。</p><p>Help ， Install New Software… ， Add… ， Archive… 。选中下载的文件，选择需要安装的插件，Next。啊勒，我靠，为什么还是这么慢！仔细观察一下进度条的提示，在Fetching什么玩意，貌似明白了什么。点击停止，然后把<code>Contact all update sites during install to find requred software</code>前面的勾去掉，再次Next。果然，进度马上就跑起来了！但是，跑着跑着就停了！进度条提示<code>Connot perform operation.Computing alternate solutions,may take a while:</code>，这个a while有点长啊！-_-|||，还能怎么办？放大招吧！下载Update site (including sources) bundle of all JBoss Core Tools，然后全部安装。我就不信了，全部的工具都在这，你还缺少依赖？</p><p>我去，这下更不得了，需要下载好多好多依赖的包，彻底醉了。。。</p><p>只勾选Hibernate Tools，试一试，成功！不容易啊！T_T</p><h5 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h5><p>官方教程：<a href="http://tools.jboss.org/features/hibernate.html" target="_blank" rel="noopener">http://tools.jboss.org/features/hibernate.html</a></p><p><a href="http://www.javacodegeeks.com/2013/10/step-by-step-auto-code-generation-for-pojo-domain-java-classes-and-hbm-using-eclipse-hibernate-plugin.html" target="_blank" rel="noopener">这篇文章</a>写得更详细：Step by step auto code generation for POJO domain java classes and hbm using Eclipse Hibernate plugin</p><p><a href="http://www.mkyong.com/hibernate/how-to-generate-code-with-hibernate-tools/" target="_blank" rel="noopener">这篇文章</a>写得也不错：How to generate Hibernate mapping files &amp; annotation with Hibernate Tools</p><p>Window，Open Perspective，Hibernate。</p><p>Add Configuration…，选中Project，Database connection ，Setup… Propery file，Setup… Configuration file（并且进行一些配置）。然后，然后，然后就出现了错误！！！<br><code>[Classpath]: Could not parse configuration:/hibernate.cfg.xml</code>，试了各种方法，都没法解决这个问题，这是要闹哪样啊！</p><p>多么奇葩的问题，本以为还要花费一番功夫。半小时后，莫名其妙的好了！好了。。。</p><p>重新来一遍，完整的：</p><p>Window，Open Perspective，Hibernate。</p><p>Add Configuration…，选中Project（struts2_hibernate），选择Database connection，Setup… Propery file，Setup… Configuration file（需要进行一些配置）。</p><p>这时，会提示缺少MySQL驱动，在Classpath选项卡中配置一下就好了。</p><p>File，New，Hibernate Reverse Engineering File（reveng.xml），选中struts2_hibernate，Next，选择Console configuration，Refresh，</p><p>在工具栏中，有三个三角号（绿色圆底），其中一个三角号的右下角有Hibernate的小标志。点击它的下拉菜单，Hibernate Code Generation Configurations…。<br>New，在Main选项卡中选择Console configuration，选择Output directory，勾选Reverse engineer from JDBC Connection。<br>在Exporters选项卡中勾选Domain code（.java）和Hibernate XML Mappings（.hbm.xml）。Run。</p><p>观察struts2_hibernate工程下的文件，可以发现，我们需要的POJO类和*.hbm.xml文件都有了！</p><h5 id="断网配置本地dtd文件"><a href="#断网配置本地dtd文件" class="headerlink" title="断网配置本地dtd文件"></a>断网配置本地dtd文件</h5><p>刚才完整操作的时候，断网了，无法解析hibernate.cfg.xml文件，看来需要配置个本地dtd文件才可以。这里需要配置hibernate-configuration-3.0.dtd，最好也配置一下hibernate-mapping-3.0.dtd，这两个文件在hibernate3.jar中可以找到。配置好之后，问题完美解决。选中一些表，Include…，Finish。</p><p>下面是Struts2验证框架出现同样问题时的解决办法，从《Struts2概述》摘录，方便查阅：</p><p>1、解压xwork-core-*.jar包，找到xwork-validator-1.0.dtd。</p><p>2、eclipse，Window，Preferences，XML，XML Catelog，Add，File System…，选中刚才解压的xwork-validator-1.0.dtd，打开，</p><p>3、Location已经选好<code>D:\jar\struts2\xwork-validator-1.0.dtd</code>，Key type选择<code>Public ID</code>，Key填<code>-//OpenSymphony Group//XWork Validator Config 1.0//EN</code>，Alternative web address填<code>http://struts.apache.org/dtds/xwork-validator-1.0.dtd</code>。（本地dtd不存在时回去web上去找dtd）</p><p>4、StrutsAction-validation.xml需要修改如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">validators</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"-//OpenSymphony Group//XWork Validator Config 1.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"D:\jar\struts2\xwork-validator-1.0.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">validators</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--需要校验的字段的字段名--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">field</span> <span class="attr">name</span>=<span class="string">"name"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">field-validator</span> <span class="attr">type</span>=<span class="string">"requiredstring"</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!--去空格--&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"trim"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!--错误提示信息--&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">message</span>&gt;</span>姓名是必须的<span class="tag">&lt;/<span class="name">message</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">field-validator</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">field</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">validators</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="hbm-xml文件修改"><a href="#hbm-xml文件修改" class="headerlink" title="*.hbm.xml文件修改"></a>*.hbm.xml文件修改</h3><h4 id="Xsb-hbm-xml"><a href="#Xsb-hbm-xml" class="headerlink" title="Xsb.hbm.xml"></a>Xsb.hbm.xml</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-mapping</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//Hibernate/Hibernate Mapping DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Generated 2015-5-23 0:27:57 by Hibernate Tools 3.4.0.CR1 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Xsb"</span> <span class="attr">table</span>=<span class="string">"xsb"</span> <span class="attr">catalog</span>=<span class="string">"xscj"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"xh"</span> <span class="attr">type</span>=<span class="string">"string"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">column</span> <span class="attr">name</span>=<span class="string">"xh"</span> <span class="attr">length</span>=<span class="string">"6"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"assigned"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"xm"</span> <span class="attr">type</span>=<span class="string">"string"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">column</span> <span class="attr">name</span>=<span class="string">"xm"</span> <span class="attr">length</span>=<span class="string">"8"</span> <span class="attr">not-null</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"xb"</span> <span class="attr">type</span>=<span class="string">"boolean"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">column</span> <span class="attr">name</span>=<span class="string">"xb"</span> <span class="attr">not-null</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"cssj"</span> <span class="attr">type</span>=<span class="string">"timestamp"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">column</span> <span class="attr">name</span>=<span class="string">"cssj"</span> <span class="attr">length</span>=<span class="string">"19"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"zyId"</span> <span class="attr">type</span>=<span class="string">"java.lang.Integer"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">column</span> <span class="attr">name</span>=<span class="string">"zy_id"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"zxf"</span> <span class="attr">type</span>=<span class="string">"java.lang.Integer"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">column</span> <span class="attr">name</span>=<span class="string">"zxf"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"bz"</span> <span class="attr">type</span>=<span class="string">"string"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">column</span> <span class="attr">name</span>=<span class="string">"bz"</span> <span class="attr">length</span>=<span class="string">"500"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"zp"</span> <span class="attr">type</span>=<span class="string">"binary"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">column</span> <span class="attr">name</span>=<span class="string">"zp"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">many-to-one</span> <span class="attr">name</span>=<span class="string">"zyb"</span> <span class="attr">class</span>=<span class="string">"com.voidking.struts2_hibernate.model.Zyb"</span> <span class="attr">fetch</span>=<span class="string">"select"</span> <span class="attr">cascade</span>=<span class="string">"all"</span> <span class="attr">lazy</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">        	<span class="tag">&lt;<span class="name">column</span> <span class="attr">name</span>=<span class="string">"zy_id"</span>&gt;</span><span class="tag">&lt;/<span class="name">column</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">many-to-one</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"kcs"</span> <span class="attr">table</span>=<span class="string">"xs_kcb"</span> <span class="attr">lazy</span>=<span class="string">"false"</span> <span class="attr">cascade</span>=<span class="string">"save-update"</span>&gt;</span></span><br><span class="line">        	<span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"xh"</span>&gt;</span><span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        	<span class="tag">&lt;<span class="name">many-to-many</span> <span class="attr">class</span>=<span class="string">"com.voidking.struts2_hibernate.model.Kcb"</span> <span class="attr">column</span>=<span class="string">"kch"</span>&gt;</span><span class="tag">&lt;/<span class="name">many-to-many</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="Kcb-hbm-xml"><a href="#Kcb-hbm-xml" class="headerlink" title="Kcb.hbm.xml"></a>Kcb.hbm.xml</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-mapping</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//Hibernate/Hibernate Mapping DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Generated 2015-5-23 0:27:57 by Hibernate Tools 3.4.0.CR1 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Kcb"</span> <span class="attr">table</span>=<span class="string">"kcb"</span> <span class="attr">catalog</span>=<span class="string">"xscj"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"kch"</span> <span class="attr">type</span>=<span class="string">"string"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">column</span> <span class="attr">name</span>=<span class="string">"kch"</span> <span class="attr">length</span>=<span class="string">"3"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"assigned"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"kcm"</span> <span class="attr">type</span>=<span class="string">"string"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">column</span> <span class="attr">name</span>=<span class="string">"kcm"</span> <span class="attr">length</span>=<span class="string">"12"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"kxxq"</span> <span class="attr">type</span>=<span class="string">"java.lang.Short"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">column</span> <span class="attr">name</span>=<span class="string">"kxxq"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"xs"</span> <span class="attr">type</span>=<span class="string">"java.lang.Integer"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">column</span> <span class="attr">name</span>=<span class="string">"xs"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"xf"</span> <span class="attr">type</span>=<span class="string">"java.lang.Integer"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">column</span> <span class="attr">name</span>=<span class="string">"xf"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"xss"</span> <span class="attr">table</span>=<span class="string">"xs_kcb"</span> <span class="attr">lazy</span>=<span class="string">"true"</span> <span class="attr">inverse</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">        	<span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"kch"</span>&gt;</span><span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        	<span class="tag">&lt;<span class="name">many-to-many</span> <span class="attr">class</span>=<span class="string">"com.voidking.struts2_hibernate.model.Xsb"</span>&gt;</span><span class="tag">&lt;/<span class="name">many-to-many</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="Dao层组件实现"><a href="#Dao层组件实现" class="headerlink" title="Dao层组件实现"></a>Dao层组件实现</h3><h4 id="DlDao-java"><a href="#DlDao-java" class="headerlink" title="DlDao.java"></a>DlDao.java</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">package com.voidking.struts2_hibernate.dao;</span><br><span class="line"></span><br><span class="line">import com.voidking.struts2_hibernate.model.Dlb;</span><br><span class="line"></span><br><span class="line">public<span class="built_in"> interface </span>DlDao &#123;</span><br><span class="line">	public Dlb validate(String xh,String kl);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="DlDaoImp-java"><a href="#DlDaoImp-java" class="headerlink" title="DlDaoImp.java"></a>DlDaoImp.java</h4><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">package com.<span class="built_in">void</span>king.struts2_hibernate.dao.imp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.hibernate.Query;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Transaction;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.<span class="built_in">void</span>king.struts2_hibernate.dao.DlDao;</span><br><span class="line"><span class="keyword">import</span> com.<span class="built_in">void</span>king.struts2_hibernate.model.Dlb;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="symbol">DlDaoImp</span> <span class="symbol">implements</span> <span class="symbol">DlDao</span> &#123;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	<span class="keyword">public</span> Dlb validate(String xh, String kl) &#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Configuration cf = new Configuration();</span><br><span class="line">			SessionFactory sf = cf.buildSessionFactory();</span><br><span class="line">			Session session = sf.openSession();</span><br><span class="line">			</span><br><span class="line">			Transaction ts = session.beginTransaction();</span><br><span class="line">			Query query = session.createQuery(<span class="string">"from Dlb where xh=? and kl=?"</span>);</span><br><span class="line">			query.setParameter(<span class="number">0</span>, xh);</span><br><span class="line">			query.setParameter(<span class="number">1</span>, kl);</span><br><span class="line">			query.setMaxResults(<span class="number">1</span>);</span><br><span class="line">			Dlb dlb =(Dlb)query.uniqueResult();</span><br><span class="line">			</span><br><span class="line">			ts.commit();</span><br><span class="line">			session.close();</span><br><span class="line">			sf.close();</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(dlb!=<span class="literal">null</span>)&#123;</span><br><span class="line">				<span class="keyword">return</span> dlb;</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			<span class="comment">// <span class="doctag">TODO:</span> handle exception</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="XsDao-java"><a href="#XsDao-java" class="headerlink" title="XsDao.java"></a>XsDao.java</h4><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">package com.<span class="built_in">void</span>king.struts2_hibernate.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.<span class="built_in">void</span>king.struts2_hibernate.model.Xsb;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="symbol">XsDao</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> Xsb getOneXs(String xh);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">public</span> <span class="built_in">void</span> update(Xsb xs);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="XsDaoImp-java"><a href="#XsDaoImp-java" class="headerlink" title="XsDaoImp.java"></a>XsDaoImp.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.voidking.struts2_hibernate.dao.imp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.hibernate.Query;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Transaction;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.voidking.struts2_hibernate.dao.XsDao;</span><br><span class="line"><span class="keyword">import</span> com.voidking.struts2_hibernate.model.Xsb;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XsDaoImp</span> <span class="keyword">implements</span> <span class="title">XsDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Xsb <span class="title">getOneXs</span><span class="params">(String xh)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Configuration cf = <span class="keyword">new</span> Configuration();</span><br><span class="line">			SessionFactory sf = cf.buildSessionFactory();</span><br><span class="line">			Session session = sf.openSession();</span><br><span class="line">			Transaction ts = session.beginTransaction();</span><br><span class="line">			Query query = session.createQuery(<span class="string">"from xsb where xh=?"</span>);</span><br><span class="line">			query.setParameter(<span class="number">0</span>, xh);</span><br><span class="line">			query.setMaxResults(<span class="number">1</span>);</span><br><span class="line">			Xsb xs = (Xsb)query.uniqueResult();</span><br><span class="line">			ts.commit();</span><br><span class="line">			session.close();</span><br><span class="line">			sf.close();</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			<span class="comment">// <span class="doctag">TODO:</span> handle exception</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(Xsb xs)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Configuration cf = <span class="keyword">new</span> Configuration();</span><br><span class="line">			SessionFactory sf = cf.buildSessionFactory();</span><br><span class="line">			Session session = sf.openSession();</span><br><span class="line">			Transaction ts = session.beginTransaction();</span><br><span class="line">			</span><br><span class="line">			session.update(xs);</span><br><span class="line">			</span><br><span class="line">			ts.commit();</span><br><span class="line">			session.close();</span><br><span class="line">			sf.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			<span class="comment">// <span class="doctag">TODO:</span> handle exception</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>写完这个文件，我突然发现，写一个HibernateSessionFactory类当做工具真的太必要了！不然的话，每次我想用Session的时候，都要</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Configuration <span class="built_in">cf</span> = <span class="built_in">new</span> Configuration();</span><br><span class="line">SessionFactory <span class="built_in">sf</span> = <span class="built_in">cf</span>.buildSessionFactory();</span><br><span class="line">Session session = <span class="built_in">sf</span>.openSession();</span><br></pre></td></tr></table></figure><p>每次都重新new一个Configuration，建立一个SessionFactory，一定加大了系统的开销。而且，一个数据库对应一个SessionFactory就够了！</p><p>myeclipse自动生成的HibernateSessionFactory类，感觉有点复杂，自己写一个吧！</p><h4 id="MySessionFactory-java"><a href="#MySessionFactory-java" class="headerlink" title="MySessionFactory.java"></a>MySessionFactory.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.voidking.struts2_hibernate.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//在使用hibernate开发项目，请一定保证只有一个SessionFactory</span></span><br><span class="line"><span class="comment">//一个数据库对应一个SessionFactory 对象.</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MySessionFactory</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> SessionFactory sessionFactory=<span class="keyword">null</span>;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">MySessionFactory</span><span class="params">()</span></span>&#123;</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">static</span>&#123;         </span><br><span class="line">        sessionFactory =<span class="keyword">new</span> Configuration().configure(<span class="string">"/hibernate.cfg.xml"</span>).buildSessionFactory(); </span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SessionFactory <span class="title">getSessionFactory</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sessionFactory;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="重写DlDaoImp-java"><a href="#重写DlDaoImp-java" class="headerlink" title="重写DlDaoImp.java"></a>重写DlDaoImp.java</h4><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">package com.<span class="built_in">void</span>king.struts2_hibernate.dao.imp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.hibernate.Query;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Transaction;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.<span class="built_in">void</span>king.struts2_hibernate.dao.DlDao;</span><br><span class="line"><span class="keyword">import</span> com.<span class="built_in">void</span>king.struts2_hibernate.model.Dlb;</span><br><span class="line"><span class="keyword">import</span> com.<span class="built_in">void</span>king.struts2_hibernate.util.MySessionFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="symbol">DlDaoImp</span> <span class="symbol">implements</span> <span class="symbol">DlDao</span> &#123;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	<span class="keyword">public</span> Dlb validate(String xh, String kl) &#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Session session = MySessionFactory.getSessionFactory().openSession();</span><br><span class="line">			</span><br><span class="line">			Transaction ts = session.beginTransaction();</span><br><span class="line">			Query query = session.createQuery(<span class="string">"from Dlb where xh=? and kl=?"</span>);</span><br><span class="line">			query.setParameter(<span class="number">0</span>, xh);</span><br><span class="line">			query.setParameter(<span class="number">1</span>, kl);</span><br><span class="line">			query.setMaxResults(<span class="number">1</span>);</span><br><span class="line">			Dlb dlb =(Dlb)query.uniqueResult();</span><br><span class="line">			</span><br><span class="line">			ts.commit();</span><br><span class="line">			session.close();</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(dlb!=<span class="literal">null</span>)&#123;</span><br><span class="line">				<span class="keyword">return</span> dlb;</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			<span class="comment">// <span class="doctag">TODO:</span> handle exception</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="重写XsDaoImp-java"><a href="#重写XsDaoImp-java" class="headerlink" title="重写XsDaoImp.java"></a>重写XsDaoImp.java</h4><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">package com.<span class="built_in">void</span>king.struts2_hibernate.dao.imp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.hibernate.Query;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Transaction;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.<span class="built_in">void</span>king.struts2_hibernate.dao.XsDao;</span><br><span class="line"><span class="keyword">import</span> com.<span class="built_in">void</span>king.struts2_hibernate.model.Xsb;</span><br><span class="line"><span class="keyword">import</span> com.<span class="built_in">void</span>king.struts2_hibernate.util.MySessionFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="symbol">XsDaoImp</span> <span class="symbol">implements</span> <span class="symbol">XsDao</span> &#123;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	<span class="keyword">public</span> Xsb getOneXs(String xh) &#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">			Session session = MySessionFactory.getSessionFactory().openSession();</span><br><span class="line">			Transaction ts = session.beginTransaction();</span><br><span class="line">			Query query = session.createQuery(<span class="string">"from xsb where xh=?"</span>);</span><br><span class="line">			query.setParameter(<span class="number">0</span>, xh);</span><br><span class="line">			query.setMaxResults(<span class="number">1</span>);</span><br><span class="line">			Xsb xs = (Xsb)query.uniqueResult();</span><br><span class="line">			ts.commit();</span><br><span class="line">			session.close();</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			<span class="comment">// <span class="doctag">TODO:</span> handle exception</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	<span class="keyword">public</span> <span class="built_in">void</span> update(Xsb xs) &#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Session session = MySessionFactory.getSessionFactory().openSession();</span><br><span class="line">			Transaction ts = session.beginTransaction();</span><br><span class="line">			</span><br><span class="line">			session.update(xs);</span><br><span class="line">			</span><br><span class="line">			ts.commit();</span><br><span class="line">			session.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			<span class="comment">// <span class="doctag">TODO:</span> handle exception</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ZyDao-java"><a href="#ZyDao-java" class="headerlink" title="ZyDao.java"></a>ZyDao.java</h4><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">package com.<span class="built_in">void</span>king.struts2_hibernate.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.<span class="built_in">void</span>king.struts2_hibernate.model.Zyb;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="symbol">ZyDao</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> Zyb getOneZy(Integer zyId);</span><br><span class="line">	<span class="keyword">public</span> List getAll();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ZyDaoImp-java"><a href="#ZyDaoImp-java" class="headerlink" title="ZyDaoImp.java"></a>ZyDaoImp.java</h4><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">package com.voidking.struts2_hibernate.dao.imp;</span><br><span class="line"></span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">import org.hibernate.Query;</span><br><span class="line">import org.hibernate.Session;</span><br><span class="line">import org.hibernate.Transaction;</span><br><span class="line"></span><br><span class="line">import com.voidking.struts2_hibernate.dao.ZyDao;</span><br><span class="line">import com.voidking.struts2_hibernate.model.Zyb;</span><br><span class="line">import com.voidking.struts2_hibernate.util.MySessionFactory;</span><br><span class="line"></span><br><span class="line">public <span class="keyword">class</span> ZyDaoImp implements ZyDao &#123;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public Zyb get<span class="constructor">OneZy(Integer <span class="params">zyId</span>)</span> &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Session session = <span class="module-access"><span class="module"><span class="identifier">MySessionFactory</span>.</span></span>get<span class="constructor">SessionFactory()</span>.<span class="keyword">open</span><span class="constructor">Session()</span>;</span><br><span class="line">			Transaction ts = session.<span class="keyword">begin</span><span class="constructor">Transaction()</span>;</span><br><span class="line">			</span><br><span class="line">			Query query = session.create<span class="constructor">Query(<span class="string">"from zyb where id=?"</span>)</span>;</span><br><span class="line">			query.set<span class="constructor">Parameter(0, <span class="params">zyId</span>)</span>;</span><br><span class="line">			query.set<span class="constructor">MaxResults(1)</span>;</span><br><span class="line">			Zyb zy = (Zyb)query.unique<span class="constructor">Result()</span>;</span><br><span class="line">			</span><br><span class="line">			ts.commit<span class="literal">()</span>;</span><br><span class="line">			session.close<span class="literal">()</span>;</span><br><span class="line">			</span><br><span class="line">			return zy;</span><br><span class="line">		&#125; catch (Exception e) &#123;</span><br><span class="line">			<span class="comment">// <span class="doctag">TODO:</span> handle exception</span></span><br><span class="line">			e.print<span class="constructor">StackTrace()</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		return null;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public List get<span class="constructor">All()</span> &#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Session session = <span class="module-access"><span class="module"><span class="identifier">MySessionFactory</span>.</span></span>get<span class="constructor">SessionFactory()</span>.<span class="keyword">open</span><span class="constructor">Session()</span>;</span><br><span class="line">			Transaction ts = session.<span class="keyword">begin</span><span class="constructor">Transaction()</span>;</span><br><span class="line">			</span><br><span class="line">			List <span class="built_in">list</span> = session.create<span class="constructor">Query(<span class="string">"from zyb"</span>)</span>.<span class="built_in">list</span><span class="literal">()</span>;</span><br><span class="line">			</span><br><span class="line">			ts.commit<span class="literal">()</span>;</span><br><span class="line">			session.close<span class="literal">()</span>;</span><br><span class="line">			return <span class="built_in">list</span>;</span><br><span class="line">			</span><br><span class="line">		&#125; catch (Exception e) &#123;</span><br><span class="line">			e.print<span class="constructor">StackTrace()</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		return null;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="KcDao-java"><a href="#KcDao-java" class="headerlink" title="KcDao.java"></a>KcDao.java</h4><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">package com.<span class="built_in">void</span>king.struts2_hibernate.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.<span class="built_in">void</span>king.struts2_hibernate.model.Kcb;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="symbol">KcDao</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> Kcb getOneKc(String kch);</span><br><span class="line">	<span class="keyword">public</span> List getAll();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="KcDaoImp-java"><a href="#KcDaoImp-java" class="headerlink" title="KcDaoImp.java"></a>KcDaoImp.java</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">package com.voidking.struts2_hibernate.dao.imp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.hibernate.HibernateException;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Query;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.<span class="keyword">Session</span>;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.<span class="keyword">Transaction</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.voidking.struts2_hibernate.dao.KcDao;</span><br><span class="line"><span class="keyword">import</span> com.voidking.struts2_hibernate.model.Kcb;</span><br><span class="line"><span class="keyword">import</span> com.voidking.struts2_hibernate.util.MySessionFactory;</span><br><span class="line"></span><br><span class="line"><span class="built_in">public</span> <span class="keyword">class</span> KcDaoImp implements KcDao &#123;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	<span class="built_in">public</span> Kcb getOneKc(String kch) &#123;</span><br><span class="line">		// TODO Auto-<span class="keyword">generated</span> <span class="keyword">method</span> stub</span><br><span class="line">		try &#123;</span><br><span class="line">			<span class="keyword">Session</span> <span class="keyword">session</span> = MySessionFactory.getSessionFactory().openSession();</span><br><span class="line">			<span class="keyword">Transaction</span> ts = <span class="keyword">session</span>.beginTransaction();</span><br><span class="line">			</span><br><span class="line">			Query query = <span class="keyword">session</span>.createQuery("from kcb where kch=?");</span><br><span class="line">			query.setParameter(<span class="number">0</span>, kch);</span><br><span class="line">			query.setMaxResults(<span class="number">1</span>);</span><br><span class="line">			Kcb kc = (Kcb)query.uniqueResult();</span><br><span class="line">			</span><br><span class="line">			ts.<span class="keyword">commit</span>();</span><br><span class="line">			<span class="keyword">session</span>.<span class="keyword">close</span>();</span><br><span class="line">			<span class="keyword">return</span> kc;</span><br><span class="line">			</span><br><span class="line">		&#125; catch (<span class="keyword">Exception</span> e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	<span class="built_in">public</span> List getAll() &#123;</span><br><span class="line">		// TODO Auto-<span class="keyword">generated</span> <span class="keyword">method</span> stub</span><br><span class="line">		try &#123;</span><br><span class="line">			<span class="keyword">Session</span> <span class="keyword">session</span> = MySessionFactory.getSessionFactory().openSession();</span><br><span class="line">			<span class="keyword">Transaction</span> ts = <span class="keyword">session</span>.beginTransaction();</span><br><span class="line">			List list = <span class="keyword">session</span>.createQuery("from kcb order by kch").list();</span><br><span class="line">			ts.<span class="keyword">commit</span>();</span><br><span class="line">			<span class="keyword">session</span>.<span class="keyword">close</span>();</span><br><span class="line">			<span class="keyword">return</span> list;</span><br><span class="line">		&#125; catch (HibernateException e) &#123;</span><br><span class="line">			// TODO Auto-<span class="keyword">generated</span> catch block</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="struts-xml"><a href="#struts-xml" class="headerlink" title="struts.xml"></a>struts.xml</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">struts</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://struts.apache.org/dtds/struts-2.0.dtd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.multipart.saveDir"</span> <span class="attr">value</span>=<span class="string">"/tmp"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"default"</span>  <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"login"</span> <span class="attr">class</span>=<span class="string">"com.voidking.struts2_hibernate.action.LoginAction"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>/main.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"error"</span>&gt;</span>/login.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"xsInfo"</span> <span class="attr">class</span>=<span class="string">"org.action.XsAction"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>/xsInfo.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"getImage"</span> <span class="attr">class</span>=<span class="string">"com.voidking.struts2_hibernate.action.XsAction"</span> <span class="attr">method</span>=<span class="string">"getImage"</span>&gt;</span><span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"updateXsInfo"</span> <span class="attr">class</span>=<span class="string">"com.voidking.struts2_hibernate.action.XsAction"</span> <span class="attr">method</span>=<span class="string">"updateXsInfo"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>/updateXsInfo.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"updateXs"</span> <span class="attr">class</span>=<span class="string">"com.voidking.struts2_hibernate.action.XsAction"</span> <span class="attr">method</span>=<span class="string">"updateXs"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>/updateXs_success.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"getXsKcs"</span> <span class="attr">class</span>=<span class="string">"com.voidking.struts2_hibernate.action.XsAction"</span> <span class="attr">method</span>=<span class="string">"getXsKcs"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>/xsKcs.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"deleteKc"</span> <span class="attr">class</span>=<span class="string">"com.voidking.struts2_hibernate.action.XsAction"</span> <span class="attr">method</span>=<span class="string">"deleteKc"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>/deleteKc_success.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"getAllKc"</span> <span class="attr">class</span>=<span class="string">"com.voidking.struts2_hibernate.action.KcAction"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>/allKc.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"selectKc"</span> <span class="attr">class</span>=<span class="string">"com.voidking.struts2_hibernate.action.XsAction"</span> <span class="attr">method</span>=<span class="string">"selectKc"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>/selectKc_success.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"error"</span>&gt;</span>/selectKc_fail.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="web-xml"><a href="#web-xml" class="headerlink" title="web.xml"></a>web.xml</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">id</span>=<span class="string">"WebApp_9"</span> <span class="attr">version</span>=<span class="string">"2.4"</span> <span class="attr">xmlns</span>=<span class="string">"http://java.sun.com/xml/ns/j2ee"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>/login.jsp<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.apache.struts2.dispatcher.FilterDispatcher<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="界面交互"><a href="#界面交互" class="headerlink" title="界面交互"></a>界面交互</h3><p>Action类和jsp界面，在此省略。详情请见源代码。</p><h3 id="严重错误"><a href="#严重错误" class="headerlink" title="严重错误"></a>严重错误</h3><p>部署，运行，404错误。进入Tomcat的Manager App界面，start项目，报错如下：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SEVERE:Exception starting<span class="built_in"> filter </span>struts2</span><br><span class="line">java.lang.ClassNotFoundException: org.apache.struts2.dispatcher.FilterDispatcher</span><br></pre></td></tr></table></figure><p>我勒个去，怎么就找不到过滤器了！换成<code>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareFilter</code>试试，报同样的错：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SEVERE:Exception starting<span class="built_in"> filter </span>struts2</span><br><span class="line">java.lang.ClassNotFoundException: org.apache.struts2.dispatcher.ng.filter.StrutsPrepareFilter</span><br></pre></td></tr></table></figure><p>这个工程，和之前写的struts2工程有什么差别？<br>struts2中，我直接把jar包放到了WebContent/WEB-INF/lib里面，而在这个项目中，我把jar包放到了WebContent/WEB-INF/lib/struts2里。删除一层目录试试，问题完美解决。</p><h3 id="很多错误"><a href="#很多错误" class="headerlink" title="很多错误"></a>很多错误</h3><p>输入学号，密码，点击登录，报错如下：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">HTTP Status 500 - </span><br><span class="line"></span><br><span class="line">type Exception report</span><br><span class="line"></span><br><span class="line">message </span><br><span class="line"></span><br><span class="line">description The<span class="built_in"> server </span>encountered an internal <span class="builtin-name">error</span> that prevented it <span class="keyword">from</span> fulfilling this request.</span><br><span class="line"></span><br><span class="line">exception </span><br><span class="line"></span><br><span class="line">java.lang.reflect.InvocationTargetException</span><br><span class="line">	sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</span><br><span class="line">	sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)</span><br><span class="line">	……</span><br><span class="line">	</span><br><span class="line">root cause </span><br><span class="line">	……</span><br></pre></td></tr></table></figure><p>root caose下面的内容是重点，要么是lib中缺少jar文件，要么某个类写错了，要么配置文件错误……总之各种错误，根据提示定位修改即可。</p><h3 id="源代码分享"><a href="#源代码分享" class="headerlink" title="源代码分享"></a>源代码分享</h3><p><a href="https://github.com/voidking/struts2_hibernate.git" target="_blank" rel="noopener">https://github.com/voidking/struts2_hibernate.git</a></p><h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>太复杂了，根本没法愉快的玩耍！改了几十个错误！！！尤其是Hibernate中POJO类和*.hbm.xml对应的部分，太难搞了！记得JPA似乎简单一点，等到复习到那部分再深入研究。最终，程序跑起来了，但是很多功能都没法用，各种not mapped，实在搞不下去了，能力有限啊。。。</p><p>发现：在JavaSE中，可以通过引入jar包的方式使用外部类。但是在JavaEE中，也就是Web工程中，需要拷贝jar包到lib文件夹中才可以使用外部类。<br>分析：发布到Tomcat中的工程，根本没有记录引用外部类的文件，也就是说，找不到外部jar包。而lib文件夹中的jar包，应该是默认寻找外部类的地方。</p><h3 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h3><p>《Java EE基础实用教程》，郑阿奇主编</p><hr><p>在Eclipse中从数据库表自动生成hibernate的java实体类<br><a href="http://www.shangxueba.com/jingyan/2453455.html" target="_blank" rel="noopener">http://www.shangxueba.com/jingyan/2453455.html</a><br><a href="http://blog.csdn.net/zheng2008hua/article/details/6274659" target="_blank" rel="noopener">http://blog.csdn.net/zheng2008hua/article/details/6274659</a></p><hr><p>Hibernate初始化时的Could not parse configuration<br><a href="http://blog.csdn.net/mydeman/article/details/6134820" target="_blank" rel="noopener">http://blog.csdn.net/mydeman/article/details/6134820</a></p><hr><p>如何理解Hibernate中的HibernateSessionFactory类<br><a href="http://www.cnblogs.com/dyllove98/archive/3243769.html" target="_blank" rel="noopener">http://www.cnblogs.com/dyllove98/archive/3243769.html</a></p><hr><p>org.hibernate.MappingException:An association from the table * refers to an unmapped class:<br><a href="http://blog.csdn.net/jayqean/article/details/5608330" target="_blank" rel="noopener">http://blog.csdn.net/jayqean/article/details/5608330</a></p><hr><p>org.hibernate.HibernateException: Unable to instantiate default tuplizer<br><a href="http://www.cnblogs.com/chuyuhuashi/archive/2423235.html" target="_blank" rel="noopener">http://www.cnblogs.com/chuyuhuashi/archive/2423235.html</a></p><hr></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/java/" rel="tag"># java</a> <a href="/tags/eclipse/" rel="tag"># eclipse</a> <a href="/tags/hibernate/" rel="tag"># hibernate</a> <a href="/tags/struts2/" rel="tag"># struts2</a></div><div class="post-nav"><div class="post-nav-item"><a href="/dev-hibernate-senior/" rel="prev" title="Hibernate高级应用"><i class="fa fa-chevron-left"></i> Hibernate高级应用</a></div><div class="post-nav-item"> <a href="/dev-spring-start/" rel="next" title="Spring概述">Spring概述<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><div class="comments"><div id="lv-container" data-id="city" data-uid="MTAyMC8zODU3Mi8xNTEwMA=="></div></div><script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#建立数据库和表"><span class="nav-number">1.</span> <span class="nav-text">建立数据库和表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建Web项目"><span class="nav-number">2.</span> <span class="nav-text">创建Web项目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#添加Hibernate开发能力"><span class="nav-number">3.</span> <span class="nav-text">添加Hibernate开发能力</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#自动生成POJO类和映射文件"><span class="nav-number">4.</span> <span class="nav-text">自动生成POJO类和映射文件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#新建JPA工程"><span class="nav-number">4.1.</span> <span class="nav-text">新建JPA工程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Hibernate-Tools插件"><span class="nav-number">4.2.</span> <span class="nav-text">Hibernate Tools插件</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#第一招"><span class="nav-number">4.2.1.</span> <span class="nav-text">第一招</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第二招"><span class="nav-number">4.2.2.</span> <span class="nav-text">第二招</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第三招"><span class="nav-number">4.2.3.</span> <span class="nav-text">第三招</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#使用"><span class="nav-number">4.2.4.</span> <span class="nav-text">使用</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#断网配置本地dtd文件"><span class="nav-number">4.2.5.</span> <span class="nav-text">断网配置本地dtd文件</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#hbm-xml文件修改"><span class="nav-number">5.</span> <span class="nav-text">*.hbm.xml文件修改</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Xsb-hbm-xml"><span class="nav-number">5.1.</span> <span class="nav-text">Xsb.hbm.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Kcb-hbm-xml"><span class="nav-number">5.2.</span> <span class="nav-text">Kcb.hbm.xml</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Dao层组件实现"><span class="nav-number">6.</span> <span class="nav-text">Dao层组件实现</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#DlDao-java"><span class="nav-number">6.1.</span> <span class="nav-text">DlDao.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DlDaoImp-java"><span class="nav-number">6.2.</span> <span class="nav-text">DlDaoImp.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#XsDao-java"><span class="nav-number">6.3.</span> <span class="nav-text">XsDao.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#XsDaoImp-java"><span class="nav-number">6.4.</span> <span class="nav-text">XsDaoImp.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#MySessionFactory-java"><span class="nav-number">6.5.</span> <span class="nav-text">MySessionFactory.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#重写DlDaoImp-java"><span class="nav-number">6.6.</span> <span class="nav-text">重写DlDaoImp.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#重写XsDaoImp-java"><span class="nav-number">6.7.</span> <span class="nav-text">重写XsDaoImp.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZyDao-java"><span class="nav-number">6.8.</span> <span class="nav-text">ZyDao.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZyDaoImp-java"><span class="nav-number">6.9.</span> <span class="nav-text">ZyDaoImp.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#KcDao-java"><span class="nav-number">6.10.</span> <span class="nav-text">KcDao.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#KcDaoImp-java"><span class="nav-number">6.11.</span> <span class="nav-text">KcDaoImp.java</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#struts-xml"><span class="nav-number">7.</span> <span class="nav-text">struts.xml</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-xml"><span class="nav-number">8.</span> <span class="nav-text">web.xml</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#界面交互"><span class="nav-number">9.</span> <span class="nav-text">界面交互</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#严重错误"><span class="nav-number">10.</span> <span class="nav-text">严重错误</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#很多错误"><span class="nav-number">11.</span> <span class="nav-text">很多错误</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#源代码分享"><span class="nav-number">12.</span> <span class="nav-text">源代码分享</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#小结"><span class="nav-number">13.</span> <span class="nav-text">小结</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#参考文档"><span class="nav-number">14.</span> <span class="nav-text">参考文档</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="好好学习的郝" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">好好学习的郝</p><div class="site-description" itemprop="description">学而不思则罔，思而不学则殆！</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">607</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">42</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">199</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:voidking@qq.com" title="E-Mail → mailto:voidking@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://github.com/voidking" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="http://weibo.com/voidking" title="Weibo → http:&#x2F;&#x2F;weibo.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i> Weibo</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/voidking" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-quora"></i> Zhihu</a></span></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2014 – <span itemprop="copyrightYear">2020</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">好好学习的郝</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="footer-beian"> <a href="http://www.beian.miit.gov.cn/" target="_blank">苏ICP备14021030号</a>&nbsp;|&nbsp; <img src="/images/beian.png" alt=""> <a target="_blank" href="http://www.beian.gov.cn/">苏公网安备 32032202000223号</a></div></div></footer><div id="needsharebutton-float"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div></div><script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css"><script src="/lib/needsharebutton/needsharebutton.js"></script><script>pbOptions={iconStyle:"box",boxForm:"horizontal",position:"bottomCenter",networks:"Weibo,Wechat,Douban,QQZone,Twitter,Facebook"},new needShareButton("#needsharebutton-postbottom",pbOptions),flOptions={iconStyle:"box",boxForm:"horizontal",position:"topRight",networks:"Weibo,Wechat,Douban,QQZone,Twitter,Facebook"},new needShareButton("#needsharebutton-float",flOptions)</script><script>
NexT.utils.loadComments(document.querySelector('#lv-container'), () => {
  // window.livereOptions = {
  //   refer: location.pathname.replace(CONFIG.root, '').replace('index.html', '')
  // };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
});
</script></body></html>