<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 4.2.1"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:new URL("https://www.voidking.com").hostname,root:"/",scheme:"Gemini",version:"7.7.1",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1,cdn:{enable:!0,url:"//cdn.jsdelivr.net/gh/voidking/voidking.github.io/search.xml"}},path:"search.xml",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="安装tomcat首先参考《全平台安装JDK》，安装配置好JDK，然后按照下面的流程安装tomcat。 1、下载tomcat8.0.50wget http:&#x2F;&#x2F;www-eu.apache.org&#x2F;dist&#x2F;tomcat&#x2F;tomcat-8&#x2F;v8.0.50&#x2F;bin&#x2F;apache-tomcat-8.0.50.tar.gz 2、解压tomcat到&#x2F;opt目录tar -xzvf apache-tomcat-8"><meta property="og:type" content="article"><meta property="og:title" content="CentOS7设置tomcat开机自启动"><meta property="og:url" content="https://www.voidking.com/dev-centos-tomcat-autostart/index.html"><meta property="og:site_name" content="好好学习的郝"><meta property="og:description" content="安装tomcat首先参考《全平台安装JDK》，安装配置好JDK，然后按照下面的流程安装tomcat。 1、下载tomcat8.0.50wget http:&#x2F;&#x2F;www-eu.apache.org&#x2F;dist&#x2F;tomcat&#x2F;tomcat-8&#x2F;v8.0.50&#x2F;bin&#x2F;apache-tomcat-8.0.50.tar.gz 2、解压tomcat到&#x2F;opt目录tar -xzvf apache-tomcat-8"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2018-03-27T06:00:00.000Z"><meta property="article:modified_time" content="2018-03-27T06:00:00.000Z"><meta property="article:author" content="好好学习的郝"><meta property="article:tag" content="tomcat"><meta property="article:tag" content="centos"><meta property="article:tag" content="supervisor"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://www.voidking.com/dev-centos-tomcat-autostart/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0}</script><title>CentOS7设置tomcat开机自启动 | 好好学习的郝</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?b759ac2a7fa45129e3ef060bf68259f0";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="好好学习的郝" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">好好学习的郝</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">好好学习，天天向上！</h1></div><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/voidking" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.voidking.com/dev-centos-tomcat-autostart/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="好好学习的郝"><meta itemprop="description" content="学而不思则罔，思而不学则殆！"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="好好学习的郝"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> CentOS7设置tomcat开机自启动</h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2018-03-27 14:00:00" itemprop="dateCreated datePublished" datetime="2018-03-27T14:00:00+08:00">2018-03-27</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E4%B8%93%E4%B8%9A/" itemprop="url" rel="index"><span itemprop="name">专业</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E4%B8%93%E4%B8%9A/%E8%BF%90%E7%BB%B4/" itemprop="url" rel="index"><span itemprop="name">运维</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E4%B8%93%E4%B8%9A/%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">开发</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E4%B8%93%E4%B8%9A/%E8%BF%90%E7%BB%B4/centos/" itemprop="url" rel="index"><span itemprop="name">centos</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E4%B8%93%E4%B8%9A/%E5%BC%80%E5%8F%91/tomcat/" itemprop="url" rel="index"><span itemprop="name">tomcat</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="安装tomcat"><a href="#安装tomcat" class="headerlink" title="安装tomcat"></a>安装tomcat</h2><p>首先参考<a href="https://www.voidking.com/dev-install-jdk-on-all-platforms/">《全平台安装JDK》</a>，安装配置好JDK，然后按照下面的流程安装tomcat。</p><p>1、下载tomcat8.0.50<br><code>wget http://www-eu.apache.org/dist/tomcat/tomcat-8/v8.0.50/bin/apache-tomcat-8.0.50.tar.gz</code></p><p>2、解压tomcat到/opt目录<br><code>tar -xzvf apache-tomcat-8.0.50.tar.gz -C /opt</code></p><p>3、启动tomcat<br><code>cd /opt/apache-tomcat-8.0.50/bin/</code></p><p><code>./startup.sh</code></p><a id="more"></a><p>4、测试访问<br><code>curl localhost:8080</code><br>至此，遇到一个大坑。curl命令卡在那里不动了，浏览器访问也是一直转圈，转啊转，十几分钟了还在转。。。莫非，tomcat版本有问题？换了8.5.29，不行；换了7.0.85，不行。莫非是jdk版本有问题？毕竟第一次是使用yum命令安装的。换了1.8.0_161，依然不行。</p><p>好在，最终找到了答案：<a href="https://blog.csdn.net/qq276726581/article/details/53790926" target="_blank" rel="noopener">Centos7+Tomcat8配置javaweb环境，tomcat启动巨慢的问题</a>，安装rng服务。</p><p>（1）安装熵服务<br><code>yum install rng-tools</code><br>（2）启动服务<br><code>systemctl start rngd</code><br>然后，tomcat就启动成功了。<br>（3）赶紧把rng服务放进开机自启动<br><code>systemctl enable rngd</code></p><p>5、关闭tomcat。<br><code>./shutdown.sh</code></p><h2 id="设置开机自启动"><a href="#设置开机自启动" class="headerlink" title="设置开机自启动"></a>设置开机自启动</h2><p>参考<a href="https://blog.csdn.net/u012351661/article/details/76254268" target="_blank" rel="noopener">《在CentOS7中设置Tomcat开机自启动》</a>，设置步骤如下：</p><p>假设tomcat目录为/opt/apache-tomcat-8.0.50</p><p>1、为Tomcat添加启动参数</p><p>catalina.sh在执行的时候会调用同级路径下的setenv.sh来设置额外的环境变量，因此在/opt/tomcat/bin路径下创建setenv.sh文件，内容如下：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置JAVA_HOME</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">JAVA_HOME</span>=/usr/lib/jvm/jdk1.8.0_161</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">JRE_HOME</span>=<span class="variable">$JAVA_HOME</span>/jre</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">CLASSPATH</span>=<span class="variable">$JAVA_HOME</span>/lib:$JRE_HOME/lib:$CLASSPATH</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="variable">$JAVA_HOME</span>/bin:$JRE_HOME/bin:$PATH</span><br><span class="line"></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">CATALINA_HOME</span>=/opt/apache-tomcat-8.0.50</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">CATALINA_BASE</span>=/opt/apache-tomcat-8.0.50</span><br><span class="line"><span class="comment"># 设置Tomcat的PID文件</span></span><br><span class="line"><span class="attribute">CATALINA_PID</span>=<span class="string">"<span class="variable">$CATALINA_BASE</span>/tomcat.pid"</span></span><br><span class="line"><span class="comment"># 添加JVM选项</span></span><br><span class="line"><span class="attribute">JAVA_OPTS</span>=<span class="string">"-server -XX:PermSize=256M -XX:MaxPermSize=1024m -Xms512M -Xmx1024M -XX:MaxNewSize=256m"</span></span><br></pre></td></tr></table></figure><p>2、在/usr/lib/systemd/system路径下添加tomcat.service文件，内容如下：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[Unit]</span></span><br><span class="line"><span class="attr">Description</span>=tomcat</span><br><span class="line"><span class="attr">After</span>=syslog.target network.target remote-fs.target nss-lookup.target</span><br><span class="line"></span><br><span class="line"><span class="section">[Service]</span></span><br><span class="line"><span class="attr">Type</span>=forking</span><br><span class="line"><span class="attr">PIDFile</span>=/opt/apache-tomcat-<span class="number">8.0</span>.<span class="number">50</span>/tomcat.pid</span><br><span class="line"><span class="attr">ExecStart</span>=/opt/apache-tomcat-<span class="number">8.0</span>.<span class="number">50</span>/bin/startup.sh</span><br><span class="line"><span class="attr">ExecReload</span>=/bin/kill -s HUP <span class="variable">$MAINPID</span></span><br><span class="line"><span class="attr">ExecStop</span>=/bin/kill -s QUIT <span class="variable">$MAINPID</span></span><br><span class="line"><span class="attr">PrivateTmp</span>=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="section">[Install]</span></span><br><span class="line"><span class="attr">WantedBy</span>=multi-user.target</span><br></pre></td></tr></table></figure><p>3、把tomcat加入开机自启动<br><code>systemctl enable tomcat.service</code></p><p>4、重启服务器<br><code>reboot</code></p><p>5、再次连接后，查看服务状态<br><code>systemctl status tomcat.service</code></p><p>看到tomcat已经启动，正想着大功告成，却发现浏览器访问又开始转圈了。检查rng服务，启动正常。<br>直接使用<code>./startup.sh</code>启动正常，而使用<code>systemctl start tomcat</code>就转圈，还能是什么原因？<br>参照<a href="https://www.cnblogs.com/jie-fang/p/7211574.html" target="_blank" rel="noopener">《CentOS7下Tomcat启动慢的原因及解决方案》</a>一文，修改java.security，无效；修改catalina.sh，无效。<br>是不是tomcat.service写的有问题，参照其他配置方案修改，依然无效。<br>想到<a href="http://www.voidking.com/dev-dockerfile-supervisor/">《Dockerfile使用Supervisor管理Tomcat》</a>一文中，supervisor启动tomcat也会有些问题。那么，修改startup.sh呢？依然无效。</p><p>万万没想到，最后一步还有这么个深坑，沉思良久，莫非，要换init.d方法来设置启动？目前看来，只能这样了。</p><h2 id="删除开机自启动"><a href="#删除开机自启动" class="headerlink" title="删除开机自启动"></a>删除开机自启动</h2><p>1、删除tomcat.service<br><code>find / -name &quot;tomcat*&quot;</code><br><code>rm /usr/lib/systemd/system/tomcat.service</code><br><code>rm /etc/systemd/system/multi-user.target.wants/tomcat.service</code><br><code>rm /etc/selinux/targeted/active/modules/100/tomcat</code></p><p>2、测试启动<br><code>systemctl daemon-reload</code><br><code>systemctl start tomcat.service</code><br>出现提示Failed to start tomcat.service: Unit not found.说明删除成功。</p><h2 id="设置开机自启动之init-d"><a href="#设置开机自启动之init-d" class="headerlink" title="设置开机自启动之init.d"></a>设置开机自启动之init.d</h2><p>1、在/etc/init.d下创建服务脚本<br><code>vim /etc/init.d/tomcat</code><br>写入内容如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># tomcat startup script for the Tomcat server</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># chkconfig: 345 80 20</span></span><br><span class="line"><span class="comment"># description: start the tomcat deamon</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Source function library</span></span><br><span class="line">. /etc/rc.d/init.d/<span class="built_in">functions</span></span><br><span class="line"></span><br><span class="line">prog=tomcat</span><br><span class="line"><span class="comment"># 根据自己的路径改写JAVA_HOME</span></span><br><span class="line">JAVA_HOME=/usr/lib/jvm/jdk1.8.0_161/  </span><br><span class="line"><span class="built_in">export</span> JAVA_HOME</span><br><span class="line"><span class="comment"># 根据自己的路径改写CATALANA_HOME</span></span><br><span class="line">CATALANA_HOME=/opt/apache-tomcat-8.0.50/   </span><br><span class="line"><span class="built_in">export</span> CATALINA_HOME</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">"<span class="variable">$1</span>"</span> <span class="keyword">in</span></span><br><span class="line">start)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Starting Tomcat..."</span></span><br><span class="line">    <span class="variable">$CATALANA_HOME</span>/bin/startup.sh</span><br><span class="line">    ;;</span><br><span class="line"></span><br><span class="line">stop)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Stopping Tomcat..."</span></span><br><span class="line">    <span class="variable">$CATALANA_HOME</span>/bin/shutdown.sh</span><br><span class="line">    ;;</span><br><span class="line"></span><br><span class="line">restart)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Stopping Tomcat..."</span></span><br><span class="line">    <span class="variable">$CATALANA_HOME</span>/bin/shutdown.sh</span><br><span class="line">    sleep 2</span><br><span class="line">    <span class="built_in">echo</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Starting Tomcat..."</span></span><br><span class="line">    <span class="variable">$CATALANA_HOME</span>/bin/startup.sh</span><br><span class="line">    ;;</span><br><span class="line"></span><br><span class="line">*)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Usage: <span class="variable">$prog</span> &#123;start|stop|restart&#125;"</span></span><br><span class="line">    ;;</span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line"><span class="built_in">exit</span> 0</span><br></pre></td></tr></table></figure><p>2、更改权限<br><code>chmod a+x /etc/init.d/tomcat</code></p><p>3、测试启动<br><code>service tomcat start</code><br>启动成功，然而，还是转圈。。。</p><p>实际上，init.d方法添加的自启动服务，也会加入到systemctl的管理。因为，这时也可以用<code>systemctl start tomcat</code>来启动服务。</p><p>无奈，决定换成supervisor来设置自启动。</p><h2 id="设置开机自启动之supervisor"><a href="#设置开机自启动之supervisor" class="headerlink" title="设置开机自启动之supervisor"></a>设置开机自启动之supervisor</h2><p>开始设置前最好先删除init.d方法设置的自启动文件，虽然不影响使用，但是看着闹心。<br>参考<a href="https://www.voidking.com/dev-centos-supervisor/">《CentOS安装配置Supervisor》</a>，安装配置好supervisor。</p><p>1、在/etc/supervisor中新建tomcat.conf文件</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[program:tomcat]</span></span><br><span class="line"><span class="attr">directory</span>=/opt/apache-tomcat-<span class="number">8.0</span>.<span class="number">50</span></span><br><span class="line"><span class="attr">command</span>=/opt/apache-tomcat-<span class="number">8.0</span>.<span class="number">50</span>/bin/catalina.sh run</span><br><span class="line"><span class="attr">environment</span>=JAVA_HOME=<span class="string">"/usr/lib/jvm/jdk1.8.0_161"</span>,JAVA_BIN=<span class="string">"/usr/lib/jvm/jdk1.8.0_161/bin"</span></span><br><span class="line"><span class="attr">user</span>=root</span><br><span class="line"><span class="attr">autostart</span>=<span class="literal">true</span></span><br><span class="line"><span class="attr">autorestart</span>=<span class="literal">true</span></span><br><span class="line"><span class="attr">stdout_logfile</span>=/var/log/supervisor/%(program_name)s.log</span><br><span class="line"><span class="attr">stderr_logfile</span>=/var/log/supervisor/%(program_name)s.log</span><br></pre></td></tr></table></figure><p>2、重启supervisor<br><code>systemctl retart supervisord</code></p><p>3、重启tomcat<br><code>supervisorctl -c /etc/supervisord.conf restart tomcat</code></p><p>4、测试访问<br><code>curl localhost:8080</code>，成功。浏览器访问，成功。<br>换了三种自启动方式，总算成功了，不容易。。。</p><p>5、重启<br><code>reboot</code></p><p>6、二次测试<br>重启后执行<code>supervisorctl status</code>，tomcat正常运行。<br>curl命令和浏览器测试，正常。至此，tomcat自启动配置成功。其实，systemd和init.d两种方法，理论上也是可以成功的，访问转圈的锅肯定是机器和系统的。嗯，就是这样。</p></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 好好学习的郝</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://www.voidking.com/dev-centos-tomcat-autostart/" title="CentOS7设置tomcat开机自启动">https://www.voidking.com/dev-centos-tomcat-autostart/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！源站会及时更新知识点及修正错误，阅读体验也更好。欢迎分享，欢迎收藏~</li></ul></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/tomcat/" rel="tag"># tomcat</a> <a href="/tags/centos/" rel="tag"># centos</a> <a href="/tags/supervisor/" rel="tag"># supervisor</a></div><div class="post-nav"><div class="post-nav-item"><a href="/dev-centos-nginx-autostart/" rel="prev" title="CentOS7设置Nginx开机自启动"><i class="fa fa-chevron-left"></i> CentOS7设置Nginx开机自启动</a></div><div class="post-nav-item"> <a href="/dev-centos-mysql-autostart/" rel="next" title="CentOS7设置mysql开机自启动">CentOS7设置mysql开机自启动<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><div class="comments"><div id="lv-container" data-id="city" data-uid="MTAyMC8zODU3Mi8xNTEwMA=="></div></div><script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#安装tomcat"><span class="nav-number">1.</span> <span class="nav-text">安装tomcat</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#设置开机自启动"><span class="nav-number">2.</span> <span class="nav-text">设置开机自启动</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#删除开机自启动"><span class="nav-number">3.</span> <span class="nav-text">删除开机自启动</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#设置开机自启动之init-d"><span class="nav-number">4.</span> <span class="nav-text">设置开机自启动之init.d</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#设置开机自启动之supervisor"><span class="nav-number">5.</span> <span class="nav-text">设置开机自启动之supervisor</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="好好学习的郝" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">好好学习的郝</p><div class="site-description" itemprop="description">学而不思则罔，思而不学则殆！</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">645</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">52</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">201</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:voidking@qq.com" title="E-Mail → mailto:voidking@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://github.com/voidking" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="http://weibo.com/voidking" title="Weibo → http:&#x2F;&#x2F;weibo.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i> Weibo</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/voidking" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-quora"></i> Zhihu</a></span></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2014 – <span itemprop="copyrightYear">2022</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">好好学习的郝</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="footer-beian"> <a href="http://www.beian.miit.gov.cn/" target="_blank">苏ICP备14021030号</a>&nbsp;|&nbsp; <img src="/images/beian.png" alt=""> <a target="_blank" href="http://www.beian.gov.cn/">苏公网安备 32032202000223号</a></div></div></footer><div id="needsharebutton-float"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div></div><script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css"><script src="/lib/needsharebutton/needsharebutton.js"></script><script>pbOptions={iconStyle:"box",boxForm:"horizontal",position:"bottomCenter",networks:"Weibo,Wechat,Douban,QQZone,Twitter,Facebook"},new needShareButton("#needsharebutton-postbottom",pbOptions),flOptions={iconStyle:"box",boxForm:"horizontal",position:"topRight",networks:"Weibo,Wechat,Douban,QQZone,Twitter,Facebook"},new needShareButton("#needsharebutton-float",flOptions)</script><script>
NexT.utils.loadComments(document.querySelector('#lv-container'), () => {
  // window.livereOptions = {
  //   refer: location.pathname.replace(CONFIG.root, '').replace('index.html', '')
  // };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
});
</script></body></html>