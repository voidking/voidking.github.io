<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:new URL("https://www.voidking.com").hostname,root:"/",scheme:"Gemini",version:"7.7.1",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1,cdn:{enable:!0,url:"//qiniu-cdn.voidking.com/doc/search.xml"}},path:"search.xml",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="前言《好好学GitLab：CentOS7安装配置GitLab》一文中学习了GitLab的安装方法，如果使用Docker来安装GitLab，可以简单很多。 参考文档：  Install GitLab using Docker Install self-managed GitLab GitLab Security Release"><meta property="og:type" content="article"><meta property="og:title" content="好好学GitLab：使用Docker安装配置GitLab"><meta property="og:url" content="https://www.voidking.com/dev-docker-gitlab/index.html"><meta property="og:site_name" content="好好学习的郝"><meta property="og:description" content="前言《好好学GitLab：CentOS7安装配置GitLab》一文中学习了GitLab的安装方法，如果使用Docker来安装GitLab，可以简单很多。 参考文档：  Install GitLab using Docker Install self-managed GitLab GitLab Security Release"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2019-12-28T17:00:00.000Z"><meta property="article:modified_time" content="2024-07-20T08:00:00.000Z"><meta property="article:author" content="好好学习的郝"><meta property="article:tag" content="git"><meta property="article:tag" content="docker"><meta property="article:tag" content="gitlab"><meta property="article:tag" content="好好学GitLab"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://www.voidking.com/dev-docker-gitlab/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0}</script><title>好好学GitLab：使用Docker安装配置GitLab | 好好学习的郝</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?b759ac2a7fa45129e3ef060bf68259f0";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="好好学习的郝" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">好好学习的郝</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">一个计算机技术爱好者与学习者</h1></div><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/voidking" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.voidking.com/dev-docker-gitlab/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="好好学习的郝"><meta itemprop="description" content="一个计算机技术爱好者与学习者"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="好好学习的郝"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> 好好学GitLab：使用Docker安装配置GitLab</h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-12-28 17:00:00" itemprop="dateCreated datePublished" datetime="2019-12-28T17:00:00+00:00">2019-12-28</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2024-07-20 08:00:00" itemprop="dateModified" datetime="2024-07-20T08:00:00+00:00">2024-07-20</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/" itemprop="url" rel="index"><span itemprop="name">engineering</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/docker/" itemprop="url" rel="index"><span itemprop="name">docker</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/git/" itemprop="url" rel="index"><span itemprop="name">git</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="前言"><span class="post-title-index">1.</span><a href="#前言" class="headerlink" title="前言"></a> 前言</h1><p><a href="https://www.voidking.com/dev-centos7-install-gitlab/">《好好学GitLab：CentOS7安装配置GitLab》</a>一文中学习了GitLab的安装方法，如果使用Docker来安装GitLab，可以简单很多。</p><p>参考文档：</p><ul><li><a target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/install/docker.html">Install GitLab using Docker</a></li><li><a target="_blank" rel="noopener" href="https://about.gitlab.com/install/">Install self-managed GitLab</a></li><li><a target="_blank" rel="noopener" href="https://about.gitlab.com/releases/categories/releases/">GitLab Security Release</a></li></ul><span id="more"></span><h1 id="安装Docker"><span class="post-title-index">2.</span><a href="#安装Docker" class="headerlink" title="安装Docker"></a> 安装Docker</h1><p>Docker安装方法参考文档<a href="https://www.voidking.com/dev-docker-start/">《好好学Docker：Docker入门》</a>。</p><h1 id="安装GitLab"><span class="post-title-index">3.</span><a href="#安装GitLab" class="headerlink" title="安装GitLab"></a> 安装GitLab</h1><p>1、登录dockerhub查看可选的<a target="_blank" rel="noopener" href="https://hub.docker.com/r/gitlab/gitlab-ce/">GitLab Docker images</a>。</p><p>2、下载gitlab镜像（以16.3.6-ce.0版本为例，这是一个Security Release版本）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull gitlab/gitlab-ce:16.3.6-ce.0</span><br></pre></td></tr></table></figure><p>3、启动gitlab服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">docker run --name vk-gitlab -d \</span><br><span class="line">  --restart always \</span><br><span class="line">  --hostname gitlab.voidking.com \</span><br><span class="line">  --shm-size 256m \</span><br><span class="line">  --<span class="built_in">env</span> GITLAB_OMNIBUS_CONFIG=<span class="string">&quot;external_url &#x27;http://gitlab.voidking.com&#x27;&quot;</span> \</span><br><span class="line">  -p 443:443 -p 80:80 -p 3422:22 \</span><br><span class="line">  -v /opt/gitlab/config:/etc/gitlab \</span><br><span class="line">  -v /opt/gitlab/logs:/var/log/gitlab \</span><br><span class="line">  -v /opt/gitlab/data:/var/opt/gitlab \</span><br><span class="line">  gitlab/gitlab-ce:16.3.6-ce.0</span><br></pre></td></tr></table></figure><p>参数说明：</p><ul><li>命名容器为vk-gitlab，后台运行</li><li>设置容器意外关闭自动重启</li><li>设置容器名为 gitlab.voidking.com</li><li>容器的 /dev/shm 分区大小是256m，而不是默认的64m，用作进程之间共享内存的接口</li><li>设置gitlab的对外url为 <a target="_blank" rel="noopener" href="http://gitlab.voidking.com/">http://gitlab.voidking.com</a></li><li>映射宿主机80、443、3422端口到容器80、443、22端口</li><li>挂载三个宿主机目录到容器，以便持久化数据</li></ul><p>启动大概需要5到10分钟，请耐心等待。</p><p>4、验证安装</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker ps</span><br><span class="line">docker logs vk-gitlab</span><br></pre></td></tr></table></figure><p>gitlab启动正常的话就可以看到vk-gitlab容器。<br>如果启动失败，通过查看启动日志，排查启动失败原因并解决。</p><p>5、查看gitlab root用户密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it vk-gitlab grep <span class="string">&#x27;Password:&#x27;</span> /etc/gitlab/initial_root_password</span><br></pre></td></tr></table></figure><p>PS：如果是低版本的gitlab，比如 12.6.1-ce.0 ，那么不需要这个步骤，在首次访问dashboard时会提示修改密码。</p><h1 id="放通外部访问"><span class="post-title-index">4.</span><a href="#放通外部访问" class="headerlink" title="放通外部访问"></a> 放通外部访问</h1><p>对外开放端口</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --add-port=80/tcp --permanent</span><br><span class="line">firewall-cmd --add-port=443/tcp --permanent</span><br><span class="line">firewall-cmd --add-port=3422/tcp --permanent</span><br><span class="line">systemctl reload firewalld</span><br></pre></td></tr></table></figure><p>或者关闭防火墙</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld</span><br></pre></td></tr></table></figure><h1 id="测试GitLab"><span class="post-title-index">5.</span><a href="#测试GitLab" class="headerlink" title="测试GitLab"></a> 测试GitLab</h1><h2 id="测试访问GitLab端口"><span class="post-title-index">5.1.</span><a href="#测试访问GitLab端口" class="headerlink" title="测试访问GitLab端口"></a> 测试访问GitLab端口</h2><p>宿主机上访问gitlab端口</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nc -zv localhost 80</span><br><span class="line">nc -zv localhost 443</span><br><span class="line">nc -zv localhost 3422</span><br></pre></td></tr></table></figure><p>外部主机访问gitlab端口（已知Docker宿主机IP为 192.168.56.130 ）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nc -zv 192.168.56.130 80</span><br><span class="line">nc -zv 192.168.56.130 443</span><br><span class="line">nc -zv 192.168.56.130 3422</span><br></pre></td></tr></table></figure><h2 id="测试访问GitLab服务"><span class="post-title-index">5.2.</span><a href="#测试访问GitLab服务" class="headerlink" title="测试访问GitLab服务"></a> 测试访问GitLab服务</h2><p>宿主机上访问gitlab服务：<code>curl localhost -L</code><br>外部主机浏览器访问gitlab服务：<a target="_blank" rel="noopener" href="http://192.168.56.130/">http://192.168.56.130</a></p><h1 id="配置GitLab"><span class="post-title-index">6.</span><a href="#配置GitLab" class="headerlink" title="配置GitLab"></a> 配置GitLab</h1><h2 id="配置对外展示的URL"><span class="post-title-index">6.1.</span><a href="#配置对外展示的URL" class="headerlink" title="配置对外展示的URL"></a> 配置对外展示的URL</h2><p>1、配置url和ssh协议端口<br><code>vim /opt/gitlab/config/gitlab.rb</code>，如下修改：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">external_url &#x27;http://gitlab.voidking.com&#x27;</span><br><span class="line">gitlab_rails[&#x27;gitlab_ssh_host&#x27;] = &#x27;gitlab.voidking.com&#x27;</span><br><span class="line">gitlab_rails[&#x27;gitlab_shell_ssh_port&#x27;] = 3422</span><br></pre></td></tr></table></figure><p>gitlab.rb 配置中又涉及到了 external_url ，这里的优先级高于 docker run 时配置的环境变量的优先级。</p><p>该配置的效果是，当用户在gitlab项目页面点击Clone时，<code>Clone with HTTP</code>和<code>Clone with SSH</code>的结果类似于：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://gitlab.voidking.com/root/voidking.git</span><br><span class="line">ssh://git@gitlab.voidking.com:3422/root/voidking.git</span><br></pre></td></tr></table></figure><p>2、重启vk-gitlab</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker restart vk-gitlab</span><br></pre></td></tr></table></figure><h2 id="禁用更新提醒"><span class="post-title-index">6.2.</span><a href="#禁用更新提醒" class="headerlink" title="禁用更新提醒"></a> 禁用更新提醒</h2><p>管理员登录dashboard后，无论点击什么页面，都会跳出一个更新提示框：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Important notice - Critical security release</span><br></pre></td></tr></table></figure><p>禁用方法：Admin Area -&gt; Settings -&gt; Metrics and Profiling -&gt; Usage Statistics -&gt; turn off the option for Enable version check</p><p>参考文档：<a target="_blank" rel="noopener" href="https://forum.gitlab.com/t/how-to-disable-update-notifications-for-admin-which-arent-possible-to-update-at-all/86402">How to disable update notifications for admin which aren’t possible to update at all?</a></p><h2 id="http域名访问"><span class="post-title-index">6.3.</span><a href="#http域名访问" class="headerlink" title="http域名访问"></a> http域名访问</h2><h3 id="单机配置hosts"><span class="post-title-index">6.3.1.</span><a href="#单机配置hosts" class="headerlink" title="单机配置hosts"></a> 单机配置hosts</h3><p>修改同一局域网内某台设备的 /etc/hosts，添加：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">192.168.56.103  gitlab.voidking.com</span><br></pre></td></tr></table></figure><p>然后，这台设备就可以通过域名 <a target="_blank" rel="noopener" href="http://gitlab.voidking.com/">http://gitlab.voidking.com</a> 访问gitlab服务了。</p><h3 id="本地DNS配置域名解析"><span class="post-title-index">6.3.2.</span><a href="#本地DNS配置域名解析" class="headerlink" title="本地DNS配置域名解析"></a> 本地DNS配置域名解析</h3><p>本地DNS配置域名解析：gitlab.voidking.com -&gt; 192.168.56.103<br>然后，同一局域网内所有使用本地DNS的设备就可以通过域名 <a target="_blank" rel="noopener" href="http://gitlab.voidking.com/">http://gitlab.voidking.com</a> 访问gitlab服务了。</p><h2 id="https域名访问"><span class="post-title-index">6.4.</span><a href="#https域名访问" class="headerlink" title="https域名访问"></a> https域名访问</h2><p>参考<a href="https://www.voidking.com/dev-centos7-install-gitlab/">《好好学GitLab：CentOS7安装配置GitLab》</a>添加SSL一节，生成证书，配置gitlab使用证书，并且添加到浏览器。</p><h1 id="使用GitLab"><span class="post-title-index">7.</span><a href="#使用GitLab" class="headerlink" title="使用GitLab"></a> 使用GitLab</h1><p>1、创建项目<br>Create a Project，Project name填入voidking，选择Public，勾选Initialize repository with a README。</p><p>2、clone项目</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global http.sslVerify <span class="literal">false</span></span><br><span class="line">git <span class="built_in">clone</span> https://gitlab.voidking.com/root/voidking.git</span><br></pre></td></tr></table></figure><p>3、上传代码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;do something&quot;</span></span><br><span class="line">git push</span><br></pre></td></tr></table></figure><h1 id="修改root密码"><span class="post-title-index">8.</span><a href="#修改root密码" class="headerlink" title="修改root密码"></a> 修改root密码</h1><p>参考文档：</p><ul><li><a target="_blank" rel="noopener" href="https://sslover.me/2023/06/15/gitlab-reset-the-root-password/">重置 GitLab 管理员密码</a></li><li><a target="_blank" rel="noopener" href="https://docs.gitlab.cn/jh/security/reset_user_password.html">重置用户的密码</a></li></ul><p>1、进入rails控制台</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it vk-gitlab /bin/bash</span><br><span class="line">gitlab-rails console</span><br></pre></td></tr></table></figure><p>2、重置密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">user = User.find(1)</span><br><span class="line">newpassword=<span class="string">&#x27;xxx&#x27;</span></span><br><span class="line">user.password=newpassword</span><br><span class="line">user.password_confirmation=newpassword</span><br><span class="line">user.save!</span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 好好学习的郝</li><li class="post-copyright-link"> <strong>原文链接：</strong> <a href="https://www.voidking.com/dev-docker-gitlab/" title="好好学GitLab：使用Docker安装配置GitLab">https://www.voidking.com/dev-docker-gitlab/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本文采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议，转载请注明出处！源站会即时更新知识点并修正错误，欢迎访问~</li></ul></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/git/" rel="tag"># git</a> <a href="/tags/docker/" rel="tag"># docker</a> <a href="/tags/gitlab/" rel="tag"># gitlab</a> <a href="/tags/%E5%A5%BD%E5%A5%BD%E5%AD%A6GitLab/" rel="tag"># 好好学GitLab</a></div><div class="post-nav"><div class="post-nav-item"><a href="/dev-docker-mysql/" rel="prev" title="好好学MySQL：使用Docker安装配置MySQL"><i class="fa fa-chevron-left"></i> 好好学MySQL：使用Docker安装配置MySQL</a></div><div class="post-nav-item"> <a href="/dev-docker-jenkins/" rel="next" title="好好学Docker：使用Docker安装配置Jenkins">好好学Docker：使用Docker安装配置Jenkins<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><div class="footer-ads" style="margin-top:10px"><ins class="adsbygoogle" style="display:block" data-ad-format="autorelaxed" data-ad-client="ca-pub-3284447971731414" data-ad-slot="9697986181"></ins><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3284447971731414" crossorigin="anonymous"></script><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div class="comments" id="gitalk-container"></div><script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-text">1. 前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%89%E8%A3%85Docker"><span class="nav-text">2. 安装Docker</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%89%E8%A3%85GitLab"><span class="nav-text">3. 安装GitLab</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%94%BE%E9%80%9A%E5%A4%96%E9%83%A8%E8%AE%BF%E9%97%AE"><span class="nav-text">4. 放通外部访问</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95GitLab"><span class="nav-text">5. 测试GitLab</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95%E8%AE%BF%E9%97%AEGitLab%E7%AB%AF%E5%8F%A3"><span class="nav-text">5.1. 测试访问GitLab端口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95%E8%AE%BF%E9%97%AEGitLab%E6%9C%8D%E5%8A%A1"><span class="nav-text">5.2. 测试访问GitLab服务</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%85%8D%E7%BD%AEGitLab"><span class="nav-text">6. 配置GitLab</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E5%AF%B9%E5%A4%96%E5%B1%95%E7%A4%BA%E7%9A%84URL"><span class="nav-text">6.1. 配置对外展示的URL</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A6%81%E7%94%A8%E6%9B%B4%E6%96%B0%E6%8F%90%E9%86%92"><span class="nav-text">6.2. 禁用更新提醒</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#http%E5%9F%9F%E5%90%8D%E8%AE%BF%E9%97%AE"><span class="nav-text">6.3. http域名访问</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%95%E6%9C%BA%E9%85%8D%E7%BD%AEhosts"><span class="nav-text">6.3.1. 单机配置hosts</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%AC%E5%9C%B0DNS%E9%85%8D%E7%BD%AE%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90"><span class="nav-text">6.3.2. 本地DNS配置域名解析</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#https%E5%9F%9F%E5%90%8D%E8%AE%BF%E9%97%AE"><span class="nav-text">6.4. https域名访问</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8GitLab"><span class="nav-text">7. 使用GitLab</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9root%E5%AF%86%E7%A0%81"><span class="nav-text">8. 修改root密码</span></a></li></ol></div></div><div class="sidecar-ads" style="margin-top:10px"><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="好好学习的郝" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">好好学习的郝</p><div class="site-description" itemprop="description">一个计算机技术爱好者与学习者</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">748</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">32</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">259</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:voidking@qq.com" title="E-Mail → mailto:voidking@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://github.com/voidking" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="http://weibo.com/voidking" title="Weibo → http:&#x2F;&#x2F;weibo.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i> Weibo</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/voidking" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-quora"></i> Zhihu</a></span></div></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2014 – <span itemprop="copyrightYear">2025</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">好好学习的郝</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="footer-beian"> <a href="http://beian.miit.gov.cn/" target="_blank">苏ICP备14021030号</a>&nbsp;|&nbsp; <img src="/images/beian.png" alt=""> <a target="_blank" href="http://www.beian.gov.cn/">苏公网安备 32032202000223号</a></div></div></footer></div><script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.css"><script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: '5a238b8c32b1e4dd2156',
      clientSecret: 'bfb5d518626f6fdc7da0351d1e0cd37ab75c6361',
      repo: 'gitalk-comments',
      owner: 'voidking',
      admin: ['voidking'],
      id: '7b6d183948b3e6619a9072cf0fe15ca2',
      title: '好好学GitLab：使用Docker安装配置GitLab',
      body: '欢迎留言，互相交流学习~',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script></body></html>