<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:new URL("https://www.voidking.com").hostname,root:"/",scheme:"Gemini",version:"7.7.1",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1,cdn:{enable:!0,url:"//qiniu-cdn.voidking.com/doc/search.xml"}},path:"search.xml",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="前言程序员的工作就是填坑，有时是填别人挖的坑，有时是填自己挖的坑。"><meta property="og:type" content="article"><meta property="og:title" content="好好学Node.js：使用Node.js处理微信自定义分享时的URL"><meta property="og:url" content="https://www.voidking.com/dev-nodejs-weixin-share-url/index.html"><meta property="og:site_name" content="好好学习的郝"><meta property="og:description" content="前言程序员的工作就是填坑，有时是填别人挖的坑，有时是填自己挖的坑。"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2016-07-18T21:35:24.000Z"><meta property="article:modified_time" content="2016-07-18T21:35:24.000Z"><meta property="article:author" content="好好学习的郝"><meta property="article:tag" content="微信"><meta property="article:tag" content="好好学Node.js"><meta property="article:tag" content="nodejs"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://www.voidking.com/dev-nodejs-weixin-share-url/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0}</script><title>好好学Node.js：使用Node.js处理微信自定义分享时的URL | 好好学习的郝</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?b759ac2a7fa45129e3ef060bf68259f0";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="好好学习的郝" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">好好学习的郝</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">一个计算机技术爱好者与学习者</h1></div><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/voidking" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.voidking.com/dev-nodejs-weixin-share-url/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="好好学习的郝"><meta itemprop="description" content="一个计算机技术爱好者与学习者"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="好好学习的郝"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> 好好学Node.js：使用Node.js处理微信自定义分享时的URL</h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2016-07-18 21:35:24" itemprop="dateCreated datePublished" datetime="2016-07-18T21:35:24+00:00">2016-07-18</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/" itemprop="url" rel="index"><span itemprop="name">engineering</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/nodejs/" itemprop="url" rel="index"><span itemprop="name">nodejs</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="前言"><span class="post-title-index">1.</span><a href="#前言" class="headerlink" title="前言"></a> 前言</h1><p>程序员的工作就是填坑，有时是填别人挖的坑，有时是填自己挖的坑。</p><span id="more"></span><h1 id="微信自定义分享"><span class="post-title-index">2.</span><a href="#微信自定义分享" class="headerlink" title="微信自定义分享"></a> 微信自定义分享</h1><p>在使用node开发的时候，经常会用到微信自定义分享。自定义分享的步骤，大致如下：</p><h2 id="微信配置"><span class="post-title-index">2.1.</span><a href="#微信配置" class="headerlink" title="微信配置"></a> 微信配置</h2><p>登录微信公众平台，进入“公众号设置”的“功能设置”里填写“JS接口安全域名”。</p><h2 id="node端"><span class="post-title-index">2.2.</span><a href="#node端" class="headerlink" title="node端"></a> node端</h2><p>1、设置分享数据（TKD）。<br>2、获取权限验证配置数据。<br>3、获取用户信息（非必要），因为需要在分享页面显示分享用户的昵称。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> config = <span class="built_in">require</span>(<span class="string">&#x27;../config&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> urlencode = <span class="built_in">require</span>(<span class="string">&#x27;urlencode&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> eventproxy = <span class="built_in">require</span>(<span class="string">&#x27;eventproxy&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> request = <span class="built_in">require</span>(<span class="string">&#x27;request&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">WechatAPI</span> = <span class="built_in">require</span>(<span class="string">&#x27;wechat-api&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">WXapi</span> = <span class="keyword">new</span> <span class="title class_">WechatAPI</span>(config.<span class="property">weixin</span>.<span class="property">appid</span>, config.<span class="property">weixin</span>.<span class="property">appsecret</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 微信</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">home</span> = <span class="keyword">function</span>(<span class="params">req, res</span>)&#123;</span><br><span class="line">    <span class="comment">// 获取code</span></span><br><span class="line">    <span class="keyword">var</span> subscribe = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(!req.<span class="property">query</span>.<span class="property">code</span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> r_url = config.<span class="property">host</span>+<span class="string">&#x27;/weixin/home&#x27;</span>;</span><br><span class="line">        <span class="keyword">var</span> url = <span class="string">&#x27;https://open.weixin.qq.com/connect/oauth2/authorize?appid=&#x27;</span>+config.<span class="property">weixin</span>.<span class="property">appid</span>+<span class="string">&#x27;&amp;redirect_uri=&#x27;</span>+<span class="title function_">urlencode</span>(r_url)+<span class="string">&#x27;&amp;response_type=code&amp;scope=snsapi_userinfo&amp;state=111#wechat_redirect&#x27;</span>;</span><br><span class="line">        res.<span class="title function_">redirect</span>(url);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> code = req.<span class="property">query</span>.<span class="property">code</span>;</span><br><span class="line">        <span class="keyword">var</span> state = req.<span class="property">query</span>.<span class="property">state</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> ep = <span class="keyword">new</span> <span class="title function_">eventproxy</span>();</span><br><span class="line">        ep.<span class="title function_">all</span>(<span class="string">&#x27;shareConfig&#x27;</span>,<span class="string">&#x27;userInfo&#x27;</span>,<span class="keyword">function</span>(<span class="params">shareConfigData,userInfoData</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(shareConfigData);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(userInfoData);</span><br><span class="line">            <span class="comment">// 设置分享数据（TKD）</span></span><br><span class="line">            <span class="keyword">var</span> shareData = &#123;</span><br><span class="line">                <span class="attr">enable</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">title</span>: <span class="string">&#x27;分享&#x27;</span>,</span><br><span class="line">                <span class="attr">icon</span>: <span class="string">&#x27;http://cdn.voidking.com/img/head.jpg&#x27;</span>,</span><br><span class="line">                <span class="attr">desc</span>: <span class="string">&#x27;没见过这么拉风的分享描述吧！&#x27;</span>,</span><br><span class="line">                <span class="attr">mUrl</span>: config.<span class="property">host</span>+<span class="string">&#x27;/weixin/userinfo?openid=000&amp;nickname=voidking&amp;num=10&#x27;</span></span><br><span class="line">            &#125;;</span><br><span class="line">            res.<span class="title function_">render</span>(<span class="string">&#x27;./weixin/home&#x27;</span>,&#123;</span><br><span class="line">                <span class="attr">title</span>: <span class="string">&#x27;微信&#x27;</span>,</span><br><span class="line">                <span class="attr">host</span>: config.<span class="property">host</span>,</span><br><span class="line">                <span class="attr">shareConfigData</span>: shareConfigData,</span><br><span class="line">                <span class="attr">shareData</span>: shareData,</span><br><span class="line">                <span class="attr">userInfoData</span>: <span class="title class_">JSON</span>.<span class="title function_">parse</span>(userInfoData)</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> param = &#123;</span><br><span class="line">            <span class="attr">debug</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">jsApiList</span>: [<span class="string">&#x27;onMenuShareTimeline&#x27;</span>, <span class="string">&#x27;onMenuShareAppMessage&#x27;</span>],</span><br><span class="line">            <span class="attr">url</span>: req.<span class="property">protocol</span>+<span class="string">&quot;://&quot;</span>+req.<span class="property">hostname</span>+req.<span class="property">originalUrl</span></span><br><span class="line">        &#125;;     </span><br><span class="line">        <span class="title class_">WXapi</span>.<span class="title function_">getJsConfig</span>(param, <span class="keyword">function</span>(<span class="params">err,result</span>)&#123;</span><br><span class="line">            <span class="comment">// result就是权限配置验证配置数据</span></span><br><span class="line">            ep.<span class="title function_">emit</span>(<span class="string">&#x27;shareConfig&#x27;</span>,result);    </span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 通过code换取网页授权access_token</span></span><br><span class="line">        <span class="keyword">var</span> params = &#123;</span><br><span class="line">            <span class="attr">appid</span>:config.<span class="property">weixin</span>.<span class="property">appid</span>,</span><br><span class="line">            <span class="attr">secret</span>:config.<span class="property">weixin</span>.<span class="property">appsecret</span>,</span><br><span class="line">            <span class="attr">code</span>:code,</span><br><span class="line">            <span class="attr">grant_type</span>:<span class="string">&#x27;authorization_code&#x27;</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">var</span> getAccessTokenUrl = <span class="string">&#x27;https://api.weixin.qq.com/sns/oauth2/access_token?appid=&#x27;</span>+params.<span class="property">appid</span>+<span class="string">&#x27;&amp;secret=&#x27;</span>+params.<span class="property">secret</span>+<span class="string">&#x27;&amp;code=&#x27;</span>+params.<span class="property">code</span>+<span class="string">&#x27;&amp;grant_type=&#x27;</span>+params.<span class="property">grant_type</span>;</span><br><span class="line">        request.<span class="title function_">get</span>(getAccessTokenUrl,<span class="keyword">function</span>(<span class="params">error, response, body</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> (!error &amp;&amp; response.<span class="property">statusCode</span> == <span class="number">200</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> re = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(response.<span class="property">body</span>);</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(re);</span><br><span class="line">                <span class="keyword">var</span> getuserinfo = <span class="string">&#x27;https://api.weixin.qq.com/sns/userinfo?access_token=&#x27;</span>+re.<span class="property">access_token</span>+<span class="string">&#x27;&amp;openid=&#x27;</span>+re.<span class="property">openid</span>+<span class="string">&#x27;&amp;lang=zh_CN&#x27;</span>;</span><br><span class="line">                request.<span class="title function_">get</span>(getuserinfo,<span class="keyword">function</span>(<span class="params">error2, response2, body2</span>)&#123;</span><br><span class="line">                    <span class="keyword">if</span> (!error2 &amp;&amp; response2.<span class="property">statusCode</span> == <span class="number">200</span>) &#123;</span><br><span class="line">                        ep.<span class="title function_">emit</span>(<span class="string">&#x27;userInfo&#x27;</span>,response2.<span class="property">body</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="前端"><span class="post-title-index">2.3.</span><a href="#前端" class="headerlink" title="前端"></a> 前端</h2><p>1、前端页面中引入微信的js文件<code>http://res.wx.qq.com/open/js/jweixin-1.0.0.js</code>。<br>2、微信权限验证数据配置。<br>3、分享数据配置。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">    wx.<span class="title function_">config</span>(&#123;</span><br><span class="line">       <span class="attr">debug</span>:  <span class="literal">false</span>,  <span class="comment">//调式模式，设置为ture后会直接在网页上弹出调试信息，用于排查问题</span></span><br><span class="line">       <span class="attr">appId</span>: <span class="string">&#x27;&lt;%= shareConfigData.appId%&gt;&#x27;</span>,</span><br><span class="line">       <span class="attr">timestamp</span>: <span class="string">&#x27;&lt;%= shareConfigData.timestamp%&gt;&#x27;</span>,</span><br><span class="line">       <span class="attr">nonceStr</span>: <span class="string">&#x27;&lt;%= shareConfigData.nonceStr%&gt;&#x27;</span>,</span><br><span class="line">       <span class="attr">signature</span>: <span class="string">&#x27;&lt;%= shareConfigData.signature%&gt;&#x27;</span>,</span><br><span class="line">       <span class="attr">jsApiList</span>: [  <span class="comment">//需要使用的网页服务接口</span></span><br><span class="line">           <span class="string">&#x27;checkJsApi&#x27;</span>,  <span class="comment">//判断当前客户端版本是否支持指定JS接口</span></span><br><span class="line">           <span class="string">&#x27;onMenuShareTimeline&#x27;</span>, <span class="comment">//分享给好友</span></span><br><span class="line">           <span class="string">&#x27;onMenuShareAppMessage&#x27;</span>, <span class="comment">//分享到朋友圈</span></span><br><span class="line">           <span class="string">&#x27;onMenuShareQQ&#x27;</span>,  <span class="comment">//分享到QQ</span></span><br><span class="line">           <span class="string">&#x27;onMenuShareWeibo&#x27;</span> <span class="comment">//分享到微博</span></span><br><span class="line">       ]</span><br><span class="line">     &#125;);</span><br><span class="line">     wx.<span class="title function_">ready</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;   <span class="comment">//ready函数用于调用API，如果你的网页在加载后就需要自定义分享和回调功能，需要在此调用分享函数。//如果是微信游戏结束后，需要点击按钮触发得到分值后分享，这里就不需要调用API了，可以在按钮上绑定事件直接调用。因此，微信游戏由于大多需要用户先触发获取分值，此处请不要填写如下所示的分享API</span></span><br><span class="line">        wx.<span class="title function_">onMenuShareTimeline</span>(&#123;  <span class="comment">//例如分享到朋友圈的API  </span></span><br><span class="line">           <span class="attr">title</span>: <span class="string">&#x27;&lt;%= shareData.title%&gt;&#x27;</span>, <span class="comment">// 分享标题</span></span><br><span class="line">           <span class="attr">link</span>: <span class="string">&#x27;&lt;%= shareData.mUrl%&gt;&#x27;</span>, <span class="comment">// 分享链接</span></span><br><span class="line">           <span class="attr">imgUrl</span>: <span class="string">&#x27;&lt;%= shareData.icon%&gt;&#x27;</span>, <span class="comment">// 分享图标</span></span><br><span class="line">           <span class="attr">desc</span>:<span class="string">&#x27;&lt;%= shareData.desc%&gt;&#x27;</span>,</span><br><span class="line">           <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">               <span class="comment">// 用户确认分享后执行的回调函数</span></span><br><span class="line">           &#125;,</span><br><span class="line">           <span class="attr">cancel</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">               <span class="comment">// 用户取消分享后执行的回调函数</span></span><br><span class="line">           &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        wx.<span class="title function_">onMenuShareAppMessage</span>(&#123;  <span class="comment">//例如分享到朋友圈的API  </span></span><br><span class="line">           <span class="attr">title</span>: <span class="string">&#x27;&lt;%= shareData.title%&gt;&#x27;</span>, <span class="comment">// 分享标题</span></span><br><span class="line">           <span class="attr">link</span>: <span class="string">&#x27;&lt;%= shareData.mUrl%&gt;&#x27;</span>, <span class="comment">// 分享链接</span></span><br><span class="line">           <span class="attr">imgUrl</span>: <span class="string">&#x27;&lt;%= shareData.icon%&gt;&#x27;</span>, <span class="comment">// 分享图标</span></span><br><span class="line">           <span class="attr">desc</span>:<span class="string">&#x27;&lt;%= shareData.desc%&gt;&#x27;</span>,</span><br><span class="line">           <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">               <span class="comment">// 用户确认分享后执行的回调函数</span></span><br><span class="line">           &#125;,</span><br><span class="line">           <span class="attr">cancel</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">               <span class="comment">// 用户取消分享后执行的回调函数</span></span><br><span class="line">           &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        wx.<span class="title function_">onMenuShareQQ</span>(&#123;  <span class="comment">//例如分享到朋友圈的API  </span></span><br><span class="line">           <span class="attr">title</span>: <span class="string">&#x27;&lt;%= shareData.title%&gt;&#x27;</span>, <span class="comment">// 分享标题</span></span><br><span class="line">           <span class="attr">link</span>: <span class="string">&#x27;&lt;%= shareData.mUrl%&gt;&#x27;</span>, <span class="comment">// 分享链接</span></span><br><span class="line">           <span class="attr">imgUrl</span>: <span class="string">&#x27;&lt;%= shareData.icon%&gt;&#x27;</span>, <span class="comment">// 分享图标</span></span><br><span class="line">           <span class="attr">desc</span>:<span class="string">&#x27;&lt;%= shareData.desc%&gt;&#x27;</span>,</span><br><span class="line">           <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">               <span class="comment">// 用户确认分享后执行的回调函数</span></span><br><span class="line">           &#125;,</span><br><span class="line">           <span class="attr">cancel</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">               <span class="comment">// 用户取消分享后执行的回调函数</span></span><br><span class="line">           &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        wx.<span class="title function_">onMenuShareWeibo</span>(&#123;  <span class="comment">//例如分享到朋友圈的API  </span></span><br><span class="line">           <span class="attr">title</span>: <span class="string">&#x27;&lt;%= shareData.title%&gt;&#x27;</span>, <span class="comment">// 分享标题</span></span><br><span class="line">           <span class="attr">link</span>: <span class="string">&#x27;&lt;%= shareData.mUrl%&gt;&#x27;</span>, <span class="comment">// 分享链接</span></span><br><span class="line">           <span class="attr">imgUrl</span>: <span class="string">&#x27;&lt;%= shareData.icon%&gt;&#x27;</span>, <span class="comment">// 分享图标</span></span><br><span class="line">           <span class="attr">desc</span>:<span class="string">&#x27;&lt;%= shareData.desc%&gt;&#x27;</span>,</span><br><span class="line">           <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">               <span class="comment">// 用户确认分享后执行的回调函数</span></span><br><span class="line">           &#125;,</span><br><span class="line">           <span class="attr">cancel</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">               <span class="comment">// 用户取消分享后执行的回调函数</span></span><br><span class="line">           &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;); </span><br><span class="line">    wx.<span class="title function_">error</span>(<span class="keyword">function</span> (<span class="params">res</span>) &#123;</span><br><span class="line">        <span class="comment">// alert(res.errMsg);  //打印错误消息。及把 debug:false,设置为debug:ture就可以直接在网页上看到弹出的错误提示</span></span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="源码"><span class="post-title-index">2.4.</span><a href="#源码" class="headerlink" title="源码"></a> 源码</h2><p><a target="_blank" rel="noopener" href="https://github.com/voidking/nodebase/blob/master/controllers/weixin.js">https://github.com/voidking/nodebase/blob/master/controllers/weixin.js</a><br><a target="_blank" rel="noopener" href="https://github.com/voidking/nodebase/blob/master/views/weixin/home.html">https://github.com/voidking/nodebase/blob/master/views/weixin/home.html</a></p><h1 id="amp-转-amp-amp"><span class="post-title-index">3.</span><a href="#amp-转-amp-amp" class="headerlink" title="&amp;转&amp;amp;"></a> <code>&amp;</code>转<code>&amp;amp;</code></h1><p>以上，已经完成了微信自定义分享的工作。然而，还存在一些坑！！！</p><p>如上，我们的分享页面url为<code>http://wx.voidking.com/weixin/userinfo?openid=000&amp;nickname=voidking&amp;num=10</code>，参数是写死的，实际生产环境中需要使用真实数据拼接出来。</p><p>该分享页面的url，如果输出到页面上，就显示正常，比如使用隐藏的input接收。</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input <span class="attribute">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attribute">id</span>=<span class="string">&quot;url&quot;</span> <span class="attribute">value</span>=<span class="string">&quot;&lt;%= shareData.url%&gt;&quot;</span>&gt;</span><br></pre></td></tr></table></figure><p>显示结果为</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input <span class="attribute">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attribute">id</span>=<span class="string">&quot;url&quot;</span> <span class="attribute">value</span>=<span class="string">&quot;http://wx.voidking.com/weixin/userinfo?openid=000&amp;nickname=voidking&amp;num=10&quot;</span>&gt;</span><br></pre></td></tr></table></figure><p>但是，如果输出到微信分享的js中，url中的<code>&amp;</code>就会变成<code>&amp;amp;</code>。</p><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wx.onMenuShareTimeline(&#123;  <span class="comment">//例如分享到朋友圈的API  </span></span><br><span class="line">    <span class="keyword">link</span>: <span class="string">&#x27;&lt;%= shareData.mUrl%&gt;&#x27;</span>, <span class="comment">// 分享链接</span></span><br><span class="line">    <span class="comment">// 其他分享信息省略</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>显示结果为</p><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wx.onMenuShareTimeline(&#123;  <span class="comment">//例如分享到朋友圈的API  </span></span><br><span class="line">    <span class="keyword">link</span>: <span class="string">&#x27;http://wx.voidking.com/weixin/userinfo?openid=000&amp;amp;nickname=voidking&amp;amp;num=10&#x27;</span>, <span class="comment">// 分享链接</span></span><br><span class="line">    <span class="comment">// 其他分享信息省略</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>啊嘞，<code>&amp;</code>转义成了<code>&amp;amp;</code>！！！没错，这就是第一个坑。因为分享出去的url参数不是以常规<code>&amp;</code>间隔，而是<code>&amp;amp;</code>，所以增加了我们截取参数的难度。</p><p>有两种解决方案：<br>1、前端解决。输入内容到隐藏的input，然后获取值，添加到微信分享的js中。经测试，行不通。<br>2、node端解决。在跳转分享页面时，改变获取参数的方式，代码如下。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exports</span>.<span class="property">userinfo</span> = <span class="keyword">function</span>(<span class="params">req, res</span>)&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">getArg</span>(<span class="params">str,arg</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="title class_">RegExp</span>(<span class="string">&#x27;(^|&amp;)&#x27;</span> + arg + <span class="string">&#x27;=([^&amp;]*)(&amp;|$)&#x27;</span>, <span class="string">&#x27;i&#x27;</span>);</span><br><span class="line">        <span class="keyword">var</span> r = str.<span class="title function_">match</span>(reg);</span><br><span class="line">        <span class="keyword">if</span> (r != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">unescape</span>(r[<span class="number">2</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title class_">String</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">replaceAll</span>  = <span class="keyword">function</span>(<span class="params">s1,s2</span>)&#123;     </span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">replace</span>(<span class="keyword">new</span> <span class="title class_">RegExp</span>(s1,<span class="string">&quot;gm&quot;</span>),s2);     </span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> str = <span class="built_in">decodeURI</span>(req.<span class="property">url</span>.<span class="title function_">split</span>(<span class="string">&#x27;?&#x27;</span>)[<span class="number">1</span>]);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(str);</span><br><span class="line">    str = str.<span class="title function_">replaceAll</span>(<span class="string">&#x27;&amp;amp%3B&#x27;</span>,<span class="string">&#x27;&amp;&#x27;</span>); </span><br><span class="line">    str = str.<span class="title function_">replaceAll</span>(<span class="string">&#x27;&amp;amp;&#x27;</span>,<span class="string">&#x27;&amp;&#x27;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(str);</span><br><span class="line">    <span class="keyword">var</span> name = <span class="title function_">getArg</span>(str,<span class="string">&#x27;name&#x27;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(name);</span><br><span class="line">    res.<span class="title function_">render</span>(<span class="string">&#x27;weixin/userinfo&#x27;</span>,&#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&#x27;用户信息&#x27;</span>,</span><br><span class="line">        <span class="attr">host</span>: config.<span class="property">host</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="转-3B"><span class="post-title-index">4.</span><a href="#转-3B" class="headerlink" title=";转%3B"></a> <code>;</code>转<code>%3B</code></h1><p>以上，我们解决了微信分享中<code>&amp;</code>转义的问题，在电脑端或者安卓端查看分享都是正常的。然而，在IOS端查看会出现错误！！！</p><p>因为链接<code>http://wx.voidking.com/weixin/userinfo?openid=000&amp;amp;nickname=voidking&amp;amp;num=10</code>在使用IOS访问的时候，变成了<code>http://wx.voidking.com/weixin/userinfo?openid=000&amp;amp%3Bnickname=voidking&amp;amp%3Bnum=10</code>，<code>;</code>转义成了<code>%3B</code>！！！</p><p>解决办法，参考<code>&amp;</code>转<code>&amp;amp;</code>一节node端代码，替换字符串即可。</p><h1 id="从url中截取中文参数"><span class="post-title-index">5.</span><a href="#从url中截取中文参数" class="headerlink" title="从url中截取中文参数"></a> 从url中截取中文参数</h1><p>以上，url属性中name的值是voidking，没有什么问题。然而，当我把name的值换为“帅哥”时，控制台打印出了乱码。啊哈，这就对了，中文肯定要处理一下嘛！</p><p>解决办法，使用decodeURI函数解码编码过的uri，参考<code>&amp;</code>转<code>&amp;amp;</code>一节node端代码。</p><h1 id="书签"><span class="post-title-index">6.</span><a href="#书签" class="headerlink" title="书签"></a> 书签</h1><ul><li><a target="_blank" rel="noopener" href="http://mp.weixin.qq.com/wiki/7/aaa137b55fb2e0456bf8dd9148dd613f.html">微信公众平台开发者文档——微信JS-SDK说明文档</a></li><li><a target="_blank" rel="noopener" href="http://doxmate.cool/node-webot/wechat-api/api.html">微信公共平台Node库 API</a></li><li><a target="_blank" rel="noopener" href="http://doxmate.cool/node-webot/wechat-api/api.html#api_js_exports_getJsConfig">wechat-api Documentation</a></li></ul></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 好好学习的郝</li><li class="post-copyright-link"> <strong>原文链接：</strong> <a href="https://www.voidking.com/dev-nodejs-weixin-share-url/" title="好好学Node.js：使用Node.js处理微信自定义分享时的URL">https://www.voidking.com/dev-nodejs-weixin-share-url/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本文采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议，转载请注明出处！源站会即时更新知识点并修正错误，欢迎访问~</li></ul></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/%E5%BE%AE%E4%BF%A1/" rel="tag"># 微信</a> <a href="/tags/%E5%A5%BD%E5%A5%BD%E5%AD%A6Node-js/" rel="tag"># 好好学Node.js</a> <a href="/tags/nodejs/" rel="tag"># nodejs</a></div><div class="post-nav"><div class="post-nav-item"><a href="/dev-seajs-in-nodejs/" rel="prev" title="好好学Node.js：在Node.js项目中使用Sea.js"><i class="fa fa-chevron-left"></i> 好好学Node.js：在Node.js项目中使用Sea.js</a></div><div class="post-nav-item"> <a href="/dev-nodejs-exports-and-module-exports/" rel="next" title="好好学Node.js：Node.js中exports和module.exports的区别和联系">好好学Node.js：Node.js中exports和module.exports的区别和联系<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><div class="footer-ads" style="margin-top:10px"></div><div class="comments" id="gitalk-container"></div><script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-text">1. 前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%BE%AE%E4%BF%A1%E8%87%AA%E5%AE%9A%E4%B9%89%E5%88%86%E4%BA%AB"><span class="nav-text">2. 微信自定义分享</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BE%AE%E4%BF%A1%E9%85%8D%E7%BD%AE"><span class="nav-text">2.1. 微信配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#node%E7%AB%AF"><span class="nav-text">2.2. node端</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E7%AB%AF"><span class="nav-text">2.3. 前端</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BA%90%E7%A0%81"><span class="nav-text">2.4. 源码</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#amp-%E8%BD%AC-amp-amp"><span class="nav-text">3. &amp;转&amp;</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%BD%AC-3B"><span class="nav-text">4. ;转%3B</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BB%8Eurl%E4%B8%AD%E6%88%AA%E5%8F%96%E4%B8%AD%E6%96%87%E5%8F%82%E6%95%B0"><span class="nav-text">5. 从url中截取中文参数</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B9%A6%E7%AD%BE"><span class="nav-text">6. 书签</span></a></li></ol></div></div><div class="sidecar-ads" style="margin-top:10px"><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="好好学习的郝" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">好好学习的郝</p><div class="site-description" itemprop="description">一个计算机技术爱好者与学习者</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">779</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">34</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">271</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:voidking@qq.com" title="E-Mail → mailto:voidking@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://github.com/voidking" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="http://weibo.com/voidking" title="Weibo → http:&#x2F;&#x2F;weibo.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i> Weibo</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/voidking" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-quora"></i> Zhihu</a></span></div></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2014 – <span itemprop="copyrightYear">2026</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">好好学习的郝</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="footer-beian"> <a href="http://beian.miit.gov.cn/" target="_blank">苏ICP备14021030号</a>&nbsp;|&nbsp; <img src="/images/beian.png" alt=""> <a target="_blank" href="http://www.beian.gov.cn/">苏公网安备 32032202000223号</a></div></div></footer></div><script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><link rel="stylesheet" href="https://cdn.staticfile.net/gitalk/1.7.2/gitalk.min.css"><script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('https://cdn.staticfile.net/gitalk/1.7.2/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: '5a238b8c32b1e4dd2156',
      clientSecret: 'bfb5d518626f6fdc7da0351d1e0cd37ab75c6361',
      repo: 'gitalk-comments',
      owner: 'voidking',
      admin: ['voidking'],
      id: '5b04a4435025dd130aaba08edb720732',
      title: '好好学Node.js：使用Node.js处理微信自定义分享时的URL',
      body: '欢迎留言，互相交流学习~',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script></body></html>