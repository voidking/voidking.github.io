<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:new URL("https://www.voidking.com").hostname,root:"/",scheme:"Gemini",version:"7.7.1",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1,cdn:{enable:!0,url:"//cdn.voidking.com/search.xml"}},path:"search.xml",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="RadonDB ClickHouse简介 [RadonDB ClickHouse](RadonDB ClickHouse) 是基于 ClickHouse 的开源、高可用、云原生集群解决方案。RadonDB ClickHouse Kubernetes 致力于在 Kubernetes 上轻便快速创建 ClickHouse 集群。  参考文档：   什么是 RadonDB ClickHouse"><meta property="og:type" content="article"><meta property="og:title" content="K8S中安装配置ClickHouse"><meta property="og:url" content="https://www.voidking.com/dev-k8s-clickhouse/index.html"><meta property="og:site_name" content="好好学习的郝"><meta property="og:description" content="RadonDB ClickHouse简介 [RadonDB ClickHouse](RadonDB ClickHouse) 是基于 ClickHouse 的开源、高可用、云原生集群解决方案。RadonDB ClickHouse Kubernetes 致力于在 Kubernetes 上轻便快速创建 ClickHouse 集群。  参考文档：   什么是 RadonDB ClickHouse"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2022-09-06T20:00:00.000Z"><meta property="article:modified_time" content="2023-01-17T11:00:00.000Z"><meta property="article:author" content="好好学习的郝"><meta property="article:tag" content="k8s"><meta property="article:tag" content="数据库"><meta property="article:tag" content="clickhouse"><meta property="article:tag" content="cloudnative"><meta property="article:tag" content="helm"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://www.voidking.com/dev-k8s-clickhouse/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0}</script><title>K8S中安装配置ClickHouse | 好好学习的郝</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?b759ac2a7fa45129e3ef060bf68259f0";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="好好学习的郝" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">好好学习的郝</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">好好学习，天天向上！</h1></div><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/voidking" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.voidking.com/dev-k8s-clickhouse/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="好好学习的郝"><meta itemprop="description" content="学而不思则罔，思而不学则殆！"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="好好学习的郝"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> K8S中安装配置ClickHouse</h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-09-06 20:00:00" itemprop="dateCreated datePublished" datetime="2022-09-06T20:00:00+00:00">2022-09-06</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2023-01-17 11:00:00" itemprop="dateModified" datetime="2023-01-17T11:00:00+00:00">2023-01-17</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/" itemprop="url" rel="index"><span itemprop="name">engineering</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/k8s/" itemprop="url" rel="index"><span itemprop="name">k8s</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/database/" itemprop="url" rel="index"><span itemprop="name">database</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/cloudnative/" itemprop="url" rel="index"><span itemprop="name">cloudnative</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="RadonDB-ClickHouse简介"><span class="post-title-index">1.</span><a href="#RadonDB-ClickHouse简介" class="headerlink" title="RadonDB ClickHouse简介"></a> RadonDB ClickHouse简介</h1><blockquote><p>[RadonDB ClickHouse](RadonDB ClickHouse) 是基于 ClickHouse 的开源、高可用、云原生集群解决方案。<a target="_blank" rel="noopener" href="https://github.com/radondb/radondb-clickhouse-kubernetes">RadonDB ClickHouse Kubernetes</a> 致力于在 Kubernetes 上轻便快速创建 ClickHouse 集群。</p></blockquote><p>参考文档：</p><ul><li><a target="_blank" rel="noopener" href="https://github.com/radondb/radondb-clickhouse-kubernetes/blob/main/README_zh.md">什么是 RadonDB ClickHouse</a></li></ul><span id="more"></span><h1 id="Helm方式安装ClickHouse"><span class="post-title-index">2.</span><a href="#Helm方式安装ClickHouse" class="headerlink" title="Helm方式安装ClickHouse"></a> Helm方式安装ClickHouse</h1><p>安装方式选择helm，参考文档<a target="_blank" rel="noopener" href="https://github.com/radondb/radondb-clickhouse-kubernetes/blob/main/document/deploy_radondb-clickhouse_on_kubernetes.md">Deploy Radondb ClickHouse On kubernetes</a>。</p><p>不要参考<a target="_blank" rel="noopener" href="https://github.com/radondb/radondb-clickhouse-kubernetes/blob/main/document/zh/deploy_radondb-clickhouse_with_operator_on_kubernetes.md">Deploy Radondb ClickHouse On kubernetes中文版</a>，按照这个配置是有问题的。</p><p>Step 1 : Add Helm Repository</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">helm repo add ck https://radondb.github.io/radondb-clickhouse-kubernetes/</span><br></pre></td></tr></table></figure><p>Step 2 : Install to Kubernetes</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kubectl create ns clickhouse</span><br><span class="line">helm search repo ck/clickhouse-cluster -l</span><br><span class="line">helm install clickhouse ck/clickhouse-cluster -n clickhouse --version v1.0</span><br></pre></td></tr></table></figure><p>上面的安装命令会使用默认的<a target="_blank" rel="noopener" href="https://github.com/radondb/radondb-clickhouse-kubernetes/blob/main/clickhouse-cluster-helm/values.yaml">values</a>，这里可以指定一些<a target="_blank" rel="noopener" href="https://github.com/radondb/radondb-clickhouse-kubernetes/blob/main/document/deploy_radondb-clickhouse_on_kubernetes.md#custom-configuration">自定义配置</a>。</p><p>需要注意的是，clickhouse和zk依赖pv，如果没有指定，那么会使用集群中默认的storageclass创建pv。</p><p>Step 3 : Verification</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl get all -n clickhouse</span><br><span class="line">kubectl get all --selector app.kubernetes.io/instance=clickhouse -n clickhouse</span><br></pre></td></tr></table></figure><h1 id="访问ClickHouse"><span class="post-title-index">3.</span><a href="#访问ClickHouse" class="headerlink" title="访问ClickHouse"></a> 访问ClickHouse</h1><h2 id="使用pod执行命令"><span class="post-title-index">3.1.</span><a href="#使用pod执行命令" class="headerlink" title="使用pod执行命令"></a> 使用pod执行命令</h2><p>测试执行一条query命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl <span class="built_in">exec</span> -it clickhouse-s0-r0-0 -n clickhouse -- clickhouse-client -u default --password=C1ickh0use --query=<span class="string">&#x27;select hostName()&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="通过service访问clickhouse执行命令"><span class="post-title-index">3.2.</span><a href="#通过service访问clickhouse执行命令" class="headerlink" title="通过service访问clickhouse执行命令"></a> 通过service访问clickhouse执行命令</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl get service -n clickhouse | grep clickhouse</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;select hostname()&#x27;</span> | curl <span class="string">&#x27;http://default:C1ickh0use@10.96.71.193:8123/&#x27;</span> --data-binary @-</span><br></pre></td></tr></table></figure><h2 id="查看配置"><span class="post-title-index">3.3.</span><a href="#查看配置" class="headerlink" title="查看配置"></a> 查看配置</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get cm clickhouse-configuration -n clickhouse -oyaml</span><br></pre></td></tr></table></figure><h1 id="开放service给集群外机器"><span class="post-title-index">4.</span><a href="#开放service给集群外机器" class="headerlink" title="开放service给集群外机器"></a> 开放service给集群外机器</h1><p>1、导出service yaml</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get service -n clickhouse -oyaml &gt; ck.yaml</span><br></pre></td></tr></table></figure><p>2、修改spec部分为</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">native</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">9000</span></span><br><span class="line">    <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">    <span class="attr">targetPort:</span> <span class="number">9000</span></span><br><span class="line">    <span class="attr">nodePort:</span> <span class="number">31000</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">http</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">8123</span></span><br><span class="line">    <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">    <span class="attr">targetPort:</span> <span class="number">8123</span></span><br><span class="line">    <span class="attr">nodePort:</span> <span class="number">30123</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app.kubernetes.io/instance:</span> <span class="string">clickhouse</span></span><br><span class="line">    <span class="attr">app.kubernetes.io/name:</span> <span class="string">clickhouse-cluster</span></span><br><span class="line">    <span class="attr">clickhouse/component:</span> <span class="string">clickhouse</span></span><br><span class="line">  <span class="attr">sessionAffinity:</span> <span class="string">None</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">NodePort</span></span><br></pre></td></tr></table></figure><p>其中9000是原生协议端口，8123是HTTP端口，8443是HTTPS端口。详情参考<a target="_blank" rel="noopener" href="https://clickhouse.com/docs/en/guides/sre/network-ports/">ClickHouse - Network ports</a></p><p>3、修改service</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f ck.yaml</span><br></pre></td></tr></table></figure><p>4、测试</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;select hostname()&#x27;</span> | curl <span class="string">&#x27;http://default:C1ickh0use@192.168.56.112:30123/&#x27;</span> --data-binary @-</span><br></pre></td></tr></table></figure><p>其中<code>192.168.56.112</code>是一个集群节点IP。</p><h1 id="使用ClickHouse"><span class="post-title-index">5.</span><a href="#使用ClickHouse" class="headerlink" title="使用ClickHouse"></a> 使用ClickHouse</h1><p>参考文档<a href="https://www.voidking.com/dev-clickhouse-start/">《Clickhouse入门篇》</a></p><h1 id="其他"><span class="post-title-index">6.</span><a href="#其他" class="headerlink" title="其他"></a> 其他</h1><h2 id="清理clickhouse-operator"><span class="post-title-index">6.1.</span><a href="#清理clickhouse-operator" class="headerlink" title="清理clickhouse-operator"></a> 清理clickhouse-operator</h2><p>除了使用helm安装ch之外，还可以使用kubesphere安装ch，但是安装失败了。<br>参考<a target="_blank" rel="noopener" href="https://kubesphere.io/zh/docs/v3.3/application-store/external-apps/deploy-clickhouse/">在 KubeSphere 中部署 ClickHouse 集群</a>，部署时卡在了教程中的步骤3，报错：<br>Error: unable to build kubernetes objects from release manifest: unable to recognize “”: no matches for kind “clickhouseinstallation” in version “clickhouse.radondb.com/v1”</p><p>缺少CRD clickhouseinstallation，理论上直接安装一下这个CRD就可以。但是最开始没有意识到这个问题，也没有检索到解决办法，因此选择了使用helm的方式进行重装，那就需要清理教程中步骤1安装的clickhouse-operator。</p><p>预期结果中的资源需要全部删除，大都在kube-system空间。</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">customresourcedefinition.apiextensions.k8s.io/clickhouseinstallations.clickhouse.radondb.com created</span><br><span class="line">customresourcedefinition.apiextensions.k8s.io/clickhouseinstallationtemplates.clickhouse.radondb.com created</span><br><span class="line">customresourcedefinition.apiextensions.k8s.io/clickhouseoperatorconfigurations.clickhouse.radondb.com created</span><br><span class="line">serviceaccount/clickhouse-operator created</span><br><span class="line">clusterrole.rbac.authorization.k8s.io/clickhouse-operator-kube-system created</span><br><span class="line">clusterrolebinding.rbac.authorization.k8s.io/clickhouse-operator-kube-system created</span><br><span class="line">configmap/etc-clickhouse-operator-files created</span><br><span class="line">configmap/etc-clickhouse-operator-confd-files created</span><br><span class="line">configmap/etc-clickhouse-operator-configd-files created</span><br><span class="line">configmap/etc-clickhouse-operator-templatesd-files created</span><br><span class="line">configmap/etc-clickhouse-operator-usersd-files created</span><br><span class="line">deployment.apps/clickhouse-operator created</span><br><span class="line">service/clickhouse-operator-metrics created</span><br></pre></td></tr></table></figure></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 好好学习的郝</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://www.voidking.com/dev-k8s-clickhouse/" title="K8S中安装配置ClickHouse">https://www.voidking.com/dev-k8s-clickhouse/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！源站会及时更新知识点及修正错误，阅读体验也更好。欢迎分享，欢迎收藏~</li></ul></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/k8s/" rel="tag"># k8s</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag"># 数据库</a> <a href="/tags/clickhouse/" rel="tag"># clickhouse</a> <a href="/tags/cloudnative/" rel="tag"># cloudnative</a> <a href="/tags/helm/" rel="tag"># helm</a></div><div class="post-nav"><div class="post-nav-item"><a href="/dev-ks-clickhouse-problem/" rel="prev" title="ks部署clickhouse验证仓库问题"><i class="fa fa-chevron-left"></i> ks部署clickhouse验证仓库问题</a></div><div class="post-nav-item"> <a href="/dev-clickhouse-start/" rel="next" title="ClickHouse入门篇">ClickHouse入门篇<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><div class="footer-ads" style="margin-top:10px"><ins class="adsbygoogle" style="display:block" data-ad-format="autorelaxed" data-ad-client="ca-pub-3284447971731414" data-ad-slot="9697986181"></ins><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3284447971731414" crossorigin="anonymous"></script><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div class="comments" id="gitalk-container"></div><script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#RadonDB-ClickHouse%E7%AE%80%E4%BB%8B"><span class="nav-text">1. RadonDB ClickHouse简介</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Helm%E6%96%B9%E5%BC%8F%E5%AE%89%E8%A3%85ClickHouse"><span class="nav-text">2. Helm方式安装ClickHouse</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%AE%BF%E9%97%AEClickHouse"><span class="nav-text">3. 访问ClickHouse</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8pod%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4"><span class="nav-text">3.1. 使用pod执行命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%9A%E8%BF%87service%E8%AE%BF%E9%97%AEclickhouse%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4"><span class="nav-text">3.2. 通过service访问clickhouse执行命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E9%85%8D%E7%BD%AE"><span class="nav-text">3.3. 查看配置</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%BC%80%E6%94%BEservice%E7%BB%99%E9%9B%86%E7%BE%A4%E5%A4%96%E6%9C%BA%E5%99%A8"><span class="nav-text">4. 开放service给集群外机器</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8ClickHouse"><span class="nav-text">5. 使用ClickHouse</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%B6%E4%BB%96"><span class="nav-text">6. 其他</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B8%85%E7%90%86clickhouse-operator"><span class="nav-text">6.1. 清理clickhouse-operator</span></a></li></ol></li></ol></div></div><div class="sidecar-ads" style="margin-top:10px"><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="好好学习的郝" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">好好学习的郝</p><div class="site-description" itemprop="description">学而不思则罔，思而不学则殆！</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">649</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">29</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">242</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:voidking@qq.com" title="E-Mail → mailto:voidking@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://github.com/voidking" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="http://weibo.com/voidking" title="Weibo → http:&#x2F;&#x2F;weibo.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i> Weibo</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/voidking" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-quora"></i> Zhihu</a></span></div></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2014 – <span itemprop="copyrightYear">2023</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">好好学习的郝</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="footer-beian"> <a href="http://beian.miit.gov.cn/" target="_blank">苏ICP备14021030号</a>&nbsp;|&nbsp; <img src="/images/beian.png" alt=""> <a target="_blank" href="http://www.beian.gov.cn/">苏公网安备 32032202000223号</a></div></div></footer></div><script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.css"><script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: '5a238b8c32b1e4dd2156',
      clientSecret: 'bfb5d518626f6fdc7da0351d1e0cd37ab75c6361',
      repo: 'gitalk-comments',
      owner: 'voidking',
      admin: ['voidking'],
      id: 'ff3215322cdaf2497f24b5796c080e9f',
      title: 'K8S中安装配置ClickHouse',
      body: '欢迎留言，互相交流学习~',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script></body></html>