<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 4.2.1"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:new URL("https://www.voidking.com").hostname,root:"/",scheme:"Gemini",version:"7.7.1",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},path:"search.xml",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="jq命令简介jq 是一款命令行下处理 JSON 数据的工具。其可以接受标准输入，命令管道或者文件中的 JSON 数据，经过一系列的过滤器(filters)和表达式的转后形成我们需要的数据结构并将结果输出到标准输出中。jq 的这种特性使我们可以很容易地在 Shell 脚本中调用它。 更多内容，参考 命令行 JSON 处理工具 jq 的使用介绍。"><meta property="og:type" content="article"><meta property="og:title" content="jq命令的安装使用"><meta property="og:url" content="https://www.voidking.com/dev-jq-command/index.html"><meta property="og:site_name" content="好好学习的郝"><meta property="og:description" content="jq命令简介jq 是一款命令行下处理 JSON 数据的工具。其可以接受标准输入，命令管道或者文件中的 JSON 数据，经过一系列的过滤器(filters)和表达式的转后形成我们需要的数据结构并将结果输出到标准输出中。jq 的这种特性使我们可以很容易地在 Shell 脚本中调用它。 更多内容，参考 命令行 JSON 处理工具 jq 的使用介绍。"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2020-07-21T20:00:00.000Z"><meta property="article:modified_time" content="2020-09-17T01:52:50.677Z"><meta property="article:author" content="好好学习的郝"><meta property="article:tag" content="linux"><meta property="article:tag" content="shell"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://www.voidking.com/dev-jq-command/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0}</script><title>jq命令的安装使用 | 好好学习的郝</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?b759ac2a7fa45129e3ef060bf68259f0";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="好好学习的郝" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">好好学习的郝</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">好好学习，天天向上！</h1></div><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/voidking" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.voidking.com/dev-jq-command/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="好好学习的郝"><meta itemprop="description" content="学而不思则罔，思而不学则殆！"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="好好学习的郝"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> jq命令的安装使用</h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2020-07-21 20:00:00" itemprop="dateCreated datePublished" datetime="2020-07-21T20:00:00+00:00">2020-07-21</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E4%B8%93%E4%B8%9A/" itemprop="url" rel="index"><span itemprop="name">专业</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E4%B8%93%E4%B8%9A/%E8%BF%90%E7%BB%B4/" itemprop="url" rel="index"><span itemprop="name">运维</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E4%B8%93%E4%B8%9A/%E8%BF%90%E7%BB%B4/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="jq命令简介"><a href="#jq命令简介" class="headerlink" title="jq命令简介"></a>jq命令简介</h1><p>jq 是一款命令行下处理 JSON 数据的工具。其可以接受标准输入，命令管道或者文件中的 JSON 数据，经过一系列的过滤器(filters)和表达式的转后形成我们需要的数据结构并将结果输出到标准输出中。jq 的这种特性使我们可以很容易地在 Shell 脚本中调用它。</p><p>更多内容，参考 <a href="https://www.ibm.com/developerworks/cn/linux/1612_chengg_jq/index.html" target="_blank" rel="noopener">命令行 JSON 处理工具 jq 的使用介绍</a>。</p><a id="more"></a><h1 id="安装jq"><a href="#安装jq" class="headerlink" title="安装jq"></a>安装jq</h1><p>1、macos</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">brew </span><span class="keyword">install </span><span class="keyword">jq</span></span><br></pre></td></tr></table></figure><p>2、linux</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https:<span class="regexp">//gi</span>thub.com<span class="regexp">/stedolan/</span>jq<span class="regexp">/releases/</span>download<span class="regexp">/jq-1.6/</span>jq-linux64</span><br><span class="line">chmod a+x jq-linux64 &amp;&amp; mv jq-linux64 <span class="regexp">/usr/</span>bin<span class="regexp">/jq</span></span><br></pre></td></tr></table></figure><p>3、centos</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum <span class="keyword">install</span> epel-<span class="keyword">release</span></span><br><span class="line">yum <span class="keyword">install</span> jq</span><br></pre></td></tr></table></figure><p>4、ubuntu</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apt</span> <span class="string">update</span></span><br><span class="line"><span class="attr">apt</span> <span class="string">install -y jq</span></span><br></pre></td></tr></table></figure><h1 id="jq表达式"><a href="#jq表达式" class="headerlink" title="jq表达式"></a>jq表达式</h1><h2 id="举个栗子"><a href="#举个栗子" class="headerlink" title="举个栗子"></a>举个栗子</h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> '&#123;<span class="string">"name"</span>:<span class="string">"voidking"</span>&#125;' | jq .</span><br><span class="line"><span class="keyword">echo</span> '&#123;<span class="string">"name"</span>:<span class="string">"voidking"</span>&#125;' | jq <span class="string">.name</span></span><br><span class="line"><span class="keyword">echo</span> '&#123;<span class="string">"name"</span>:<span class="string">"voidking"</span>&#125;' | jq -r <span class="string">.name</span></span><br></pre></td></tr></table></figure><p>用户在使用jq时，需要使用jq支持的语法来构建表达式(filters)并将其传给jq。jq根据语法规则解析表达式，并应用在输入的JSON数据上从而得到需要的结果。</p><p>上面例子中的 <code>.</code> 和 <code>.name</code> 就是表达式。<br><code>.</code> 符号表示对表达式输入的整个JSON对象的引用，<code>.name</code>和<code>.name?</code>表示获取JSON对象的属性。当输入不是JSON对象或数组时，带着问号的方式不会抛出异常。</p><p>选项的含义查看jq帮助即可，比如-r表示输出raw格式内容。</p><h2 id="串行操作"><a href="#串行操作" class="headerlink" title="串行操作"></a>串行操作</h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> '&#123;<span class="string">"name"</span>:&#123;<span class="string">"firstname"</span>:<span class="string">"Void"</span>,<span class="string">"lastname"</span>:<span class="string">"King"</span>&#125;&#125;' | jq <span class="string">.name.firstname</span></span><br><span class="line"><span class="keyword">echo</span> '&#123;<span class="string">"name"</span>:&#123;<span class="string">"firstname"</span>:<span class="string">"Void"</span>,<span class="string">"lastname"</span>:<span class="string">"King"</span>&#125;&#125;' | jq '<span class="string">.name</span> | <span class="string">.firstname</span>'</span><br><span class="line"><span class="keyword">echo</span> '&#123;<span class="string">"name"</span>:&#123;<span class="string">"firstname"</span>:<span class="string">"Void"</span>,<span class="string">"lastname"</span>:<span class="string">"King"</span>&#125;&#125;' | jq '<span class="string">.name</span> | <span class="string">.firstname</span>,<span class="string">.lastname</span>'</span><br></pre></td></tr></table></figure><p>jq表达式支持串行化操作。一个复杂的表达式可以由多个简单的表达式组成，以管道符号 <code>|</code> 分割，串行化执行。管道前面表达式的输出，是管道后面表达式的输入。</p><p>逗号 <code>,</code> 表示对同一个输入应用多个表达式。</p><h2 id="数组操作"><a href="#数组操作" class="headerlink" title="数组操作"></a>数组操作</h2><figure class="highlight scilab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">echo <span class="string">'[&#123;"</span>name<span class="string">":"</span>voidking<span class="string">"&#125;,&#123;"</span>name<span class="string">":"</span>haojin<span class="string">"&#125;]'</span> | jq .</span><br><span class="line">echo <span class="string">'[&#123;"</span>name<span class="string">":"</span>voidking<span class="string">"&#125;,&#123;"</span>name<span class="string">":"</span>haojin<span class="string">"&#125;]'</span> | jq <span class="string">'.[]'</span></span><br><span class="line">echo <span class="string">'[&#123;"</span>name<span class="string">":"</span>voidking<span class="string">"&#125;,&#123;"</span>name<span class="string">":"</span>haojin<span class="string">"&#125;]'</span> | jq <span class="string">'.[0:2]'</span></span><br><span class="line">echo <span class="string">'[&#123;"</span>name<span class="string">":"</span>voidking<span class="string">"&#125;,&#123;"</span>name<span class="string">":"</span>haojin<span class="string">"&#125;]'</span> | jq <span class="string">'.[0,1]'</span></span><br><span class="line">echo <span class="string">'[&#123;"</span>name<span class="string">":"</span>voidking<span class="string">"&#125;,&#123;"</span>name<span class="string">":"</span>haojin<span class="string">"&#125;]'</span> | jq <span class="string">'.[].name'</span></span><br><span class="line">echo <span class="string">'[&#123;"</span>name<span class="string">":"</span>voidking<span class="string">"&#125;,&#123;"</span>name<span class="string">":"</span>haojin<span class="string">"&#125;]'</span> | jq <span class="string">'.[] | .name'</span></span><br><span class="line">echo <span class="string">'[&#123;"</span>name<span class="string">":"</span>voidking<span class="string">"&#125;,&#123;"</span>name<span class="string">":"</span>haojin<span class="string">"&#125;]'</span> | jq <span class="string">'.[] | .["</span>name<span class="string">"]'</span></span><br></pre></td></tr></table></figure><p>jq 提供三种基础表达式来操作数组：<br>迭代器操作<code>.[]</code>，该表达式的输入可以是数组或者JSON对象，输出的是基于数组元素或者JSON对象属性值的迭代器（iterator）。<br>访问特定元素的操作<code>.[index]</code>或<code>.[&quot;attributename&quot;]</code>。用来访问数组元素或者JSON对象的属性值，输出是单个值。<br>数组切片操作<code>.[startindex:endindex]&#39;</code>，其行为类似于 python 语言中数组切片操作。</p><p>一个表达式产生的结果是迭代器时，迭代器的每一个值会分别作为的输入，传给后面的表达式。</p><h1 id="jq运算"><a href="#jq运算" class="headerlink" title="jq运算"></a>jq运算</h1><figure class="highlight scilab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">echo <span class="string">'&#123;"</span>num<span class="string">":3,"</span>str<span class="string">":"</span><span class="number">343</span><span class="string">"&#125;'</span> | jq <span class="string">'.num*3'</span></span><br><span class="line">echo <span class="string">'&#123;"</span>num<span class="string">":3,"</span>str<span class="string">":"</span><span class="number">343</span><span class="string">"&#125;'</span> | jq <span class="string">'.num/3'</span></span><br><span class="line"></span><br><span class="line">echo <span class="string">'&#123;"</span>num<span class="string">":3,"</span>str<span class="string">":"</span><span class="number">343</span><span class="string">"&#125;'</span> | jq <span class="string">'.str+"</span><span class="number">3</span><span class="string">"'</span></span><br><span class="line">echo <span class="string">'&#123;"</span>num<span class="string">":3,"</span>str<span class="string">":"</span><span class="number">343</span><span class="string">"&#125;'</span> | jq <span class="string">'.str*3'</span></span><br><span class="line">echo <span class="string">'&#123;"</span>num<span class="string">":3,"</span>str<span class="string">":"</span><span class="number">343</span><span class="string">"&#125;'</span> | jq <span class="string">'.str/"</span><span class="number">4</span><span class="string">"'</span></span><br><span class="line"></span><br><span class="line">echo <span class="string">'[&#123;"</span>name<span class="string">":"</span>voidking<span class="string">"&#125;,&#123;"</span>name<span class="string">":"</span>haojin<span class="string">"&#125;]'</span> | jq <span class="string">'.+[&#123;"</span>name<span class="string">":"</span>voidking<span class="string">"&#125;]'</span></span><br><span class="line">echo <span class="string">'[&#123;"</span>name<span class="string">":"</span>voidking<span class="string">"&#125;,&#123;"</span>name<span class="string">":"</span>haojin<span class="string">"&#125;]'</span> | jq <span class="string">'.-[&#123;"</span>name<span class="string">":"</span>voidking<span class="string">"&#125;]'</span></span><br><span class="line"></span><br><span class="line">echo <span class="string">'&#123;"</span>name<span class="string">":&#123;"</span>firstname<span class="string">":"</span>Void<span class="string">","</span>lastname<span class="string">":"</span>King<span class="string">"&#125;&#125;'</span> | jq <span class="string">'.+&#123;"</span>name<span class="string">":&#123;"</span>nickname<span class="string">":"</span>Hankin<span class="string">"&#125;&#125;'</span></span><br><span class="line">echo <span class="string">'&#123;"</span>name<span class="string">":&#123;"</span>firstname<span class="string">":"</span>Void<span class="string">","</span>lastname<span class="string">":"</span>King<span class="string">"&#125;&#125;'</span> | jq <span class="string">'.*&#123;"</span>name<span class="string">":&#123;"</span>nickname<span class="string">":"</span>Hankin<span class="string">"&#125;&#125;'</span></span><br><span class="line"></span><br><span class="line">echo <span class="string">'&#123;"</span>name<span class="string">":&#123;"</span>firstname<span class="string">":"</span>Void<span class="string">","</span>lastname<span class="string">":"</span>King<span class="string">"&#125;&#125;'</span> | jq <span class="string">'.name.nickname//"</span>Hankin<span class="string">"'</span></span><br><span class="line"></span><br><span class="line">jq -n <span class="string">'([1,2]|.[])+([4,6]|.[])'</span></span><br></pre></td></tr></table></figure><p>jq 内部支持的数据类型有：数字，字符串，数组和对象(object)。</p><p>数字运算：jq支持加减乘除(/)和求余(%)运算。<br>字符串运算：jq 提供字符串的连接、复制、分割运算。<br>数组运算：并集、差集运算。<br>对象运算：合并。<br>比较运算：jq 内部支持的比较运算，规则与js基本相同。<br>逻辑运算: and/or/not。在 jq 逻辑运算中，除了 false 和 null 外，其余的任何值都等同于 true。<br>默认值运算符：双斜杠。<br>迭代器运算：每一个元素拿出来分别运算。</p><h1 id="jq函数"><a href="#jq函数" class="headerlink" title="jq函数"></a>jq函数</h1><p>jq 支持函数。在使用 jq 函数时，我们应该注意区分两个概念：输入和参数。输入可能是整个表达式的输入数据也可能是表达式别的部分的输出。而参数和函数一起构成新的filter来处理输入。<br>和其他编程语言不同的是，在调用函数时，多个参数之间以分号分隔。jq通过内置函数提供了数据处理时常用的操作，例如：映射，过滤、路径操作等。</p><h2 id="映射"><a href="#映射" class="headerlink" title="映射"></a>映射</h2><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo '[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]'| jq -r 'map(.+<span class="number">1</span>)'</span><br></pre></td></tr></table></figure><p>在数据处理过程中，我们经常需要将数据从一种形式转换成另外一种形式，或者改变数据的值。<br>jq提供了两个内置映射函数来实现这种转换：map 和 map_values。其中，map处理的对象是数组，而map_values则处理对象属性的值。map 函数的参数为 filter 表达式。</p><h2 id="过滤"><a href="#过滤" class="headerlink" title="过滤"></a>过滤</h2><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo '[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]'| jq -r 'map(select(.&gt;<span class="number">2</span>))'</span><br><span class="line">echo '[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]'| jq -r '.[]|select(.&gt;<span class="number">2</span>)'</span><br></pre></td></tr></table></figure><p>jq中有两种类型的选择过滤操作。<br>第一种是基于数据类型的过滤，如表达式<code>.[]|arrays</code>的结果只包含数组。可以用来过滤的类型过滤器有：arrays, objects, iterables, booleans, numbers, normals, finites, strings, nulls, values, scalars。<br>第二种是select函数。select接受一个条件表达式作为参数。其输入可以是迭代器，或者和map函数配合使用来处理数组。当输入中的某个元素使select参数中的条件表达式结果为真时，则在结果中保留该元素，否则不保留该元素。</p><h2 id="路径"><a href="#路径" class="headerlink" title="路径"></a>路径</h2><p>jq中的path是指从根到某个叶子属性的访问路径。<br>在jq中有两种表示路径的方式：数组表示法和属性表示法。<br>属性表示法类似于我们在filter中访问某个属性值的方式，如<code>.a.b</code>。<br>数组表示法是将路径中的每一部分表示为数组的一个元素。<br>jq提供了一个内置函数path用来实现路径从属性表示法到数组表示法的转换。</p><p>jq还提供了函数用来读取路径的值（getpath）, 设置路径的值（setpath）和删除路径（del）。<br>不过这三个函数对路径的处理并不一致。其中getpath和setpath只接受数组表示法的路径，而del函数只能正确处理属性表示法的路径。</p><p>jq还提供了一个函数paths用来枚举可能存在的路径。在没有参数的情况下，paths函数将输出JSON数据中所有可能的路径。paths函数可以接受一个过滤器，来只输出满足条件的路径。</p><p>jq中提供了一系列的函数用来判断某个元素或者属性是否存在于输入数据中。其中函数has和in用来判断JSON对象或数组是否包含特定的属性或索引。函数contains和inside用来判断参数是否完全包含在输入数据中。对于不同的数据类型，判断是否完全包含的规则不同。对于字符串，如果A是B的子字符串，则认为A完全包含于B。对于对象类型，如果对象A的所有属性在对象B中都能找到且值相同，则认为A完全包含于B。</p><h2 id="数组函数"><a href="#数组函数" class="headerlink" title="数组函数"></a>数组函数</h2><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">jq -nr '[<span class="number">1</span>,[<span class="number">2</span>,<span class="number">3</span>],<span class="number">4</span>]|<span class="type">flatten</span>'</span><br><span class="line">jq -nr '[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]|<span class="type">reverse</span>'</span><br><span class="line">jq -nr '[<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>]|<span class="type">sort</span>'</span><br><span class="line">jq -nr '[&#123;<span class="string">"a"</span>:<span class="number">1</span>&#125;,&#123;<span class="string">"a"</span>:<span class="number">2</span>&#125;]|<span class="type">sort_by</span>(.a)'</span><br><span class="line">jq -nr '<span class="string">"abcb"</span>|<span class="type">indices</span>(<span class="string">"b"</span>)'</span><br><span class="line">jq -nr '[<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">3</span>]|<span class="type">indices</span>(<span class="number">3</span>)'</span><br></pre></td></tr></table></figure><p>jq 提供内置函数用于完成数组的扁平化（flatten），反序（reverse），排序（sort、sort_by），比较（min、min_by、max、max_by）和查找（indices、index、rindex）。其中indices函数的输入数据可以是数组，也可以是字符串。和 index函数不同的是，其结果是一个包含所有参数在输入数据中位置的数组。</p><h1 id="jq高级特性"><a href="#jq高级特性" class="headerlink" title="jq高级特性"></a>jq高级特性</h1><p>变量、Reduce、自定义函数和模块等。未完待续。。。</p></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/linux/" rel="tag"># linux</a> <a href="/tags/shell/" rel="tag"># shell</a></div><div class="post-nav"><div class="post-nav-item"><a href="/dev-docker-swarm/" rel="prev" title="Docker Swarm"><i class="fa fa-chevron-left"></i> Docker Swarm</a></div><div class="post-nav-item"> <a href="/dev-k8s-network-policy/" rel="next" title="K8S中的网络策略">K8S中的网络策略<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><div class="comments"><div id="lv-container" data-id="city" data-uid="MTAyMC8zODU3Mi8xNTEwMA=="></div></div><script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#jq命令简介"><span class="nav-number">1.</span> <span class="nav-text">jq命令简介</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#安装jq"><span class="nav-number">2.</span> <span class="nav-text">安装jq</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#jq表达式"><span class="nav-number">3.</span> <span class="nav-text">jq表达式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#举个栗子"><span class="nav-number">3.1.</span> <span class="nav-text">举个栗子</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#串行操作"><span class="nav-number">3.2.</span> <span class="nav-text">串行操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数组操作"><span class="nav-number">3.3.</span> <span class="nav-text">数组操作</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#jq运算"><span class="nav-number">4.</span> <span class="nav-text">jq运算</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#jq函数"><span class="nav-number">5.</span> <span class="nav-text">jq函数</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#映射"><span class="nav-number">5.1.</span> <span class="nav-text">映射</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#过滤"><span class="nav-number">5.2.</span> <span class="nav-text">过滤</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#路径"><span class="nav-number">5.3.</span> <span class="nav-text">路径</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数组函数"><span class="nav-number">5.4.</span> <span class="nav-text">数组函数</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#jq高级特性"><span class="nav-number">6.</span> <span class="nav-text">jq高级特性</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="好好学习的郝" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">好好学习的郝</p><div class="site-description" itemprop="description">学而不思则罔，思而不学则殆！</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">613</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">49</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">194</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:voidking@qq.com" title="E-Mail → mailto:voidking@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://github.com/voidking" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="http://weibo.com/voidking" title="Weibo → http:&#x2F;&#x2F;weibo.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i> Weibo</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/voidking" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-quora"></i> Zhihu</a></span></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2014 – <span itemprop="copyrightYear">2020</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">好好学习的郝</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="footer-beian"> <a href="http://www.beian.miit.gov.cn/" target="_blank">苏ICP备14021030号</a>&nbsp;|&nbsp; <img src="/images/beian.png" alt=""> <a target="_blank" href="http://www.beian.gov.cn/">苏公网安备 32032202000223号</a></div></div></footer><div id="needsharebutton-float"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div></div><script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css"><script src="/lib/needsharebutton/needsharebutton.js"></script><script>pbOptions={iconStyle:"box",boxForm:"horizontal",position:"bottomCenter",networks:"Weibo,Wechat,Douban,QQZone,Twitter,Facebook"},new needShareButton("#needsharebutton-postbottom",pbOptions),flOptions={iconStyle:"box",boxForm:"horizontal",position:"topRight",networks:"Weibo,Wechat,Douban,QQZone,Twitter,Facebook"},new needShareButton("#needsharebutton-float",flOptions)</script><script>
NexT.utils.loadComments(document.querySelector('#lv-container'), () => {
  // window.livereOptions = {
  //   refer: location.pathname.replace(CONFIG.root, '').replace('index.html', '')
  // };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
});
</script></body></html>