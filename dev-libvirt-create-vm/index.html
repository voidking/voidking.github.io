<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:new URL("https://www.voidking.com").hostname,root:"/",scheme:"Gemini",version:"7.7.1",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1,cdn:{enable:!0,url:"//qiniu.cdn.voidking.com/doc/search.xml"}},path:"search.xml",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="前言本文中，我们学习一下qemu和libvirt，分别使用它们创建一个cirros虚拟机，并配置好网络。 宿主机node0的系统为ubuntu16，IP为192.168.56.200。"><meta property="og:type" content="article"><meta property="og:title" content="使用Libvirt创建虚拟机"><meta property="og:url" content="https://www.voidking.com/dev-libvirt-create-vm/index.html"><meta property="og:site_name" content="好好学习的郝"><meta property="og:description" content="前言本文中，我们学习一下qemu和libvirt，分别使用它们创建一个cirros虚拟机，并配置好网络。 宿主机node0的系统为ubuntu16，IP为192.168.56.200。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://cdn.voidking.com/img/libvirt-create-vm/boot.jpg?imageView2/0/w/700"><meta property="og:image" content="http://cdn.voidking.com/img/libvirt-create-vm/start.jpg?imageView2/0/w/600"><meta property="og:image" content="http://cdn.voidking.com/img/libvirt-create-vm/ip.jpg?imageView2/0/w/600"><meta property="og:image" content="http://cdn.voidking.com/img/libvirt-create-vm/ping.jpg?imageView2/0/w/600"><meta property="og:image" content="http://cdn.voidking.com/img/libvirt-create-vm/install.jpg?imageView2/0/w/700"><meta property="og:image" content="http://cdn.voidking.com/img/libvirt-create-vm/list.jpg?imageView2/0/w/600"><meta property="og:image" content="http://cdn.voidking.com/img/libvirt-create-vm/detail.jpg?imageView2/0/w/600"><meta property="og:image" content="http://cdn.voidking.com/img/libvirt-create-vm/arp.jpg?imageView2/0/w/600"><meta property="og:image" content="http://cdn.voidking.com/img/libvirt-create-vm/login.jpg?imageView2/0/w/600"><meta property="og:image" content="http://cdn.voidking.com/img/libvirt-create-vm/ping2.jpg?imageView2/0/w/600"><meta property="article:published_time" content="2018-12-21T11:30:00.000Z"><meta property="article:modified_time" content="2022-11-23T10:00:00.000Z"><meta property="article:author" content="好好学习的郝"><meta property="article:tag" content="linux"><meta property="article:tag" content="ubuntu"><meta property="article:tag" content="libvirt"><meta property="article:tag" content="virsh"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://cdn.voidking.com/img/libvirt-create-vm/boot.jpg?imageView2/0/w/700"><link rel="canonical" href="https://www.voidking.com/dev-libvirt-create-vm/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0}</script><title>使用Libvirt创建虚拟机 | 好好学习的郝</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?b759ac2a7fa45129e3ef060bf68259f0";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="好好学习的郝" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">好好学习的郝</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">一个计算机技术爱好者与学习者</h1></div><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/voidking" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.voidking.com/dev-libvirt-create-vm/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="好好学习的郝"><meta itemprop="description" content="一个计算机技术爱好者与学习者"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="好好学习的郝"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> 使用Libvirt创建虚拟机</h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2018-12-21 11:30:00" itemprop="dateCreated datePublished" datetime="2018-12-21T11:30:00+00:00">2018-12-21</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2022-11-23 10:00:00" itemprop="dateModified" datetime="2022-11-23T10:00:00+00:00">2022-11-23</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/" itemprop="url" rel="index"><span itemprop="name">engineering</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/engineering/devops/" itemprop="url" rel="index"><span itemprop="name">devops</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="前言"><span class="post-title-index">1.</span><a href="#前言" class="headerlink" title="前言"></a> 前言</h1><p>本文中，我们学习一下qemu和libvirt，分别使用它们创建一个cirros虚拟机，并配置好网络。</p><p>宿主机node0的系统为ubuntu16，IP为192.168.56.200。</p><span id="more"></span><h1 id="qemu和libvirt简介"><span class="post-title-index">2.</span><a href="#qemu和libvirt简介" class="headerlink" title="qemu和libvirt简介"></a> qemu和libvirt简介</h1><p>QEMU是一套由Fabrice Bellard编写的模拟处理器的自由软件，它是一个完整的可以单独运行的软件，可以独立模拟出整台计算机，包括CPU，内存，IO设备，通过一个特殊的“重编译器”对特定的处理器的二进制代码进行翻译，从而具有了跨平台的通用性。</p><p>总的来说，QEMU是一个独立的虚拟化解决方案，并不依赖KVM，它本身自己可以做CPU和内存的模拟，只不过效率较低。</p><p>KVM（Kernel-based Virtual Machine）是另一套虚拟化解决方案，实现对CPU的底层虚拟化和内存的虚拟化，使Linux内核成为虚拟化层，需要x86架构的、支持虚拟化功能的硬件支持（比如Intel VT，AMD-V），所以虚拟效率较高，是一种全虚拟化架构。</p><p>但是KVM本身不提供其他设备的虚拟化，借用了QEMU的代码进行了定制，所以KVM方案一定要依赖QEMU。</p><p>而Libvirt是用于管理虚拟化平台的开源的API，后台程序和管理工具。它可以用于管理KVM、Xen、VMware ESX、QEMU和其他虚拟化技术。</p><p>Libvirt主要由三个部分组成：API库，一个守护进程libvirtd和一个默认命令行管理工具 virsh。</p><p>参考文档：</p><ul><li><a target="_blank" rel="noopener" href="https://blog.csdn.net/shengxia1999/article/details/52244119">QEMU和QEMU-KVM的关系</a></li><li><a target="_blank" rel="noopener" href="https://blog.csdn.net/scucscheng/article/details/51803238">libvirt 介绍</a></li></ul><h1 id="安装qemu和libvirt"><span class="post-title-index">3.</span><a href="#安装qemu和libvirt" class="headerlink" title="安装qemu和libvirt"></a> 安装qemu和libvirt</h1><p>参考<a target="_blank" rel="noopener" href="http://www.linuxdiyf.com/linux/31719.html">Ubuntu16.04安装QEMU与libvirt</a>，安装QEMU和libvirt。</p><p>1、切换到root用户</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo -i</span><br><span class="line"><span class="comment">#or</span></span><br><span class="line">sudo su</span><br></pre></td></tr></table></figure><p>2、查看主机是否支持硬件虚拟化</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">egrep -c <span class="string">&#x27;(vmx|svm)&#x27;</span> /proc/cpuinfo</span><br></pre></td></tr></table></figure><p>因为我们的实验本身是在虚拟机中进行的，所以输出0，表示不支持硬件虚拟化。</p><p>3、安装QEMU和libvirt</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt install -y qemu libvirt-bin bridge-utils virt-manager virt-viewer</span><br><span class="line"><span class="comment"># 如果是支持硬件虚拟化，那么执行安装</span></span><br><span class="line">apt install -y kvm qemu-kvm libvirt-bin bridge-utils virt-manager virt-viewer</span><br></pre></td></tr></table></figure><ul><li>bridge-utils是网桥管理工具。</li><li><a target="_blank" rel="noopener" href="https://virt-manager.org/">virt-manager</a>是一个通用的桌面管理工具。</li><li>virt-viewer是一个用于显示虚拟机的图形控制台的最小工具。</li></ul><p>4、检查安装</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">virsh --version</span><br><span class="line">virt-manager --version</span><br><span class="line">virt-viewer --version</span><br></pre></td></tr></table></figure><p>5、查看网络</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ip a</span><br><span class="line">brctl show</span><br><span class="line">virsh net-list</span><br></pre></td></tr></table></figure><p>安装完成以后，默认是启用了桥接网络virbr0，IP为192.168.122.1/24。如果没有启用，那么参考<a target="_blank" rel="noopener" href="https://cloud.tencent.com/info/44873f0a21c091fe2dd89ef50efd3fc9.html">ubuntu16.04环境安装KVM</a>进行启用。</p><h1 id="安装vncserver"><span class="post-title-index">4.</span><a href="#安装vncserver" class="headerlink" title="安装vncserver"></a> 安装vncserver</h1><p>安装vncserver，方便远程查看虚拟机的安装过程</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install vnc4server</span><br></pre></td></tr></table></figure><h1 id="qemu创建虚拟机"><span class="post-title-index">5.</span><a href="#qemu创建虚拟机" class="headerlink" title="qemu创建虚拟机"></a> qemu创建虚拟机</h1><p>参考文档：</p><ul><li><a target="_blank" rel="noopener" href="http://www.codeleading.com/article/704772348/">嵌套虚拟化—VMware+QEMU/KVM</a></li><li><a target="_blank" rel="noopener" href="https://my.oschina.net/lwaif/blog/1591709">ubuntu下使用qemu安装虚拟机并配置桥接网络</a></li><li><a target="_blank" rel="noopener" href="https://blog.csdn.net/RichardYSteven/article/details/54645328">使用qemu安装虚拟机</a></li></ul><h2 id="下载系统镜像"><span class="post-title-index">5.1.</span><a href="#下载系统镜像" class="headerlink" title="下载系统镜像"></a> 下载系统镜像</h2><p>下载<a target="_blank" rel="noopener" href="http://download.cirros-cloud.net/">cirros系统镜像</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://download.cirros-cloud.net/0.4.0/cirros-0.4.0-x86_64-disk.img</span><br></pre></td></tr></table></figure><h2 id="创建磁盘"><span class="post-title-index">5.2.</span><a href="#创建磁盘" class="headerlink" title="创建磁盘"></a> 创建磁盘</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> /opt/qemu</span><br><span class="line"><span class="built_in">cd</span> /opt/qemu</span><br><span class="line">qemu-img create -f qcow2 cirros0.img 5g</span><br></pre></td></tr></table></figure><p>参数说明：</p><ul><li>qcow2是qemu最常使用的磁盘格式，该格式下可以采用写时复制技术来优化性能</li><li>cirros0.img是磁盘名称</li><li>5g是指磁盘文件大小</li></ul><h2 id="安装系统到磁盘"><span class="post-title-index">5.3.</span><a href="#安装系统到磁盘" class="headerlink" title="安装系统到磁盘"></a> 安装系统到磁盘</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">qemu-system-x86_64 -hda cirros0.img -boot d -cdrom ./cirros-0.4.0-x86_64-disk.img -m 512 -vnc :1</span><br><span class="line"><span class="comment"># 如果是支持硬件虚拟化，那么执行安装</span></span><br><span class="line">qemu-system-x86_64 -enable-kvm -hda cirros0.img -boot d -cdrom ./cirros-0.4.0-x86_64-disk.img -m 512 -vnc :1</span><br></pre></td></tr></table></figure><p>参数说明：</p><ul><li><code>enable-kvm</code>使用KVM进行加速；</li><li><code>hda</code>指定要使用的虚拟磁盘；</li><li><code>boot d</code>指定启动位置，d表示从光盘启动；</li><li><code>cdrom</code>指定镜像文件；</li><li><code>m</code>指定虚拟机内存大小，默认单位是MB；</li><li><code>vnc:1</code>通过vnc创建虚拟桌面。</li></ul><p>出现警告：warning: TCG doesn’t support requested feature: CPUID.01H:ECX.vmx [bit 5]<br>没啥影响，不去管它。</p><h2 id="查看安装过程"><span class="post-title-index">5.4.</span><a href="#查看安装过程" class="headerlink" title="查看安装过程"></a> 查看安装过程</h2><p>怎样查看安装过程？怎样在安装时进行配置？答：使用VNC。<br>本地打开<a target="_blank" rel="noopener" href="https://www.realvnc.com/en/connect/download/viewer/">vncviewer client</a>，输入ip:5901进行连接，即可看到安装过程。<br><img src="http://cdn.voidking.com/img/libvirt-create-vm/boot.jpg?imageView2/0/w/700"></p><p>安装卡在了安装界面：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Boot failed: could not read the boot disk</span><br><span class="line">No more network devices</span><br><span class="line">No bootable device</span><br></pre></td></tr></table></figure><p>参考<a target="_blank" rel="noopener" href="http://accelazh.github.io/virtualization/Play-With-Libvirt-KVM">Play with Libvirt/KVM</a>发现，cirros-0.4.0-x86_64-disk.img本身就是一个磁盘，尴尬。。。</p><h2 id="启动虚拟机"><span class="post-title-index">5.5.</span><a href="#启动虚拟机" class="headerlink" title="启动虚拟机"></a> 启动虚拟机</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">qemu-system-x86_64 -m 512 -smp 4 \</span><br><span class="line">-drive file=cirros-0.4.0-x86_64-disk.img \</span><br><span class="line">-vnc :1</span><br></pre></td></tr></table></figure><p>本地打开<a target="_blank" rel="noopener" href="https://www.realvnc.com/en/connect/download/viewer/">vncviewer client</a>，输入ip:5901进行连接，即可看到启动过程。因为没有<code>enable-kvm</code>，所以启动很慢，请耐心等待。<br><img src="http://cdn.voidking.com/img/libvirt-create-vm/start.jpg?imageView2/0/w/600"></p><h2 id="IP配置"><span class="post-title-index">5.6.</span><a href="#IP配置" class="headerlink" title="IP配置"></a> IP配置</h2><p>1、查看虚拟机IP<br>登录cirros（默认用户名cirros，密码gocubsgo），然后查看IP、内存和硬盘</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ip add</span><br><span class="line">free -m</span><br><span class="line"><span class="built_in">df</span> -h</span><br></pre></td></tr></table></figure><p><img src="http://cdn.voidking.com/img/libvirt-create-vm/ip.jpg?imageView2/0/w/600"><br>IP默认为10.0.2.15；内存512M，是指定的；硬盘默认256M。</p><p>当ctrl+c结束<code>qemu-system-x86_64</code>命令后，虚拟机就被关闭了。再次使用<code>qemu-system-x86_64</code>命令启动虚拟机，登录虚拟机后使用<code>history</code>命令，发现之前的命令记录都还在，说明两次使用的都是同一块磁盘，也就是cirros-0.4.0-x86_64-disk.img。</p><p>2、设置IP</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/network/interfaces</span><br></pre></td></tr></table></figure><p>eth0的配置修改为：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">auto eth0</span><br><span class="line">iface eth0 inet static</span><br><span class="line">address 192.168.122.100</span><br><span class="line">netmask 255.255.255.0</span><br></pre></td></tr></table></figure><p>3、重启网卡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ifdown eth0</span><br><span class="line">ifup eth0</span><br></pre></td></tr></table></figure><p>但是，无法ping通192.168.122.1，说明虚拟机的网卡并没有和virbr0进行连接。</p><h1 id="创建网络"><span class="post-title-index">6.</span><a href="#创建网络" class="headerlink" title="创建网络"></a> 创建网络</h1><p>虚拟机有了，但是还不能连接外部网络。我们需要创建网络，重新启动虚拟机，详情参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/RichardYSteven/article/details/54807927">访问qemu虚拟机的五种姿势</a>。</p><p>1、创建网桥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">brctl add virbr0</span><br><span class="line">ifconfig virbr0 192.168.122.1 net mask 255.255.255.0 up</span><br></pre></td></tr></table></figure><p>网桥已经存在，所以这一步不需要了。</p><p>2、创建tap接口，并添加到网桥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">apt install uml-utilities</span><br><span class="line">tunctl -t tap0</span><br><span class="line">ifconfig tap0 0.0.0.0 up</span><br><span class="line">brctl addif virbr0 tap0</span><br></pre></td></tr></table></figure><p>3、让虚拟机使用tap0作为网络设备启动</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">qemu-system-x86_64 -m 512 -smp 4 \</span><br><span class="line">-drive file=cirros-0.4.0-x86_64-disk.img \</span><br><span class="line">-netdev tap,<span class="built_in">id</span>=tapnet,ifname=tap0,script=no \</span><br><span class="line">-device rtl8139,netdev=tapnet \</span><br><span class="line">-vnc :1</span><br></pre></td></tr></table></figure><p>4、登录虚拟机，测试网络</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping 192.168.122.1</span><br></pre></td></tr></table></figure><p>此时网络已经通了。<br><img src="http://cdn.voidking.com/img/libvirt-create-vm/ping.jpg?imageView2/0/w/600"></p><h1 id="libvirt创建虚拟机"><span class="post-title-index">7.</span><a href="#libvirt创建虚拟机" class="headerlink" title="libvirt创建虚拟机"></a> libvirt创建虚拟机</h1><p>以上创建虚拟机的过程，其实并没有用到libvirt，下面使用下面使用libvirt进行虚拟机的创建。<br>参考文档<a target="_blank" rel="noopener" href="http://accelazh.github.io/virtualization/Play-With-Libvirt-KVM">Play with Libvirt/KVM</a></p><p>1、创建虚拟机</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">virt-install --connect=qemu:///system --name=cirros --ram=512 --vcpus=1 --disk path=cirros-0.4.0-x86_64-disk.img,format=qcow2 --import --network network:default --vnc</span><br></pre></td></tr></table></figure><p><img src="http://cdn.voidking.com/img/libvirt-create-vm/install.jpg?imageView2/0/w/700"></p><p>无法使用vncviwer进行连接，然后卡在上图的界面，最后ctrl+c强制结束。配置文件位于/etc/libvirt/qemu/cirros.xml，如果要编辑它，使用<code>virsh edit cirros</code>命令。</p><p>2、显示vnc port</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">virsh vncdisplay cirros</span><br></pre></td></tr></table></figure><p>3、显示虚拟机列表</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">virsh list</span><br></pre></td></tr></table></figure><p><img src="http://cdn.voidking.com/img/libvirt-create-vm/list.jpg?imageView2/0/w/600"></p><p>4、查看虚拟机详情</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">virsh dominfo cirros</span><br><span class="line">virsh domstate cirros</span><br></pre></td></tr></table></figure><p><img src="http://cdn.voidking.com/img/libvirt-create-vm/detail.jpg?imageView2/0/w/600"></p><p>问题来了，怎么访问这个虚拟机呢？最简单的方法是使用<code>virsh console cirros</code>命令打开控制台，使用<code>ctrl+]</code>关闭控制台，另外就是通过ssh或者vnc。</p><p>5、查看虚拟机网络（mac地址和ip地址）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">virsh dumpxml frontend1 | grep mac</span><br><span class="line">arp -an</span><br></pre></td></tr></table></figure><p><img src="http://cdn.voidking.com/img/libvirt-create-vm/arp.jpg?imageView2/0/w/600"><br>本次找到的IP为192.168.122.49</p><p>6、访问虚拟机</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh cirros@192.168.122.49</span><br></pre></td></tr></table></figure><p><img src="http://cdn.voidking.com/img/libvirt-create-vm/login.jpg?imageView2/0/w/600"><br>输入默认密码gocubsgo，即可登录虚拟机。</p><p>7、测试网络</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping 8.8.8.8 -c3</span><br></pre></td></tr></table></figure><p><img src="http://cdn.voidking.com/img/libvirt-create-vm/ping2.jpg?imageView2/0/w/600"><br>至此，大功告成，创建虚拟机成功。</p><h1 id="libvirt配置网络"><span class="post-title-index">8.</span><a href="#libvirt配置网络" class="headerlink" title="libvirt配置网络"></a> libvirt配置网络</h1><p>以上我们知道，可以使用<code>arp -an</code>命令查看虚拟机IP，如果查看到的IP都不能访问呢？这时就需要我们来手动配置。<br>参考文档：</p><ul><li><a target="_blank" rel="noopener" href="https://blog.csdn.net/wesleyflagon/article/details/50781857">给libvirt创建的虚拟机指定固定IP</a></li><li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/davidshen/p/8145965.html">linux初学者-网络桥接篇</a></li><li><a target="_blank" rel="noopener" href="https://wiki.qemu.org/Documentation/Networking">Documentation/Networking</a></li></ul><p>1、查看libvirt网络</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">virsh net-list --all</span><br></pre></td></tr></table></figure><p>2、查看虚拟机的网络</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">virsh domiflist cirros</span><br></pre></td></tr></table></figure><p>查看到mac地址为<code>52:54:00:7f:0e:77</code>。</p><p>3、修改libvirt网络配置</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">virsh net-edit default</span><br></pre></td></tr></table></figure><p>如下修改：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">network</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>default<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">uuid</span>&gt;</span>cc522162-7487-41dc-82ee-63df0df4003e<span class="tag">&lt;/<span class="name">uuid</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">forward</span> <span class="attr">mode</span>=<span class="string">&#x27;nat&#x27;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">bridge</span> <span class="attr">name</span>=<span class="string">&#x27;virbr0&#x27;</span> <span class="attr">stp</span>=<span class="string">&#x27;on&#x27;</span> <span class="attr">delay</span>=<span class="string">&#x27;0&#x27;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mac</span> <span class="attr">address</span>=<span class="string">&#x27;52:54:00:d6:65:fb&#x27;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ip</span> <span class="attr">address</span>=<span class="string">&#x27;192.168.122.1&#x27;</span> <span class="attr">netmask</span>=<span class="string">&#x27;255.255.255.0&#x27;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dhcp</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">range</span> <span class="attr">start</span>=<span class="string">&#x27;192.168.122.2&#x27;</span> <span class="attr">end</span>=<span class="string">&#x27;192.168.122.254&#x27;</span>/&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--line 10, add--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">host</span> <span class="attr">mac</span>=<span class="string">&#x27;52:54:00:7f:0e:77&#x27;</span> <span class="attr">name</span>=<span class="string">&#x27;cirros&#x27;</span> <span class="attr">ip</span>=<span class="string">&#x27;192.168.122.100&#x27;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dhcp</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ip</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">network</span>&gt;</span></span><br></pre></td></tr></table></figure><p>以上，给cirros虚拟机配置了静态IP为192.168.122.100。</p><p>4、重启网络</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">virsh net-destroy default</span><br><span class="line">virsh net-start default</span><br><span class="line"><span class="comment">#virsh --connect qemu:///system net-destroy default</span></span><br><span class="line"><span class="comment">#virsh --connect qemu:///system net-start default </span></span><br></pre></td></tr></table></figure><p>5、重启虚拟机</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">virsh shutdown cirros</span><br><span class="line">virsh start cirros</span><br></pre></td></tr></table></figure><h1 id="libvirt配置VNC"><span class="post-title-index">9.</span><a href="#libvirt配置VNC" class="headerlink" title="libvirt配置VNC"></a> libvirt配置VNC</h1><p>某些情况下，无法通过IP访问虚拟机，这时就需要配置vnc，详情参考<a target="_blank" rel="noopener" href="http://blog.51cto.com/liqingbiao/1741103">kvm虚拟机VNC的配置</a>。</p><p>1、配置vnc</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">virsh edit cirros</span><br></pre></td></tr></table></figure><p>找到</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">graphics</span> <span class="attr">type</span>=<span class="string">&#x27;vnc&#x27;</span> <span class="attr">port</span>=<span class="string">&#x27;-1&#x27;</span> <span class="attr">autoport</span>=<span class="string">&#x27;yes&#x27;</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>修改为：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">graphics</span> <span class="attr">type</span>=<span class="string">&#x27;vnc&#x27;</span> <span class="attr">port</span>=<span class="string">&#x27;5901&#x27;</span> <span class="attr">autoport</span>=<span class="string">&#x27;no&#x27;</span> <span class="attr">listen</span>=<span class="string">&#x27;0.0.0.0&#x27;</span>&gt;</span>       </span><br><span class="line">  <span class="tag">&lt;<span class="name">listen</span> <span class="attr">type</span>=<span class="string">&#x27;address&#x27;</span> <span class="attr">address</span>=<span class="string">&#x27;0.0.0.0&#x27;</span>/&gt;</span>        </span><br><span class="line"><span class="tag">&lt;/<span class="name">graphics</span>&gt;</span></span><br></pre></td></tr></table></figure><p>2、重启虚拟机</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">virsh shutdown cirros</span><br><span class="line">virsh start cirros</span><br></pre></td></tr></table></figure><p>3、vnc访问<br>本地打开<a target="_blank" rel="noopener" href="https://www.realvnc.com/en/connect/download/viewer/">vncviewer client</a>，输入ip:5901进行连接。登录虚拟机后，也可以设置静态IP，这样就不用通过<code>virsh net-edit default</code>修改了。</p><h1 id="后记"><span class="post-title-index">10.</span><a href="#后记" class="headerlink" title="后记"></a> 后记</h1><p>其实，虚拟机中安装的虚拟机，也可以支持KVM了，开启嵌套虚拟化即可。<br>详情参考：</p><ul><li><a target="_blank" rel="noopener" href="https://blog.csdn.net/u012124304/article/details/80955753">KVM嵌套虚拟化 – 在虚拟机中创建虚拟机</a></li><li><a target="_blank" rel="noopener" href="https://www.server-world.info/en/note?os=Ubuntu_16.04&p=kvm&f=8">Nested KVM</a></li></ul><p>1、查看宿主机是否开启嵌套虚拟化</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /sys/module/kvm_intel/parameters/nested</span><br></pre></td></tr></table></figure><p>N代表没有开启。</p><p>2、开启嵌套虚拟化</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;options kvm_intel nested=1&#x27;</span> &gt;&gt; /etc/modprobe.d/qemu-system-x86.conf</span><br></pre></td></tr></table></figure><p>然后重启系统。</p></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> 好好学习的郝</li><li class="post-copyright-link"> <strong>原文链接：</strong> <a href="https://www.voidking.com/dev-libvirt-create-vm/" title="使用Libvirt创建虚拟机">https://www.voidking.com/dev-libvirt-create-vm/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本文采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议，转载请注明出处！源站会即时更新知识点并修正错误，欢迎访问~</li><li> <img width="200" height="200" src="/images/avatar.jpg"><p style="text-align:center;margin-bottom:0">微信公众号同步更新，欢迎关注~</p></li></ul></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/linux/" rel="tag"># linux</a> <a href="/tags/ubuntu/" rel="tag"># ubuntu</a> <a href="/tags/libvirt/" rel="tag"># libvirt</a> <a href="/tags/virsh/" rel="tag"># virsh</a></div><div class="post-nav"><div class="post-nav-item"><a href="/dev-libvirt-create-win10/" rel="prev" title="使用Libvirt创建Win10虚拟机"><i class="fa fa-chevron-left"></i> 使用Libvirt创建Win10虚拟机</a></div><div class="post-nav-item"> <a href="/dev-network-building/" rel="next" title="组网技术概述">组网技术概述<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><div class="footer-ads" style="margin-top:10px"><ins class="adsbygoogle" style="display:block" data-ad-format="autorelaxed" data-ad-client="ca-pub-3284447971731414" data-ad-slot="9697986181"></ins><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3284447971731414" crossorigin="anonymous"></script><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div class="comments" id="gitalk-container"></div><script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-text">1. 前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#qemu%E5%92%8Clibvirt%E7%AE%80%E4%BB%8B"><span class="nav-text">2. qemu和libvirt简介</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%89%E8%A3%85qemu%E5%92%8Clibvirt"><span class="nav-text">3. 安装qemu和libvirt</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%89%E8%A3%85vncserver"><span class="nav-text">4. 安装vncserver</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#qemu%E5%88%9B%E5%BB%BA%E8%99%9A%E6%8B%9F%E6%9C%BA"><span class="nav-text">5. qemu创建虚拟机</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%8B%E8%BD%BD%E7%B3%BB%E7%BB%9F%E9%95%9C%E5%83%8F"><span class="nav-text">5.1. 下载系统镜像</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E7%A3%81%E7%9B%98"><span class="nav-text">5.2. 创建磁盘</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E7%B3%BB%E7%BB%9F%E5%88%B0%E7%A3%81%E7%9B%98"><span class="nav-text">5.3. 安装系统到磁盘</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E5%AE%89%E8%A3%85%E8%BF%87%E7%A8%8B"><span class="nav-text">5.4. 查看安装过程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8%E8%99%9A%E6%8B%9F%E6%9C%BA"><span class="nav-text">5.5. 启动虚拟机</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IP%E9%85%8D%E7%BD%AE"><span class="nav-text">5.6. IP配置</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E7%BD%91%E7%BB%9C"><span class="nav-text">6. 创建网络</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#libvirt%E5%88%9B%E5%BB%BA%E8%99%9A%E6%8B%9F%E6%9C%BA"><span class="nav-text">7. libvirt创建虚拟机</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#libvirt%E9%85%8D%E7%BD%AE%E7%BD%91%E7%BB%9C"><span class="nav-text">8. libvirt配置网络</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#libvirt%E9%85%8D%E7%BD%AEVNC"><span class="nav-text">9. libvirt配置VNC</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%90%8E%E8%AE%B0"><span class="nav-text">10. 后记</span></a></li></ol></div></div><div class="sidecar-ads" style="margin-top:10px"><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="好好学习的郝" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">好好学习的郝</p><div class="site-description" itemprop="description">一个计算机技术爱好者与学习者</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">710</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">31</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">253</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:voidking@qq.com" title="E-Mail → mailto:voidking@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://github.com/voidking" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="http://weibo.com/voidking" title="Weibo → http:&#x2F;&#x2F;weibo.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i> Weibo</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/voidking" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-quora"></i> Zhihu</a></span></div></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2014 – <span itemprop="copyrightYear">2024</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">好好学习的郝</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="footer-beian"> <a href="http://beian.miit.gov.cn/" target="_blank">苏ICP备14021030号</a>&nbsp;|&nbsp; <img src="/images/beian.png" alt=""> <a target="_blank" href="http://www.beian.gov.cn/">苏公网安备 32032202000223号</a></div></div></footer></div><script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.css"><script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/gitalk/1.7.2/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: '5a238b8c32b1e4dd2156',
      clientSecret: 'bfb5d518626f6fdc7da0351d1e0cd37ab75c6361',
      repo: 'gitalk-comments',
      owner: 'voidking',
      admin: ['voidking'],
      id: '98a43d0b0625b7f924a12b6c7f537afc',
      title: '使用Libvirt创建虚拟机',
      body: '欢迎留言，互相交流学习~',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script></body></html>