<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 4.2.1"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:new URL("https://www.voidking.com").hostname,root:"/",scheme:"Gemini",version:"7.7.1",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},path:"search.xml",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="Jenkins简介Jenkins是一个开源软件项目，是基于Java开发的一种持续集成工具，用于监控持续重复的工作，旨在提供一个开放易用的软件平台，使软件的持续集成变成可能。 本文研究一下在CentOS7（IP为192.168.56.104）上安装部署Jenkins，可以管理部署GitLab中的项目（IP为192.168.56.103）到Web服务器（IP为192.168.56.105）。"><meta property="og:type" content="article"><meta property="og:title" content="CentOS7安装部署Jenkins"><meta property="og:url" content="https://www.voidking.com/dev-centos7-install-jenkins/index.html"><meta property="og:site_name" content="好好学习的郝"><meta property="og:description" content="Jenkins简介Jenkins是一个开源软件项目，是基于Java开发的一种持续集成工具，用于监控持续重复的工作，旨在提供一个开放易用的软件平台，使软件的持续集成变成可能。 本文研究一下在CentOS7（IP为192.168.56.104）上安装部署Jenkins，可以管理部署GitLab中的项目（IP为192.168.56.103）到Web服务器（IP为192.168.56.105）。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/sshkey.jpg?imageView2/0/w/600"><meta property="og:image" content="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/start.jpg?imageView2/0/w/600"><meta property="og:image" content="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/welcome.jpg?imageView2/0/w/600"><meta property="og:image" content="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/name.jpg?imageView2/0/w/600"><meta property="og:image" content="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/source.jpg?imageView2/0/w/600"><meta property="og:image" content="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/privatekey.jpg?imageView2/0/w/600"><meta property="og:image" content="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/build.jpg?imageView2/0/w/600"><meta property="og:image" content="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/console.jpg?imageView2/0/w/600"><meta property="og:image" content="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/plugin.jpg?imageView2/0/w/600"><meta property="og:image" content="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/jdk.jpg?imageView2/0/w/600"><meta property="og:image" content="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/maven.jpg?imageView2/0/w/600"><meta property="og:image" content="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/source2.jpg?imageView2/0/w/600"><meta property="og:image" content="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/mvnbuild.jpg?imageView2/0/w/600"><meta property="og:image" content="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/poststep.jpg?imageView2/0/w/600"><meta property="og:image" content="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/console2.jpg?imageView2/0/w/700"><meta property="og:image" content="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/console3.jpg?imageView2/0/w/700"><meta property="og:image" content="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/console4.jpg?imageView2/0/w/700"><meta property="og:image" content="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/success.jpg?imageView2/0/w/600"><meta property="og:image" content="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/buildname.jpg?imageView2/0/w/600"><meta property="og:image" content="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/buildtest.jpg?imageView2/0/w/600"><meta property="og:image" content="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/node.jpg?imageView2/0/w/700"><meta property="og:image" content="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/nodedetail.jpg?imageView2/0/w/700"><meta property="og:image" content="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/rootkey.jpg?imageView2/0/w/700"><meta property="og:image" content="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/startagent.jpg?imageView2/0/w/700"><meta property="article:published_time" content="2019-08-01T12:00:00.000Z"><meta property="article:modified_time" content="2021-04-18T05:48:55.201Z"><meta property="article:author" content="好好学习的郝"><meta property="article:tag" content="tomcat"><meta property="article:tag" content="java"><meta property="article:tag" content="maven"><meta property="article:tag" content="centos"><meta property="article:tag" content="mysql"><meta property="article:tag" content="git"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/sshkey.jpg?imageView2/0/w/600"><link rel="canonical" href="https://www.voidking.com/dev-centos7-install-jenkins/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0}</script><title>CentOS7安装部署Jenkins | 好好学习的郝</title><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?b759ac2a7fa45129e3ef060bf68259f0";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="alternate" href="/atom.xml" title="好好学习的郝" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">好好学习的郝</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">好好学习，天天向上！</h1></div><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i> 归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/voidking" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.voidking.com/dev-centos7-install-jenkins/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="好好学习的郝"><meta itemprop="description" content="学而不思则罔，思而不学则殆！"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="好好学习的郝"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> CentOS7安装部署Jenkins</h2><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-08-01 20:00:00" itemprop="dateCreated datePublished" datetime="2019-08-01T20:00:00+08:00">2019-08-01</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E4%B8%93%E4%B8%9A/" itemprop="url" rel="index"><span itemprop="name">专业</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E4%B8%93%E4%B8%9A/%E8%BF%90%E7%BB%B4/" itemprop="url" rel="index"><span itemprop="name">运维</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E4%B8%93%E4%B8%9A/%E8%BF%90%E7%BB%B4/centos/" itemprop="url" rel="index"><span itemprop="name">centos</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="Jenkins简介"><a href="#Jenkins简介" class="headerlink" title="Jenkins简介"></a>Jenkins简介</h1><p>Jenkins是一个开源软件项目，是基于Java开发的一种持续集成工具，用于监控持续重复的工作，旨在提供一个开放易用的软件平台，使软件的持续集成变成可能。</p><p>本文研究一下在CentOS7（IP为192.168.56.104）上安装部署Jenkins，可以管理部署GitLab中的项目（IP为192.168.56.103）到Web服务器（IP为192.168.56.105）。</p><a id="more"></a><h1 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h1><p>1、在Jenkins服务器编辑hosts<br><code>vim /etc/hosts</code>，添加：</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">192.168.56.103</span>  gitlab.voidking.com</span><br></pre></td></tr></table></figure><p>2、创建密钥<br><code>ssh-keygen</code><br>/root/.ssh目录下生成了私钥id_rsa和公钥id_rsa.pub。</p><p>3、添加公钥到gitlab<br>浏览器访问 <a href="https://gitlab.voidking.com/profile/keys" target="_blank" rel="noopener">https://gitlab.voidking.com/profile/keys</a> ，把公钥粘贴进去。<br><img src="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/sshkey.jpg?imageView2/0/w/600" alt=""></p><p>4、安装git<br><code>yum install git</code></p><h1 id="安装Jenkins"><a href="#安装Jenkins" class="headerlink" title="安装Jenkins"></a>安装Jenkins</h1><p>Jenkins依赖Java，因此首先参考<a href="https://www.voidking.com/dev-install-jdk-on-all-platforms/">《全平台安装JDK》</a>，安装配置好JDK，然后如下步骤安装Jenkins。</p><p>1、添加jenkins源：</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget -O <span class="regexp">/etc/</span>yum.repos.d<span class="regexp">/jenkins.repo http:/</span><span class="regexp">/jenkins-ci.org/</span>redhat/jenkins.repo </span><br><span class="line">rpm --<span class="keyword">import</span> <span class="string">http:</span><span class="comment">//pkg.jenkins-ci.org/redhat/jenkins-ci.org.key</span></span><br></pre></td></tr></table></figure><p>2、安装jenkins：</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum <span class="keyword">install</span> jenkins</span><br></pre></td></tr></table></figure><p>3、启动jenkins：</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service jenkins <span class="literal">start</span></span><br></pre></td></tr></table></figure><p>Jenkins安装目录：<code>/usr/lib/jenkins/</code>。<br>Jenkins配置文件：<code>/etc/sysconfig/jenkins</code>。</p><p>4、防火墙设置</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd <span class="params">--add-port=8080/tcp</span> <span class="params">--permanent</span></span><br><span class="line">systemctl <span class="keyword">reload</span> firewalld</span><br></pre></td></tr></table></figure><p>5、基本设置<br>浏览器访问 <a href="http://192.168.56.104:8080" target="_blank" rel="noopener">http://192.168.56.104:8080</a> ，即可看到jenkins页面。<br><img src="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/start.jpg?imageView2/0/w/600" alt=""><br><code>cat /var/lib/jenkins/secrets/initialAdminPassword</code>查看管理员密码，填入页面，继续；安装推荐的插件；创建第一个管理员；设置Jenkins URL；开始使用Jenkins。</p><h1 id="使用Jenkins"><a href="#使用Jenkins" class="headerlink" title="使用Jenkins"></a>使用Jenkins</h1><p>1、新建项目<br>点击新建Item或者创建一个新任务，新建项目。<br><img src="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/welcome.jpg?imageView2/0/w/600" alt=""><br>选择Freestyle project，输入名称，确定。<br><img src="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/name.jpg?imageView2/0/w/600" alt=""></p><p>2、设置源码管理<br><img src="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/source.jpg?imageView2/0/w/600" alt=""><br>点击源码管理Tab页，选择Git，Repository URL填入<code>git@gitlab.voidking.com:root/voidking.git</code>。此时提示没有权限访问，Credentials后面点击添加，Jenkins。<br><img src="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/privatekey.jpg?imageView2/0/w/600" alt=""><br>Domain全局凭据（unrestricted），类型选择SSH Username with private key，范围选择全局，Username输入root，然后把id_rsa中的内容粘贴进去，添加。然后在Credentials一栏root，页面上的警告就消失了。最后保存即可。</p><p>3、构建项目<br><img src="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/build.jpg?imageView2/0/w/600" alt=""><br>在voidking项目页面，点击立即构建，即可完成项目构建。点击控制台输出，可以看到整个构建过程。<br><img src="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/console.jpg?imageView2/0/w/600" alt=""><br>从构建过程可以看出，整个过程只拉取了一次代码，其他啥也没做，代码存放在/var/lib/jenkins/workspace/voidking目录。</p><h1 id="构建JavaWeb项目"><a href="#构建JavaWeb项目" class="headerlink" title="构建JavaWeb项目"></a>构建JavaWeb项目</h1><p>构建JavaWeb项目的基本原理：Jenkins从GitLab拉取项目代码，然后在workspace的项目目录中执行mvn install命令生成war包，最后拷贝war包到Web服务器的webapps目录中并启动tomcat。</p><h2 id="GitLab项目准备"><a href="#GitLab项目准备" class="headerlink" title="GitLab项目准备"></a>GitLab项目准备</h2><p>1、使用本地环境（JDK+Tomcat+Maven），生成JavaWeb项目的war包并放入Tomcat进行测试，本文中使用<a href="">pandawork-start</a>项目。</p><p>2、上传Maven JavaWeb项目的源码到gitlab。如果gitlab不允许<code>git push -f</code>，那么在gitlab中点击项目名，Settings，Repository，修改Protected Branches的配置即可。</p><h2 id="Web服务器准备"><a href="#Web服务器准备" class="headerlink" title="Web服务器准备"></a>Web服务器准备</h2><p>1、安装JDK，参考参考<a href="https://www.voidking.com/dev-install-jdk-on-all-platforms/">《全平台安装JDK》</a>。</p><p>2、安装Tomcat，参考<a href="https://www.voidking.com/dev-centos-tomat-autostart/">CentOS7设置tomcat开机自启动</a>。</p><p>3、安装Mysql，参考<a href="https://www.voidking.com/dev-centos-mysql-autostart/">CentOS7设置mysql开机自启动</a>。</p><p>4、配置免密登录，使Jenkins服务器可以免密访问Web服务器，使Jenkins可以免密访问Web服务器。<br><code>ssh-copy-id -i .ssh/id_rsa.pub -p 22 root@192.168.56.105</code></p><h2 id="Jenkins服务器配置"><a href="#Jenkins服务器配置" class="headerlink" title="Jenkins服务器配置"></a>Jenkins服务器配置</h2><p>Jenkin服务器配置主要参考<a href="https://blog.csdn.net/iamniconico/article/details/82023173" target="_blank" rel="noopener">Jenkins安装及自动部署Maven项目</a>。</p><p>1、安装配置Maven，参考<a href="https://www.cnblogs.com/qiyuan880794/p/9407342.html" target="_blank" rel="noopener">centos7 安装maven</a>。</p><p>2、登录Jenkins，系统管理，插件管理，可选插件，下载Maven Integration。<br><img src="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/plugin.jpg?imageView2/0/w/600" alt=""></p><p>3、返回工作台，系统管理，全局工具配置。配置JDK，配置Maven，保存。<br><img src="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/jdk.jpg?imageView2/0/w/600" alt=""><br><img src="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/maven.jpg?imageView2/0/w/600" alt=""></p><p>4、Jenkins工作台，新建项目，构建一个Maven项目。源码管理配置gitlab中的Java Web项目。<br><img src="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/source2.jpg?imageView2/0/w/600" alt=""></p><p>5、Build选项卡，Goals and Options，输入clean install -Dmaven.test.skip=true。<br><img src="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/mvnbuild.jpg?imageView2/0/w/600" alt=""></p><p>6、Post Steps选项卡，Add post-build step，执行shell，填入拷贝war包和启动tomcat命令，保存。</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scp /var/<span class="class"><span class="keyword">lib</span>/<span class="title">jenkins</span>/<span class="title">workspace</span>/<span class="title">pandawork</span>-<span class="title">start</span>/<span class="title">target</span>/<span class="title">pandawork</span>-<span class="title">start</span>.<span class="title">war</span> <span class="title">root</span>@192.168.56.105:/<span class="title">opt</span>/<span class="title">apache</span>-<span class="title">tomcat</span>-8.5.43/<span class="title">webapps</span>/</span></span><br><span class="line">ssh root@<span class="number">192.168</span>.<span class="number">56.105</span> <span class="string">"nohup sh /opt/apache-tomcat-8.5.43/bin/startup.sh &amp;"</span></span><br></pre></td></tr></table></figure><p><img src="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/poststep.jpg?imageView2/0/w/600" alt=""></p><p>7、Jenkins工作台，点击Web项目，立即构建，控制台输出。<br><img src="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/console2.jpg?imageView2/0/w/700" alt=""><br><img src="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/console3.jpg?imageView2/0/w/700" alt=""><br>由上图可以看出，Maven项目构建成功，但是在执行远程拷贝脚本的时候出错，说明之前添加的免密登录没有生效。</p><p>8、给Jenkins用户添加免密登录。<br>（1）添加登录权限，<code>vim /etc/passwd</code>，修改jenkins用户权限</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#jenkins:x:997:995:Jenkins Automation Server:/var/lib/jenkins:/bin/false</span></span><br><span class="line"><span class="symbol">jenkins:</span><span class="symbol">x:</span><span class="number">997</span>:<span class="number">995</span>:Jenkins Automation <span class="symbol">Server:</span>/var/<span class="class"><span class="keyword">lib</span>/<span class="title">jenkins</span>:/<span class="title">bin</span>/<span class="title">bash</span></span></span><br></pre></td></tr></table></figure><p>（2）切换到jenkins用户，<code>su jenkins</code></p><p>（3）生成密钥，<code>ssh-keygen</code></p><p>（4）密钥添加到Web服务器</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /var/<span class="class"><span class="keyword">lib</span>/<span class="title">jenkins</span></span></span><br><span class="line">ssh-copy-id -i .ssh/id_rsa.pub -p <span class="number">22</span> root@<span class="number">192.168</span>.<span class="number">56.105</span></span><br></pre></td></tr></table></figure><p>（5）再次构建项目，执行成功！<br><img src="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/console4.jpg?imageView2/0/w/700" alt=""></p><p>8、测试服务<br>浏览器访问 <a href="http://192.168.56.105:8080/pandawork-start/" target="_blank" rel="noopener">http://192.168.56.105:8080/pandawork-start/</a> ，即可看到hello world。<br><img src="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/success.jpg?imageView2/0/w/600" alt=""></p><h1 id="job并发构建"><a href="#job并发构建" class="headerlink" title="job并发构建"></a>job并发构建</h1><p>需求：已知有10个Java项目，名称分别为test1、test2、…、test10，现在想要使用jenkins对这10个项目进行构建。问题来了，如果使用同一个job，那么每个项目构建时都需要等待前一个项目构建完成，效率很低。如果使用10个job，那么这10个job的配置基本相同，以后如果有修改，维护成本很高。<br>这种情况下该怎么处理？使用job并发构建，参考<a href="https://www.cnblogs.com/zndxall/archive/2018/03/06/8516189.html" target="_blank" rel="noopener">jenkins 多用户同时触发构建</a>。</p><p>1、登录Jenkins，系统管理，插件管理，可选插件，在过滤中输入<code>build name</code><br>出现了 Build Name and Description Setter 插件，安装它。<br><img src="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/buildname.jpg?imageView2/0/w/600" alt=""><br>安装完成重启jenkins。</p><p>2、创建一个自由风格的job，名为test</p><p>（1）参数化构建过程，添加字符参数，输入<code>projectName</code><br>（2）勾选 在必要的时候并发构建<br>（3）增加构建步骤，Update build name，Use macro，Build name macro template，输入<code>#${BUILD_NUMBER}_${projectName}</code><br>（4）勾选 Insert macro first<br>（5）增加构建步骤，执行shell，输入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">pwd</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `seq 0 120`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">"Project Name: "</span><span class="variable">$&#123;projectName&#125;</span></span><br><span class="line">    sleep 1s</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>（6）两次点击Build with Parameters，分别输入项目名test1和test2进行构建。<br><img src="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/buildtest.jpg?imageView2/0/w/600" alt=""><br>可以看到，Build History里的构建名称是两个不同的名称。</p><p>3、清除workspace<br>并发构建后，workspace下会生成test和test@2两个目录，如果并发量高了还会更多，此时需要清除workspace。<br>在job配置页面，增加构建后操作步骤，选择 Delete workspace when build is done。</p><h1 id="添加slave节点"><a href="#添加slave节点" class="headerlink" title="添加slave节点"></a>添加slave节点</h1><p>1、新建节点<br>系统管理，新建节点，输入节点名称，选中固定节点，确定。<br><img src="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/node.jpg?imageView2/0/w/700" alt=""></p><p>2、完善节点细节<br>输入描述（主机名），执行器数量（一般和节点CPU核数相同，此处填4），远程工作目录（/home/jenkins），标签（用于构建哪些项目，此处填project1），用法（只允许运行绑定到这台机器的Job），启动方式（Launch agent agents via SSH），主机（节点IP），Host Key Verification Strategy（Non verifying Verification Strategy），可用性（尽量保持代理在线）<br><img src="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/nodedetail.jpg?imageView2/0/w/700" alt=""></p><p>3、证书配置<br>以上配置还漏了一个Credentials，这个需要详细说一下。<br>（1）在master节点使用root用户生成密钥对，<code>ssh-keygen</code><br>（2）在slave节点添加master节点的公钥，<code>vim /root/.ssh/authorized_keys</code>，把master节点的id_rsa.pub内容添加进去。<br>（3）在jenkins节点配置页面，上图红框的地方，添加，Jenkins。<br>（4）添加凭据，Domain（全局凭据），类型（SSH Username with private key），范围（全局），描述（root private key），Username（root），Private Key选中Enter directly，Key（粘贴master节点的id_rsa），添加。<br><img src="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/rootkey.jpg?imageView2/0/w/700" alt=""></p><p>4、启动代理<br>节点列表，点击节点名称，启动代理，建立master节点与slave节点的连接。<br><img src="http://cdn.voidking.com/@/imgs/centos7-install-jenkins/startagent.jpg?imageView2/0/w/700" alt=""><br>启动日志显示：</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;</span>=<span class="string">==[JENKINS REMOTING CAPACITY]===&gt;channel started</span></span><br><span class="line"><span class="attr">Remoting</span> <span class="string">version: 3.36</span></span><br><span class="line"><span class="attr">This</span> <span class="string">is a Unix agent</span></span><br><span class="line"><span class="attr">Evacuated</span> <span class="string">stdout</span></span><br><span class="line"><span class="attr">Agent</span> <span class="string">successfully connected and online</span></span><br><span class="line"><span class="attr">...</span></span><br></pre></td></tr></table></figure><p>表示连接成功，成功加入了一个jenkins slave节点。</p><h1 id="指定slave节点构建"><a href="#指定slave节点构建" class="headerlink" title="指定slave节点构建"></a>指定slave节点构建</h1><h2 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h2><p>1、在配置job时，勾选限制项目的运行节点，标签表达式输入“project1”（和slave节点的标签对应）。</p><p>2、构建项目，因为slave的执行器数量设置为4，所以当同时构建的数量在4以内时，会使用slave1；当同时构建的数量超过4个时，会使用slave2。</p><h2 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h2><p>1、登录Jenkins，系统管理，插件管理，可选插件，在过滤中输入<code>node</code><br>找到 Node and Label parameter plugin 插件，安装它。</p><p>2、参数化构建过程，添加参数，Node。按住ctrl选择使用的机器，并且选中Allow multi node selection for concurrent builds。</p><h1 id="使用上次的参数构建"><a href="#使用上次的参数构建" class="headerlink" title="使用上次的参数构建"></a>使用上次的参数构建</h1><p>如果一个job的参数很多，那么每次构建都要输入很多参数，很麻烦，此时可以使用Rebuilder插件。<br>1、登录Jenkins，系统管理，插件管理，可选插件，在过滤中输入<code>rebuilder</code><br>找到 Rebuilder 插件（This plugin is for rebuilding a job using the same parameters.），安装它。</p><p>2、构建项目页面，可以看到Rebuild Last选项，点击它使用上次参数再次构建。<br>也可以进入某次Build History，可以看到Rebuild选项，点击它，即可使用该次构建的参数再次构建。</p><h1 id="任务超时自动停止"><a href="#任务超时自动停止" class="headerlink" title="任务超时自动停止"></a>任务超时自动停止</h1><p>如果一个构建任务，因为网络或者其他原因阻塞了，卡住了10分钟以上，这时我们希望这个任务能够自动停止。<br>1、登录Jenkins，系统管理，插件管理，可选插件，在过滤中输入<code>timeout</code>。<br>找到 Build Timeout 插件（This plugin allows builds to be automatically terminated after the specified amount of time has elapsed.），安装它。</p><p>2、进入需要配置的job，配置，构建环境，勾选 Abort the build if it’s stuck。</p><ul><li>Time-out strategy 保持默认 Absolute</li><li>Timeout minutes 调整为 10</li><li>Time-out variable 不用填</li><li>Time-out actions，Add action，Abort the build</li></ul><h1 id="Jenkins-API"><a href="#Jenkins-API" class="headerlink" title="Jenkins API"></a>Jenkins API</h1><p>1、创建job</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST JENKINS_URL/createItem \</span><br><span class="line">  --<span class="keyword">user</span> <span class="title">USER</span>:TOKEN \</span><br><span class="line">  --data-urlencode <span class="attr">json=</span>'&#123;<span class="string">"name"</span>:<span class="string">"new_job"</span>,<span class="string">"mode"</span>:<span class="string">"copy"</span>,<span class="string">"from"</span>:<span class="string">"old_job"</span>&#125;'</span><br></pre></td></tr></table></figure><p>2、构建</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST JENKINS_URL/job/JOB_NAME/buildWithParameters \</span><br><span class="line">  --<span class="keyword">user</span> <span class="title">USER</span>:TOKEN \</span><br><span class="line">  --data-urlencode <span class="attr">json=</span>'&#123;<span class="string">"parameter"</span>: [&#123;<span class="string">"name"</span>:<span class="string">"id"</span>, <span class="string">"value"</span>:<span class="string">"123"</span>&#125;, &#123;<span class="string">"name"</span>:<span class="string">"verbosity"</span>, <span class="string">"value"</span>:<span class="string">"high"</span>&#125;]&#125;'</span><br></pre></td></tr></table></figure><p>3、查看buildnum</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST JENKINS_URL<span class="regexp">/job/</span>JOB_NAME<span class="regexp">/lastBuild/</span>buildNumber</span><br></pre></td></tr></table></figure><p>如果使用postman测试的话，<code>--user USER:TOKEN</code> 对应 Authorization 中的 Basic Auth，Username和Password。<br><code>--data-urlencode json</code> 对应 Body 中的 x-www-form-urlencoded。</p><p>更多内容参考：</p><ul><li><a href="https://wiki.jenkins.io/display/jenkins/remote+access+api" target="_blank" rel="noopener">Remote access API</a></li><li><a href="https://python-jenkins.readthedocs.io/en/latest/" target="_blank" rel="noopener">Python Jenkins documentation</a></li><li><a href="https://opendev.org/jjb/python-jenkins/src/branch/master/jenkins/__init__.py" target="_blank" rel="noopener">jjb/python-jenkins</a></li><li><a href="https://blog.csdn.net/liumiaocn/article/details/90762699" target="_blank" rel="noopener">使用API对Job进行操作</a></li><li><a href="https://stackoverflow.com/questions/41108149/build-now-option-is-not-coming-for-job-in-jenkins" target="_blank" rel="noopener">build now option is not coming for job in jenkins</a></li><li><a href="https://stackoverflow.com/questions/41806857/jenkins-api-too-slow" target="_blank" rel="noopener">Jenkins api too slow</a></li></ul><h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>至此，Jenkins安装配置完成，使用Jenkins配置部署了一个Java Web项目。本文中用到了三台服务器，分别是GitLab服务器、Web服务器和Jenkins服务器。Jenkins从GitLab拉取项目代码，然后在workspace的项目目录中执行mvn install命令生成war包，最后拷贝war包到Web服务器的webapps目录中并启动tomcat。</p><h1 id="书签"><a href="#书签" class="headerlink" title="书签"></a>书签</h1><p><a href="https://segmentfault.com/a/1190000004639325" target="_blank" rel="noopener">CentOS 安装 Jenkins</a></p><p><a href="https://www.whatled.com/post-1922.html" target="_blank" rel="noopener">Jenkins详细安装与构建部署使用教程</a></p><p><a href="https://www.jianshu.com/p/63b012ee52ea" target="_blank" rel="noopener">持续集成Jenkins+Gitlab</a></p><p><a href="https://blog.csdn.net/aaaaaab_/article/details/82012044" target="_blank" rel="noopener">基于gitlab和jenkins的自动化部署实例</a></p><p><a href="http://blog.csdn.net/jiang1986829/article/details/51173251" target="_blank" rel="noopener">Jenkins常用插件之Deploy Plugin</a></p><p><a href="http://updates.jenkins-ci.org/download/plugins/" target="_blank" rel="noopener">jenkins plugins</a></p><p><a href="https://plugins.jenkins.io/leastload/" target="_blank" rel="noopener">Least Load</a></p><p><a href="https://www.liaoxuefeng.com/article/001463233913442cdb2d1bd1b1b42e3b0b29eb1ba736c5e000" target="_blank" rel="noopener">使用Jenkins进行持续集成</a></p></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/tomcat/" rel="tag"># tomcat</a> <a href="/tags/java/" rel="tag"># java</a> <a href="/tags/maven/" rel="tag"># maven</a> <a href="/tags/centos/" rel="tag"># centos</a> <a href="/tags/mysql/" rel="tag"># mysql</a> <a href="/tags/git/" rel="tag"># git</a></div><div class="post-nav"><div class="post-nav-item"><a href="/dev-centos7-install-gitlab/" rel="prev" title="CentOS7安装配置GitLab"><i class="fa fa-chevron-left"></i> CentOS7安装配置GitLab</a></div><div class="post-nav-item"> <a href="/dev-manage-pwd-by-keepass/" rel="next" title="使用KeePass管理密码">使用KeePass管理密码<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><div class="comments"><div id="lv-container" data-id="city" data-uid="MTAyMC8zODU3Mi8xNTEwMA=="></div></div><script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Jenkins简介"><span class="nav-number">1.</span> <span class="nav-text">Jenkins简介</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#环境准备"><span class="nav-number">2.</span> <span class="nav-text">环境准备</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#安装Jenkins"><span class="nav-number">3.</span> <span class="nav-text">安装Jenkins</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#使用Jenkins"><span class="nav-number">4.</span> <span class="nav-text">使用Jenkins</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#构建JavaWeb项目"><span class="nav-number">5.</span> <span class="nav-text">构建JavaWeb项目</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#GitLab项目准备"><span class="nav-number">5.1.</span> <span class="nav-text">GitLab项目准备</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Web服务器准备"><span class="nav-number">5.2.</span> <span class="nav-text">Web服务器准备</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Jenkins服务器配置"><span class="nav-number">5.3.</span> <span class="nav-text">Jenkins服务器配置</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#job并发构建"><span class="nav-number">6.</span> <span class="nav-text">job并发构建</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#添加slave节点"><span class="nav-number">7.</span> <span class="nav-text">添加slave节点</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#指定slave节点构建"><span class="nav-number">8.</span> <span class="nav-text">指定slave节点构建</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#方法一"><span class="nav-number">8.1.</span> <span class="nav-text">方法一</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#方法二"><span class="nav-number">8.2.</span> <span class="nav-text">方法二</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#使用上次的参数构建"><span class="nav-number">9.</span> <span class="nav-text">使用上次的参数构建</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#任务超时自动停止"><span class="nav-number">10.</span> <span class="nav-text">任务超时自动停止</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Jenkins-API"><span class="nav-number">11.</span> <span class="nav-text">Jenkins API</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#后记"><span class="nav-number">12.</span> <span class="nav-text">后记</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#书签"><span class="nav-number">13.</span> <span class="nav-text">书签</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="好好学习的郝" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">好好学习的郝</p><div class="site-description" itemprop="description">学而不思则罔，思而不学则殆！</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">618</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">50</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">198</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="mailto:voidking@qq.com" title="E-Mail → mailto:voidking@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://github.com/voidking" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="http://weibo.com/voidking" title="Weibo → http:&#x2F;&#x2F;weibo.com&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i> Weibo</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/voidking" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;voidking" rel="noopener" target="_blank"><i class="fa fa-fw fa-quora"></i> Zhihu</a></span></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2014 – <span itemprop="copyrightYear">2021</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">好好学习的郝</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="footer-beian"> <a href="http://www.beian.miit.gov.cn/" target="_blank">苏ICP备14021030号</a>&nbsp;|&nbsp; <img src="/images/beian.png" alt=""> <a target="_blank" href="http://www.beian.gov.cn/">苏公网安备 32032202000223号</a></div></div></footer><div id="needsharebutton-float"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div></div><script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css"><script src="/lib/needsharebutton/needsharebutton.js"></script><script>pbOptions={iconStyle:"box",boxForm:"horizontal",position:"bottomCenter",networks:"Weibo,Wechat,Douban,QQZone,Twitter,Facebook"},new needShareButton("#needsharebutton-postbottom",pbOptions),flOptions={iconStyle:"box",boxForm:"horizontal",position:"topRight",networks:"Weibo,Wechat,Douban,QQZone,Twitter,Facebook"},new needShareButton("#needsharebutton-float",flOptions)</script><script>
NexT.utils.loadComments(document.querySelector('#lv-container'), () => {
  // window.livereOptions = {
  //   refer: location.pathname.replace(CONFIG.root, '').replace('index.html', '')
  // };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
});
</script></body></html>